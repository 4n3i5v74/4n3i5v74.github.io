<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="CheatSheet - NMAP" /><meta name="author" content="4n3i5v74" /><meta property="og:locale" content="en_US" /><meta name="description" content="NMAP options" /><meta property="og:description" content="NMAP options" /><link rel="canonical" href="https://4n3i5v74.github.io/posts/cheatsheet-nmap/" /><meta property="og:url" content="https://4n3i5v74.github.io/posts/cheatsheet-nmap/" /><meta property="og:site_name" content="4n3i5v74" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-01T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CheatSheet - NMAP" /><meta name="twitter:site" content="@nive1103" /><meta name="twitter:creator" content="@4n3i5v74" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"4n3i5v74"},"headline":"CheatSheet - NMAP","dateModified":"2021-05-12T00:15:55+05:30","datePublished":"2020-12-01T00:00:00+05:30","description":"NMAP options","url":"https://4n3i5v74.github.io/posts/cheatsheet-nmap/","mainEntityOfPage":{"@type":"WebPage","@id":"https://4n3i5v74.github.io/posts/cheatsheet-nmap/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>CheatSheet - NMAP | 4n3i5v74</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/local.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/copy-code.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">4n3i5v74</a></div><div class="site-subtitle font-italic">A Security Blog.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/4n3i5v74" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span>Posts</span> <span>CheatSheet - NMAP</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CheatSheet - NMAP</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 1, 2020, 12:00 AM +0530" > Dec 1, 2020 <i class="unloaded">2020-12-01T00:00:00+05:30</i> </span> by <span class="author"> 4n3i5v74 </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, May 12, 2021, 12:15 AM +0530" > May 12 <i class="unloaded">2021-05-12T00:15:55+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1202 words">6 min</span></div></div><div class="post-content"><h2 id="nmap-options">NMAP options</h2><p>Scan Types</p><ul><li><code>-sn</code> - Probe only (host discovery)<li><code>-sV</code> - Version scan<li><code>-O</code> - OS detection<li><code>-sT</code> - TCP scan<li><code>-sU</code> - UDP scan<li><code>-sS</code> - SYN scan<li><code>-sR</code> - RPC scan<li><code>--scanflags</code> - Custom list of TCP using URGACKPSHRSTSYNFIN, in any order<li><code>-v</code> - Verbose scan<li><code>-vv</code> - more verbose scan</ul><p>Script Scan</p><ul><li><code>-sC</code> - Default NSE script scan<li><code>--script=http</code> - Specify script<li><code>--script=http*,banner</code> - Specify multiple scripts<li><code>--script=snmp-sysdescr --script-args snmpcommunity=admin</code> - Specify script arguments</ul><p>Probe Options</p><ul><li><code>-Pn</code> - No probe (assume target is up)<li><code>-PB</code> - Default probe (TCP 80,445 and ICMP)<li><code>-PS80,443</code> - Probe specific ports<li><code>-PE</code> - ICMP echo request<li><code>-PP</code> - ICMP timestamp request<li><code>-PM</code> - ICMP netmask request</ul><p>Timing Options</p><ul><li><code>-T0</code> - Very Slow, for IDS evasion<li><code>-T1</code> - Quite Slow, for IDS evasion<li><code>-T2</code> - Slow, to consume less bandwidth, 10 times slower than normal<li><code>-T3</code> - Normal, dynamic timing based on target response<li><code>-T4</code> - Aggressive, assume fast network<li><code>-T5</code> - Insane, likely miss ports</ul><p>Target Ports</p><ul><li><code>-r</code> - Scan in linear fashion and not random<li><code>-F</code> - Scan most 100 popular ports<li><code>--top-ports 1000</code> - Scan most 1000 popular ports<li><code>-p80-100</code> - Scan from ports 80 to 100<li><code>-p80,100,120</code> - Scan ports 80,100,120<li><code>-pU:53,U:110,T:443-445</code> - Specify TCP/UDP ports<li><code>-p-</code> - Scan ports 1-65535<li><code>-phttp,https</code> - Scan using service names</ul><p>Firewall Evasion</p><ul><li><code>-f</code> - Use tiny fragmented IP packets<li><code>--mtu</code> - Set packet size<li><code>--scan-delay</code> - Add delay in ms between packets<li><code>-D decoy1,decoy1,ME</code> - Use decoys and own IP<li><code>-D RND:10</code> - Use random 10 addresses as decoy<li><code>-sI</code> - zombie scan<li><code>--source-port</code> - Specify source port<li><code>--data-length</code> - Append random data<li><code>--spoof-mac</code> - Spoof MAC address<li><code>--badsum</code> - Send bad checksums, usually to check presence of firewall More information on firewall evasion can be seen <a href="https://nmap.org/book/man-bypass-firewalls-ids.html" target="_blank">here</a></ul><p>Script Execution</p><ul><li><code>--script</code> - Execute single of multiple scripts<li>Script categories - all, auth, default, discovery, external, intrusive, malware, safe, vuln<li><code>--script banner --script trace</code> - Troubleshoot script<li><code>--script-updatedb</code> - Update script database<li><code>--script-help=ssl-heartbleed</code> - Help on script</ul><p>Output Format</p><ul><li><code>-oN out.txt</code> - Standard NMAP format<li><code>-oG grep.txt</code> - Greppable format<li><code>-oX out.xml</code> - XML format<li><code>-oA out</code> - NMAP, Greppable and XML formats<li><code>-oG -</code> - Greppable format to screen. <code>-oN -</code> and <code>-oX -</code> can also be used<li><code>--append-output</code> - Append output to previous scan result<li><code>-d</code> - Increase debug level. Use <code>-dd</code> for more debug result</ul><p>MISC Options</p><ul><li><code>-n</code> - Disable reverse lookup<li><code>-A</code> - Use additional features like OS detection, Version detection, script scanning and traceroute<li><code>--reason</code> - Display reason for port open, close or filtered<li><code>--open</code> - Show only open ports<li><code>--packet-trace</code> - Show sent/received packets<li><code>--dns-servers</code> - Query DNS server for target hosts<li><code>--send-eth</code> - Send raw ethernet packets<li><code>--send-ip</code> - Send IP packets</ul><p>Target Specification</p><ul><li>IP Address - 192.168.1.1 or AABB:CC::DD%eth0 [specify multiple targets using space delimiter]<li>IP Range - 192.168.0-255.0-255<li>CIDR Block - 192.168.1.0/24<li>Hostname - test-machine or scanme.nmap.org<li>File with list of targets - <code>-iL hosts-file</code></ul><h2 id="scan-info">Scan Info</h2><p>Scans and their responses happen as per the <a href="https://tools.ietf.org/html/rfc793" target="_blank">RFC Guideline</a>.</p><h3 id="tcp-connect-scan--st">TCP Connect Scan <code>-sT</code></h3><p>Perform TCP Connect Scan on all ports mentioned.</p><ul><li>If 3 way handshake works - <code>SYN -&gt; SYN + ACK -&gt; ACK + RST</code> - port is open<li>If server sends reset packet - <code>SYN -&gt; RST</code> - port is closed<li>If packet is dropped or no response is received - <code>SYN</code> - port is blocked or filtered</ul><p>Configure linux firewall to send reset packet.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="iptables%20-I%20INPUT%20-p%20tcp%20--dport%20%3Cport%3E%20-j%20REJECT%20--reject-with%20tcp-reset" type="button"></button></div></div><pre><code>iptables -I INPUT -p tcp --dport &lt;port&gt; -j REJECT --reject-with tcp-reset
</code></pre><h3 id="tcp-syn-scan--ss---half-open-or-stealth-scan">TCP SYN Scan <code>-sS</code> - half open or stealth scan</h3><p>This scan requires root access, as instead of ACK, RST packet is sent to server (create raw packet instead of ACK). This can also be made to run by setting capabilities like <code>CAP_NET_RAW</code>, <code>CAP_NET_ADMIN</code>, <code>CAP_NET_BIND_SERVICE</code>, but scripts will not work as intended. This type is faster, and also stealthy, as most applications and firewalls logs only established connection, and this type resets before connetion is fully established. Results are finalized using same conditions as TCP Connect Scan.</p><h3 id="udp-scan--su">UDP Scan <code>-sU</code></h3><p>As there is no acknowledgement for packets, UDP scan is more time consuming than TCP scans.</p><ul><li>If response is received, port is marked open (rare scenario)<li>If response is not received, second packet is sent, even if response is not received, port is marked open or filtered<li>If response is received by ICMP packet containing <code>port is unreachable</code> message, port is marked as closed</ul><h3 id="other-tcp-scans">Other TCP Scans</h3><ul><li><p>TCP Null Scan <code>-sN</code> Sends packet with no flags set. Expects reset response if port is closed. <code>NULL -&gt; RST</code></p><li><p>TCP Fin Scan <code>-sF</code> Instead of sending NULL packet, FIN is sent. Expects reset response if port is closed. <code>FIN -&gt; RST</code></p><li><p>TCP XMas Scan <code>-sX</code> Sends a malformed packet, FIN, PSH and URG. Expects reset response if port is closed. <code>FIN, PSH, URG -&gt; RST</code></p></ul><p>These scans finalizes on open ports similar to UDP scan.</p><ul><li>If port is open, no response is received<li>If port is closed, reset response is received</ul><p>These scans are generally used for firewall evasion. Windows and network devices are known to respond with RST packet for all malformed TCP packets.</p><h2 id="nmap-script-engine">NMAP Script Engine</h2><p>NMAP Scripts are written in LUA programming language, used for reconnaisance, vulnerability scanning or automatically exploiting them. Major categories of NSE,</p><ul><li>safe - target wont be affected<li>intrusive - target likely to be affected<li>vuln - scan for vulnerabilities<li>exploit - attempt to scan vulnerabilities<li>auth - try to bypass authentication, like anonymous ftp server login<li>brute - try to bruteforce credentials for login<li>discovery - try to query running service</ul><p>More information and categories can be found in the <a href="https://nmap.org/book/nse-usage.html" target="_blank">NSE Usage</a> and <a href="https://nmap.org/nsedoc/" target="_blank">NSE Documentation</a></p><p>To search for available ftp scripts,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="grep%20ftp%20/usr/share/nmap/scripts/script.db" type="button"></button></div></div><pre><code class="language-bash">grep ftp /usr/share/nmap/scripts/script.db
</code></pre><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="ls%20-l%20/usr/share/nmap/scripts/*ftp*" type="button"></button></div></div><pre><code class="language-bash">ls -l /usr/share/nmap/scripts/*ftp*
</code></pre><p>To check dependencies for the script,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="grep%20dependencies%20/usr/share/nmap/scripts/%3Cscript%3E" type="button"></button></div></div><pre><code class="language-bash">grep dependencies /usr/share/nmap/scripts/&lt;script&gt;
</code></pre><h2 id="nmap-examples">NMAP Examples</h2><p>Network sweep</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-sn%20192.168.1.0/24" type="button"></button></div></div><pre><code>nmap -sn 192.168.1.0/24
</code></pre><p>ARP discovery</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-PR%20192.168.1.0/24" type="button"></button></div></div><pre><code>nmap -PR 192.168.1.0/24
</code></pre><p>Version intensity 0-9, higher number gives more accurate result</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-sV%20--version-intensity%208%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -sV --version-intensity 8 192.168.1.100
</code></pre><p>Light mode - 0. Faster</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-sV%20--version-light%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -sV --version-light 192.168.1.100
</code></pre><p>Intense mode - 9. Slower</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-sV%20--version-all%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -sV --version-all 192.168.1.100
</code></pre><p>Limit OS scan. If atleast one open and closed TCP ports are not found, OS detection will not be done</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-O%20--osscan-limit%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -O --osscan-limit 192.168.1.100
</code></pre><p>Timeout. Giveup after some time. 1s, 2m, 3h</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20--host-timeout%2010m%20192.168.1.100" type="button"></button></div></div><pre><code>nmap --host-timeout 10m 192.168.1.100
</code></pre><p>Firewall/IDS Evasion and Spoofing Use tiny fragmented IP packets which is harder for packet filters to trace</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-f%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -f 192.168.1.100
</code></pre><p>Send scans from spoofed IPs Any IP from the list can be our own IP</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-D%20192.168.1.101,192.168.1.111,192.168.1.121,192.168.1.131%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -D 192.168.1.101,192.168.1.111,192.168.1.121,192.168.1.131 192.168.1.100
</code></pre><p>Scan target from other host</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-e%20eth0%20-Pn%20-S%20decoy%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -e eth0 -Pn -S decoy 192.168.1.100
</code></pre><p>Use source port number</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-g%2053%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -g 53 192.168.1.100
</code></pre><p>Append ramdom data Useful for IDS evasion</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-f%20-T0%20-n%20-Pn%20--data-length%20200%20-D%20192.168.1.101,192.168.1.111,192.168.1.121,192.168.1.131%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -f -T0 -n -Pn --data-length 200 -D 192.168.1.101,192.168.1.111,192.168.1.121,192.168.1.131 192.168.1.100
</code></pre><p>Whois query</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20--script%20whois*%20scanme.nmap.org" type="button"></button></div></div><pre><code>nmap --script whois* scanme.nmap.org
</code></pre><p>Information on target</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20--script%20asn-query,whois*,ip-geolocation-maxmind%20192.168.1.100" type="button"></button></div></div><pre><code>nmap --script asn-query,whois*,ip-geolocation-maxmind 192.168.1.100
</code></pre><p>HTTP site map generator</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-Pn%20--script=http-sitemap-generator%20scanme.nmap.org" type="button"></button></div></div><pre><code>nmap -Pn --script=http-sitemap-generator scanme.nmap.org
</code></pre><p>Run SMB scripts</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-n%20-Pn%20-vv%20-O%20-sV%20--script%20smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2*%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -n -Pn -vv -O -sV --script smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* 192.168.1.100
</code></pre><p>Check XSS vulnerabilities</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-p80%20--script%20http-unsafe-output-escaping%20scanme.nmap.org" type="button"></button></div></div><pre><code>nmap -p80 --script http-unsafe-output-escaping scanme.nmap.org
</code></pre><p>Check SQL injection</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-p80%20--script%20http-sql-injection%20scanme.nmap.org" type="button"></button></div></div><pre><code>nmap -p80 --script http-sql-injection scanme.nmap.org
</code></pre><p>Compare scan outputs</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="ndiff%20scan1.xml%20scan2.xml" type="button"></button></div></div><pre><code>ndiff scan1.xml scan2.xml
</code></pre><p>Convert scan result to html</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="xsltproc%20nmap.xml%20-o%20nmap.html" type="button"></button></div></div><pre><code>xsltproc nmap.xml -o nmap.html
</code></pre><h2 id="common-enumeration-usage">Common enumeration usage</h2><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-Pn%20-n%20-F%20192.168.1.100%0Anmap%20-Pn%20-n%20-p-%20--open%20-A%20-T4%20192.168.1.100" type="button"></button></div></div><pre><code>nmap -Pn -n -F 192.168.1.100
nmap -Pn -n -p- --open -A -T4 192.168.1.100
</code></pre></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cheatsheet/'>CheatSheet</a>, <a href='/categories/nmap/'>NMAP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cheatsheet/" class="post-tag no-text-decoration" >cheatsheet</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/pentest/" class="post-tag no-text-decoration" >pentest</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cheatsheet-tmux/"><div class="card-body"> <span class="timeago small" > Dec 1, 2020 <i class="unloaded">2020-12-01T02:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CheatSheet - TMUX</h3><div class="text-muted small"><p> Starting tmux tmux bottom pane - left - session name bottom pane - middle - window name bottom pane - right - hostname, time, date Prefix mode Enter prefix mo...</p></div></div></a></div><div class="card"> <a href="/posts/cheatsheet-gobuster/"><div class="card-body"> <span class="timeago small" > Dec 1, 2020 <i class="unloaded">2020-12-01T07:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CheatSheet - Gobuster</h3><div class="text-muted small"><p> Gobuster options Modes dir - directory/file enumeration dns - DNS subdomain enumeration s3 - AWS S3 bucket enumeration vhost - VHOST enumeration Global options --no-error - Do not di...</p></div></div></a></div><div class="card"> <a href="/posts/cheatsheet-john-the-ripper/"><div class="card-body"> <span class="timeago small" > Dec 1, 2020 <i class="unloaded">2020-12-01T08:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CheatSheet - John The Ripper</h3><div class="text-muted small"><p> John Resources John jumbo dev release John binaries John docs John docs Password Analysis and Cracking Kit Mangling Rules Generation John Installation {% capture code %}{% raw %}gi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled"><p>-</p></span> <a href="/posts/cheatsheet-tmux/" class="btn btn-outline-primary"><p>CheatSheet - TMUX</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/4n3i5v74">4n3i5v74</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/protocols/">protocols</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/windows/">windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://4n3i5v74.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
