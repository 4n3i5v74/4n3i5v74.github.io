<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Writeup for TryHackMe room - Encryption - Crypto 101" /><meta name="author" content="4n3i5v74" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><meta property="og:description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><link rel="canonical" href="https://4n3i5v74.github.io/posts/tryhackme-encryption-crypto-101/" /><meta property="og:url" content="https://4n3i5v74.github.io/posts/tryhackme-encryption-crypto-101/" /><meta property="og:site_name" content="4n3i5v74" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-02T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writeup for TryHackMe room - Encryption - Crypto 101" /><meta name="twitter:site" content="@nive1103" /><meta name="twitter:creator" content="@4n3i5v74" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"4n3i5v74"},"headline":"Writeup for TryHackMe room - Encryption - Crypto 101","dateModified":"2021-05-13T23:09:48+05:30","datePublished":"2021-01-02T00:00:00+05:30","description":"A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups.","url":"https://4n3i5v74.github.io/posts/tryhackme-encryption-crypto-101/","mainEntityOfPage":{"@type":"WebPage","@id":"https://4n3i5v74.github.io/posts/tryhackme-encryption-crypto-101/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Writeup for TryHackMe room - Encryption - Crypto 101 | 4n3i5v74</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/local.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/copy-code.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">4n3i5v74</a></div><div class="site-subtitle font-italic">A Security Blog.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/4n3i5v74" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span>Posts</span> <span>Writeup for TryHackMe room - Encryption - Crypto 101</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writeup for TryHackMe room - Encryption - Crypto 101</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jan 2, 2021, 12:00 AM +0530" > Jan 2 <i class="unloaded">2021-01-02T00:00:00+05:30</i> </span> by <span class="author"> 4n3i5v74 </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, May 13, 2021, 11:09 PM +0530" > May 13 <i class="unloaded">2021-05-13T23:09:48+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1206 words">6 min</span></div></div><div class="post-content"><div class="flex-container"> <script src="https://tryhackme.com/badge/34685"></script></div><h2 id="encryption---crypto-101"><a href="https://tryhackme.com/room/encryptioncrypto101" target="_blank">Encryption - Crypto 101</a></h2><p>This room contains info about encryption and methods to crack them.</p><p>For complete tryhackme path, refer the <a href="https://4n3i5v74.github.io/posts/getting-started-with-cybersecurity-tryhackme/" target="_blank">link</a></p><h2 id="task-2---key-terms">Task 2 - Key terms</h2><ul><li>Ciphertext - The result of encrypting a plaintext, encrypted data.<li>Cipher - A method of encrypting or decrypting data. Modern ciphers are cryptographic, but there are many non cryptographic ciphers like Caesar.<li>Plaintext - Data before encryption or hashing, often text but it could be a photograph or other file instead.<li>Encryption - Transforming data into ciphertext, using a cipher.<li>Encoding - This is NOT a form of encryption, just a form of data representation like base64 or hexadecimal. Immediately reversible.<li>Hash - A hash is the output of a hash function. Hashing can also be used as a verb, “to hash”, meaning to produce the hash value of some data.<li>Key - Some information that is needed to correctly decrypt the ciphertext and obtain the plaintext.<li>Passphrase - Separate to the key, a passphrase is similar to a password and used to protect a key.<li>Asymmetric encryption - Uses different keys to encrypt and decrypt.<li>Symmetric encryption - Uses the same key to encrypt and decrypt.<li>Brute force - Attacking cryptography by trying every different password or every different key.<li>Cryptoanalysis - Attacking cryptography by finding a weakness in the underlying maths.</ul><h2 id="task3---why-is-encryption-important">Task3 - Why is Encryption important?</h2><h3 id="references">References</h3><ul><li><a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_for_Large_Organizations_v1.pdf" target="_blank">PCI DSS Standard</a></ul><h2 id="task-4---crucial-crypto-maths">Task 4 - Crucial Crypto Maths</h2><p>Crypto algorithms use <code>Modulo operator - %</code> for calculations. The non-zero outputs of modulo operators are taken for outputs, as seen below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="30%20%25%205%20-%200%0A25%20%25%207%20-%204" type="button"></button></div></div><pre><code>30 % 5 - 0
25 % 7 - 4
</code></pre><ul><li>Task 5 - Types of Encryption</ul><h3 id="references-1">References</h3><ul><li><p><a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard" target="_blank">DES Standard</a></p><li><p>Task 6 - Rivest Shamir Adleman</p></ul><h3 id="references-2">References</h3><ul><li><a href="https://github.com/Ganapati/RsaCtfTool" target="_blank">RSA CTF Tool</a><li><a href="https://github.com/ius/rsatool" target="_blank">RSA Tool</a><li><a href="https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/" target="_blank">RSA Encryption</a></ul><p>The <code>RSA</code> algorithm is mainly dependent on using two prime numbers to generate public and private keys for encrypting and decrypting the data. The difficulty in cracking the algorithm is due to the fact that the prime numbers cannot be correctly calculated in reverse with just the public and private keys.</p><p>Given a set of prime numbers, <code>p = 11</code> and <code>q = 13</code>, the value of n and phi can be determined as, <code>n = ( p * q )</code> and <code>phi = ( p - 1 ) * ( q - 1 )</code>.</p><p>To calculate value of <code>e</code>, <code>GCD</code> calculation is done between <code>n and phi</code> and <code>e</code>. The resulting value should be <code>1</code>. Any resulting value can be taken as value of <code>e</code>.</p><p>Similarly, to calculate value of <code>d</code>, calculation is done like <code>d * e % phi = 1</code>. Any resulting value can be taken as value of <code>d</code>.</p><p>Public key can be calculated as <code>(e, phi)</code> and private key can be calculated as <code>(d, phi)</code>.</p><p>Encrypted message can be generated using <code>(ascii character) ** e % phi</code>. And the message can be decrypted using <code>(encrypted character) ** d % phi</code></p><p>The word <code>Hello</code> can be encrypted as <code>019 062 004 004 045</code> and decrypted as <code>072 101 108 108 111</code>, when the following values are chosen.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="p%20=%2011%0Aq%20=%2013%0An%20=%20143%0Aphi%20=%20120%0Ae%20=%207%0Ad%20=%20223%0Apublic%20key%20=%20(7,%20143)%0Aprivate%20key%20=%20(223,%20143)" type="button"></button></div></div><pre><code>p = 11
q = 13
n = 143
phi = 120
e = 7
d = 223
public key = (7, 143)
private key = (223, 143)
</code></pre><p>A sample code to demonstrate encoded and decoded message can be as below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="import%20random%0A%0Adef%20gcd(%20a,%20b%20):%0A%20%20if%20b%20==%200:%0A%20%20%20%20return%20a%0Areturn%20gcd(%20b,%20a%25b%20)%0A%0Adef%20prime_finder():%0A%20%20test_number%20=%20random.randrange(%2010,%2031%20)%0A%20%20for%20i%20in%20range(%202,%20test_number%20):%0A%20%20%20%20if%20test_number%20%25%20i%20==%200:%0A%20%20%20%20return%20prime_finder()%0A%20%20return%20test_number%0A%0Ap%20=%20prime_finder()%0Aq%20=%20prime_finder()%0An%20=%20p%20*%20q%0Aphi%20=%20(%20p-1%20)%20*%20(%20q-1%20)%0A%0Apub_keys%20=%20[]%0Afor%20i%20in%20range(%202,%20phi%20):%0A%20%20if%20gcd(%20i,%20phi%20)%20==%201%20and%20gcd(%20i,%20n%20)%20==%201:%0A%20%20%20%20pub_keys.append(%20i%20)%0A%0Ae%20=%20random.choice(%20pub_keys%20)%0Adel(%20pub_keys%20)%0A%0Apriv_keys%20=%20[]%0Ai%20=%202%0Awhile%20len(%20priv_keys%20)%20%3C%2010:%0A%20%20if%20i%20*%20e%20%25%20phi%20==%201:%0A%20%20%20%20priv_keys.append(%20i%20)%0A%20%20i%20+=%201%0A%0Awhile%20True:%0Aa%20=%20random.choice(%20priv_keys%20)%0A%20%20if%20len(%20str(%20a%20)%20)%20==%20len(%20str(%20phi%20)%20)%20and%20a%20%3C=%20(%20phi%20*%202%20):%0A%20%20%20%20d%20=%20a%0A%20%20%20%20break%0Adel(%20priv_keys%20)%0A%0Aprint(%20f%22Value%20of%20p:%20%7Bp%7D%5CnValue%20of%20q:%20%7Bq%7D%5CnValue%20of%20n:%20%7Bn%7D%5CnValue%20of%20phi:%20%7Bphi%7D%5CnValue%20of%20e:%20%7Be%7D%5CnValue%20of%20d:%20%7Bd%7D%5CnPublic%20Key:%20(%7Be%7D,%20%7Bn%7D%5CnPrivate%20Key:%20(%7Bd%7D,%20%7Bn%7D)%5Cn%22%20)%0A%0Ahel%20=%20[%20%22072%22,%20%22101%22,%20%22108%22,%20%22108%22,%20%22111%22%20]%0Aehel%20=%20[]%0Adhel%20=%20[]%0Ares%20=%20[]%0A%0Afor%20char%20in%20hel:%0A%20%20res%20=%20(%20int(%20char%20)%20**%20e%20)%20%25%20phi%0A%20%20ehel.append(%20'%7B:03%7D'.format(%20res%20)%20)%0A%20%20emsg%20=%20%22%20%22.join(%20map(%20str,%20ehel%20)%20)%0A%0Ares%20=%20[]%0Afor%20char%20in%20ehel:%0A%20%20res%20=%20(%20int%20(%20char%20)%20**%20d%20)%20%25%20phi%0A%20%20dhel.append(%20'%7B:03%7D'.format(%20res%20)%20)%0A%20%20dmsg%20=%20%22%20%22.join(%20map(%20str,%20dhel%20)%20)%0A%0Aprint(%20f'Encrypted%20message%20for%20%22Hello%22%20is%20%22%7Bemsg%7D%22%5Cn'%20)%0Aprint(%20f'Decrypted%20message%20for%20%22Hello%22%20is%20%22%7Bdmsg%7D%22%5Cn'%20)" type="button"></button></div></div><pre><code>import random

def gcd( a, b ):
  if b == 0:
    return a
return gcd( b, a%b )

def prime_finder():
  test_number = random.randrange( 10, 31 )
  for i in range( 2, test_number ):
    if test_number % i == 0:
    return prime_finder()
  return test_number

p = prime_finder()
q = prime_finder()
n = p * q
phi = ( p-1 ) * ( q-1 )

pub_keys = []
for i in range( 2, phi ):
  if gcd( i, phi ) == 1 and gcd( i, n ) == 1:
    pub_keys.append( i )

e = random.choice( pub_keys )
del( pub_keys )

priv_keys = []
i = 2
while len( priv_keys ) &lt; 10:
  if i * e % phi == 1:
    priv_keys.append( i )
  i += 1

while True:
a = random.choice( priv_keys )
  if len( str( a ) ) == len( str( phi ) ) and a &lt;= ( phi * 2 ):
    d = a
    break
del( priv_keys )

print( f"Value of p: {p}\nValue of q: {q}\nValue of n: {n}\nValue of phi: {phi}\nValue of e: {e}\nValue of d: {d}\nPublic Key: ({e}, {n}\nPrivate Key: ({d}, {n})\n" )

hel = [ "072", "101", "108", "108", "111" ]
ehel = []
dhel = []
res = []

for char in hel:
  res = ( int( char ) ** e ) % phi
  ehel.append( '{:03}'.format( res ) )
  emsg = " ".join( map( str, ehel ) )

res = []
for char in ehel:
  res = ( int ( char ) ** d ) % phi
  dhel.append( '{:03}'.format( res ) )
  dmsg = " ".join( map( str, dhel ) )

print( f'Encrypted message for "Hello" is "{emsg}"\n' )
print( f'Decrypted message for "Hello" is "{dmsg}"\n' )
</code></pre><h2 id="task-7---establishing-keys-using-asymmetric-cryptography">Task 7 - Establishing Keys Using Asymmetric Cryptography</h2><h3 id="references-3">References</h3><ul><li><a href="https://robertheaton.com/2014/03/27/how-does-https-actually-work/" target="_blank">How HTTPS works</a></ul><h2 id="task-9---ssh-authentication">Task 9 - SSH Authentication</h2><p>Using <code>ssh2john</code>, an inbuild utility with john, create hash input file for the password protected <code>id_rsa</code> ssh key.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="./run/ssh2john.py%20hash/idrsa.id_rsa%20%3E%20hash/idrsa.txt" type="button"></button></div></div><pre><code>./run/ssh2john.py hash/idrsa.id_rsa &gt; hash/idrsa.txt
</code></pre><p>The file contents will be similar to below.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="idrsa:$sshng$1$16$0B5AB4FEB69AFB92B2100435B42B7949$1200$8dce3420285b19a7469a642278a7afab0ab40e28c865ce93fef1351bae5499df5fbf04ddf510e5e407246e4221876b3fbb93931a5276281182b9baf38e0c38a56548f30e7781c77e2bf5940ad9f77265102ab328bb4c6f7fd06e9a3153191dfcddcd9672256608a5bff044fbf33901849aa2c3464e24bb31d6d65160df61848952a79ce660a97b3123fa539754a0e5ffbfba796c98c17b4ca45eeeee1e1c7a45412e26fef9ba8ed48a15c2b60e23a5a525ee2451e03c85145d03b7129740b7ec3babda2f012f1ad21ea8c9ccae7e8eaf95e58fe73159db31785f838de9d960d3d2a528abddad0337490caa73565042ff8c5dc672d2e58402e3449cf0500b0e467300220cee35b528e718eb25fdc7d265042d3dbbe39ed52a445bdd78ad4a9462b374f6ce87c1bd28f1154b52c59db6028187c22cafa5b02eabe27f9a41733a35b6cfc73d83c65febafe8e7568d15b5a5a3340472794a2b6da5cff593649b35299ede7e8a2294ce5812bb5bc9396cc4ae5525620f4e83442c7e181317082e5fd93b29773dd7203e22947b960b2fedbd089ffb88793533dcf195281207e05ada2d284dc69b475e7d561a47d43470d490ec9d847d820eb9db7943dcf133350b6e8b6513ed2deeca6a5105eb496170fd2367b3637e7375891a483511168fe1f3292bcd64e252682865e7da1f1f06ae261a62a0155d3a932cc1976f45c1feaaf183ad86c7ce91795fe45395a73268d3c0e228e24d025c997a936fcb27bb05992ff4b23e050edaaae748b14a80c4ff3145f75436100fc840d107eb97e3da3b8114879e373053f8c4431ffc6feecd167f29a75152ad2e09b8bcaf4eaf92ae7155684c9175e32fe2141b67681c37fa41e791bd71872d49ea52bdea6f54ae6c41eb539ad2ed0c7dedf525ee20460a193a70501d9bc18f42347a4dd62d94e9cac504abb02b7a294efb7e1946014de9051d988c3e23fffcf00f4f5beb3b191f9d01557079cb45e992199d13770060e53f09389caa062cfc675aba02c693ef2c4326a1443aef1987e4c8fa10e11e6d2995faf1f8aa991efffcacea28967f24eabac5467e702d3a2e07a4c56f67801870f7cdb34d9d80116d6ce26b3cfbba9b06d06957911b6c13e37b879593af0c3cb29d2f5a388966876b0a26cadd94e79d97868f9464df6cd67433748f3dabbe5e9ac0eb6dacdfd0cc4219cbbf3bb0fe87fce5b907611bcd1e91a64b1cdab3f26b89f70397e5ddd58e921db7ad69871a6705170b58573eaca996d6cb987210e4d1ea2e098978525be38d8b0717671d651abea0521768a03c1028570a78514727812d7d17946cef6aaca0dddd1e5885f0f7feacfe7a3f70911a6f422f855bac2fd23105114898fe44b532992d841a51e08111be2caa66ab30aa3e89cd99177a53271e9400c79944c2406d605a084875c8b4730f108e2a2cce6251bb4fc27a6f3afd03c289745fb17630a8b0f520ba770ca1455c63ad1db7b21272fc9a5d25fadfdf23a7b021f6d8069e9ca8631dd0e81b182521e7b9efc4632643ac123c1bf8e2ce84576ae0cfc24730d051705bd68958d34a232b11742bce05d2db83029bd631913392fc565e6d8accedf1f9c2ba90c48a773bcc627f99ab1a44897280c2d945a0d8a1270206515dd2fa08f8c34a4150a0ba35ff0d3dbc2c21cd00e09f774a0741d28534eec64ea3" type="button"></button></div></div><pre><code>idrsa:$sshng$1$16$0B5AB4FEB69AFB92B2100435B42B7949$1200$8dce3420285b19a7469a642278a7afab0ab40e28c865ce93fef1351bae5499df5fbf04ddf510e5e407246e4221876b3fbb93931a5276281182b9baf38e0c38a56548f30e7781c77e2bf5940ad9f77265102ab328bb4c6f7fd06e9a3153191dfcddcd9672256608a5bff044fbf33901849aa2c3464e24bb31d6d65160df61848952a79ce660a97b3123fa539754a0e5ffbfba796c98c17b4ca45eeeee1e1c7a45412e26fef9ba8ed48a15c2b60e23a5a525ee2451e03c85145d03b7129740b7ec3babda2f012f1ad21ea8c9ccae7e8eaf95e58fe73159db31785f838de9d960d3d2a528abddad0337490caa73565042ff8c5dc672d2e58402e3449cf0500b0e467300220cee35b528e718eb25fdc7d265042d3dbbe39ed52a445bdd78ad4a9462b374f6ce87c1bd28f1154b52c59db6028187c22cafa5b02eabe27f9a41733a35b6cfc73d83c65febafe8e7568d15b5a5a3340472794a2b6da5cff593649b35299ede7e8a2294ce5812bb5bc9396cc4ae5525620f4e83442c7e181317082e5fd93b29773dd7203e22947b960b2fedbd089ffb88793533dcf195281207e05ada2d284dc69b475e7d561a47d43470d490ec9d847d820eb9db7943dcf133350b6e8b6513ed2deeca6a5105eb496170fd2367b3637e7375891a483511168fe1f3292bcd64e252682865e7da1f1f06ae261a62a0155d3a932cc1976f45c1feaaf183ad86c7ce91795fe45395a73268d3c0e228e24d025c997a936fcb27bb05992ff4b23e050edaaae748b14a80c4ff3145f75436100fc840d107eb97e3da3b8114879e373053f8c4431ffc6feecd167f29a75152ad2e09b8bcaf4eaf92ae7155684c9175e32fe2141b67681c37fa41e791bd71872d49ea52bdea6f54ae6c41eb539ad2ed0c7dedf525ee20460a193a70501d9bc18f42347a4dd62d94e9cac504abb02b7a294efb7e1946014de9051d988c3e23fffcf00f4f5beb3b191f9d01557079cb45e992199d13770060e53f09389caa062cfc675aba02c693ef2c4326a1443aef1987e4c8fa10e11e6d2995faf1f8aa991efffcacea28967f24eabac5467e702d3a2e07a4c56f67801870f7cdb34d9d80116d6ce26b3cfbba9b06d06957911b6c13e37b879593af0c3cb29d2f5a388966876b0a26cadd94e79d97868f9464df6cd67433748f3dabbe5e9ac0eb6dacdfd0cc4219cbbf3bb0fe87fce5b907611bcd1e91a64b1cdab3f26b89f70397e5ddd58e921db7ad69871a6705170b58573eaca996d6cb987210e4d1ea2e098978525be38d8b0717671d651abea0521768a03c1028570a78514727812d7d17946cef6aaca0dddd1e5885f0f7feacfe7a3f70911a6f422f855bac2fd23105114898fe44b532992d841a51e08111be2caa66ab30aa3e89cd99177a53271e9400c79944c2406d605a084875c8b4730f108e2a2cce6251bb4fc27a6f3afd03c289745fb17630a8b0f520ba770ca1455c63ad1db7b21272fc9a5d25fadfdf23a7b021f6d8069e9ca8631dd0e81b182521e7b9efc4632643ac123c1bf8e2ce84576ae0cfc24730d051705bd68958d34a232b11742bce05d2db83029bd631913392fc565e6d8accedf1f9c2ba90c48a773bcc627f99ab1a44897280c2d945a0d8a1270206515dd2fa08f8c34a4150a0ba35ff0d3dbc2c21cd00e09f774a0741d28534eec64ea3
</code></pre><p>Crack the ssh key password using <code>john</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=".%5Crun%5Cjohn.exe%20--wordlist=wordlists%5Crockyou.txt%20hash%5Cidrsa.txt" type="button"></button></div></div><pre><code>.\run\john.exe --wordlist=wordlists\rockyou.txt hash\idrsa.txt
</code></pre><p>An output similar to below will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Warning:%20detected%20hash%20type%20%22SSH%22,%20but%20the%20string%20is%20also%20recognized%20as%20%22ssh-opencl%22%0AUse%20the%20%22--format=ssh-opencl%22%20option%20to%20force%20loading%20these%20as%20that%20type%20instead%0AUsing%20default%20input%20encoding:%20UTF-8%0ALoaded%201%20password%20hash%20(SSH%20[RSA/DSA/EC/OPENSSH%20(SSH%20private%20keys)%2032/64])%0ACost%201%20(KDF/cipher%20[0=MD5/AES%201=MD5/3DES%202=Bcrypt/AES])%20is%200%20for%20all%20loaded%20hashes%0ACost%202%20(iteration%20count)%20is%201%20for%20all%20loaded%20hashes%0AWill%20run%208%20OpenMP%20threads%0ANote:%20This%20format%20may%20emit%20false%20positives,%20so%20it%20will%20keep%20trying%20even%20after%0Afinding%20a%20possible%20candidate.%0APress%20'q'%20or%20Ctrl-C%20to%20abort,%20almost%20any%20other%20key%20for%20status%0A%3Cpassword%3E%20%20%20%20%20%20%20%20(idrsa)%0AWarning:%20Only%202%20candidates%20left,%20minimum%208%20needed%20for%20performance.%0A1g%200:00:00:38%20DONE%20(2021-04-11%2018:27)%200.02581g/s%20370299p/s%20370299c/s%20370299C/sa6_123..%E2%99%A6*%E2%99%A57%C2%A1Vamos!%E2%99%A5%0ASession%20completed" type="button"></button></div></div><pre><code>Warning: detected hash type "SSH", but the string is also recognized as "ssh-opencl"
Use the "--format=ssh-opencl" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 8 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press 'q' or Ctrl-C to abort, almost any other key for status
&lt;password&gt;        (idrsa)
Warning: Only 2 candidates left, minimum 8 needed for performance.
1g 0:00:00:38 DONE (2021-04-11 18:27) 0.02581g/s 370299p/s 370299c/s 370299C/sa6_123..♦*♥7¡Vamos!♥
Session completed
</code></pre><h2 id="task-10---explaining-diffie-hellman-key-exchange">Task 10 - Explaining Diffie Hellman Key Exchange</h2><h3 id="references-4">References</h3><ul><li><a href="https://www.youtube.com/watch?v=NmM9HA2MQGI" target="_blank">Diffie Hellman Algorithm working</a></ul><h2 id="task-11---pgp-gpg-and-aes">Task 11 - PGP, GPG and AES</h2><h3 id="references-5">References</h3><ul><li><a href="https://gnupg.org/" target="_blank">GPG Wiki</a><li><a href="https://www.gnupg.org/gph/de/manual/r1023.html" target="_blank">GPG Usage</a><li><a href="https://www.youtube.com/watch?v=O4xNJsjtN6E" target="_blank">GPG Working</a></ul><p>PGP stands for Pretty Good Privacy. It’s a software that implements encryption for encrypting files, performing digital signing and more.</p><p>GnuPG or GPG is an Open Source implementation of PGP from the GNU project. This passphrase can be cracked using gpg2john from jumbo john.</p><p>Using <code>gpg</code> tool, import the key.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gpg%20--import%20tryhackme.key" type="button"></button></div></div><pre><code>gpg --import tryhackme.key
</code></pre><p>An output similar to below will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gpg:%20/root/.gnupg/trustdb.gpg:%20trustdb%20created%0Agpg:%20key%20FFA4B5252BAEB2E6:%20public%20key%20%22TryHackMe%20(Example%20Key)%22%20imported%0Agpg:%20key%20FFA4B5252BAEB2E6:%20secret%20key%20imported%0Agpg:%20Total%20number%20processed:%201%0Agpg:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20imported:%201%0Agpg:%20%20%20%20%20%20%20secret%20keys%20read:%201%0Agpg:%20%20%20secret%20keys%20imported:%201" type="button"></button></div></div><pre><code>gpg: /root/.gnupg/trustdb.gpg: trustdb created
gpg: key FFA4B5252BAEB2E6: public key "TryHackMe (Example Key)" imported
gpg: key FFA4B5252BAEB2E6: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
</code></pre><p>Decode the file.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gpg%20message.gpg" type="button"></button></div></div><pre><code>gpg message.gpg
</code></pre><p>An output similar to below will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gpg:%20WARNING:%20no%20command%20supplied.%20%20Trying%20to%20guess%20what%20you%20mean%20...%0Agpg:%20encrypted%20with%201024-bit%20RSA%20key,%20ID%202A0A5FDC5081B1C5,%20created%202020-06-30%0A%20%20%20%20%20%20%22TryHackMe%20(Example%20Key)%22" type="button"></button></div></div><pre><code>gpg: WARNING: no command supplied.  Trying to guess what you mean ...
gpg: encrypted with 1024-bit RSA key, ID 2A0A5FDC5081B1C5, created 2020-06-30
      "TryHackMe (Example Key)"
</code></pre><p>Read the decoded file <code>message</code> to get the <code>flag</code>.</p><ul><li>Task 12 - The Future - Quantum Computers and Encryption</ul><h3 id="references-6">References</h3><ul><li><a href="https://doi.org/10.6028/NIST.IR.8105" target="_blank">Quantum Computing Reference</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/encrypt/" class="post-tag no-text-decoration" >encrypt</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/tryhackme-hashing-crypto-101/"><div class="card-body"> <span class="timeago small" > Jan 1 <i class="unloaded">2021-01-01T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Hashing - Crypto 101</h3><div class="text-muted small"><p> Hashing - Crypto 101 This room contains info about hashing and methods to crack them. For complete tryhackme path, refer the link Task 1 - Key Terms Ciphertext - The result of encrypti...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-john-the-ripper/"><div class="card-body"> <span class="timeago small" > Jan 4 <i class="unloaded">2021-01-04T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - John The Ripper</h3><div class="text-muted small"><p> John The Ripper This room contains info about hashing and methods to crack them using John The Ripper. For complete tryhackme path, refer the link. Refer the link for more information on jo...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-active-directory-basics/"><div class="card-body"> <span class="timeago small" > Mar 21 <i class="unloaded">2021-03-21T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Active Directory Basics</h3><div class="text-muted small"><p> Active Directory Basics This room contains info about Windows Active Directory and tools to enumerate them. For complete tryhackme path, refer the link Task 8 - Hands-On Lab References ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tryhackme-hashing-crypto-101/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Hashing - Crypto 101</p></a> <a href="/posts/tryhackme-john-the-ripper/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - John The Ripper</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/4n3i5v74">4n3i5v74</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/protocols/">protocols</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/windows/">windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://4n3i5v74.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
